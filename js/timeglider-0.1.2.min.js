/*

 jQuery Templates Plugin 1.0.0pre
 http://github.com/jquery/jquery-tmpl
 Requires jQuery 1.4.2

 Copyright Software Freedom Conservancy, Inc.
 Dual licensed under the MIT or GPL Version 2 licenses.
 http://jquery.org/license
*/
(function(q){function $(l,x,E,G){G={data:G||G===0||G===false?G:x?x.data:{},_wrap:x?x._wrap:null,tmpl:null,parent:x||null,nodes:[],calls:o,nest:U,wrap:J,html:k,update:A};l&&q.extend(G,l,{nodes:[],parent:x});if(E){G.tmpl=E;G._ctnt=G._ctnt||G.tmpl(q,G);G.key=++h;(p.length?F:v)[h]=G}return G}function N(l,x,E){var G;E=E?q.map(E,function(Q){return typeof Q==="string"?l.key?Q.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+L+'="'+l.key+'" $2'):Q:N(Q,l,Q._ctnt)}):l;if(x)return E;E=E.join("");E.replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,
function(Q,i,r,z){G=q(r).get();W(G);if(i)G=C(i).concat(G);if(z)G=G.concat(C(z))});return G?G:C(E)}function C(l){var x=document.createElement("div");x.innerHTML=l;return q.makeArray(x.childNodes)}function T(l){return new Function("jQuery","$item","var $=jQuery,call,__=[],$data=$item.data;with($data){__.push('"+q.trim(l).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,
function(x,E,G,Q,i,r,z){x=q.tmpl.tag[G];if(!x)throw"Unknown template tag: "+G;G=x._default||[];if(r&&!/\w$/.test(i)){i+=r;r=""}if(i){i=I(i);z=z?","+I(z)+")":r?")":"";z=r?i.indexOf(".")>-1?i+I(r):"("+i+").call($item"+z:i;r=r?z:"(typeof("+i+")==='function'?("+i+").call($item):("+i+"))"}else r=z=G.$1||"null";Q=I(Q);return"');"+x[E?"close":"open"].split("$notnull_1").join(i?"typeof("+i+")!=='undefined' && ("+i+")!=null":"true").split("$1a").join(r).split("$1").join(z).split("$2").join(Q||G.$2||"")+"__.push('"})+
"');}return __;")}function B(l,x){l._wrap=N(l,true,q.isArray(x)?x:[n.test(x)?x:q(x).html()]).join("")}function I(l){return l?l.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function W(l){function x(P){function Y(ha){ha+=E;fa=i[ha]=i[ha]||$(fa,v[fa.parent.key+E]||fa.parent)}var ga,ba=P,fa,la;if(la=P.getAttribute(L)){for(;ba.parentNode&&(ba=ba.parentNode).nodeType===1&&!(ga=ba.getAttribute(L)););if(ga!==la){ba=ba.parentNode?ba.nodeType===11?0:ba.getAttribute(L)||0:0;if(!(fa=v[la])){fa=F[la];fa=$(fa,
v[ba]||F[ba]);fa.key=++h;v[h]=fa}y&&Y(la)}P.removeAttribute(L)}else if(y&&(fa=q.data(P,"tmplItem"))){Y(fa.key);v[fa.key]=fa;ba=(ba=q.data(P.parentNode,"tmplItem"))?ba.key:0}if(fa){for(ga=fa;ga&&ga.key!=ba;){ga.nodes.push(P);ga=ga.parent}delete fa._ctnt;delete fa._wrap;q.data(P,"tmplItem",fa)}}var E="_"+y,G,Q,i={},r,z,H;r=0;for(z=l.length;r<z;r++)if((G=l[r]).nodeType===1){Q=G.getElementsByTagName("*");for(H=Q.length-1;H>=0;H--)x(Q[H]);x(G)}}function o(l,x,E,G){if(!l)return p.pop();p.push({_:l,tmpl:x,
item:this,data:E,options:G})}function U(l,x,E){return q.tmpl(q.template(l),x,E,this)}function J(l,x){var E=l.options||{};E.wrapped=x;return q.tmpl(q.template(l.tmpl),l.data,E,l.item)}function k(l,x){var E=this._wrap;return q.map(q(q.isArray(E)?E.join(""):E).filter(l||"*"),function(G){if(x)G=G.innerText||G.textContent;else{var Q;if(!(Q=G.outerHTML)){Q=document.createElement("div");Q.appendChild(G.cloneNode(true));Q=Q.innerHTML}G=Q}return G})}function A(){var l=this.nodes;q.tmpl(null,null,null,this).insertBefore(l[0]);
q(l).remove()}var D=q.fn.domManip,L="_tmplitem",n=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,v={},F={},R,g={key:0,data:{}},h=0,y=0,p=[];q.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(l,x){q.fn[l]=function(E){var G=[];E=q(E);var Q,i,r;Q=this.length===1&&this[0].parentNode;R=v||{};if(Q&&Q.nodeType===11&&Q.childNodes.length===1&&E.length===1){E[x](this[0]);G=this}else{i=0;for(r=E.length;i<r;i++){y=i;Q=(i>0?this.clone(true):this).get();
q(E[i])[x](Q);G=G.concat(Q)}y=0;G=this.pushStack(G,l,E.selector)}E=R;R=null;q.tmpl.complete(E);return G}});q.fn.extend({tmpl:function(l,x,E){return q.tmpl(this[0],l,x,E)},tmplItem:function(){return q.tmplItem(this[0])},template:function(l){return q.template(l,this[0])},domManip:function(l,x,E){if(l[0]&&q.isArray(l[0])){for(var G=q.makeArray(arguments),Q=l[0],i=Q.length,r=0,z;r<i&&!(z=q.data(Q[r++],"tmplItem")););if(z&&y)G[2]=function(H){q.tmpl.afterManip(this,H,E)};D.apply(this,G)}else D.apply(this,
arguments);y=0;R||q.tmpl.complete(v);return this}});q.extend({tmpl:function(l,x,E,G){var Q=!G;if(Q){G=g;l=q.template[l]||q.template(null,l);F={}}else if(!l){l=G.tmpl;v[G.key]=G;G.nodes=[];G.wrapped&&B(G,G.wrapped);return q(N(G,null,G.tmpl(q,G)))}if(!l)return[];if(typeof x==="function")x=x.call(G||{});E&&E.wrapped&&B(E,E.wrapped);x=q.isArray(x)?q.map(x,function(i){return i?$(E,G,l,i):null}):[$(E,G,l,x)];return Q?q(N(G,null,x)):x},tmplItem:function(l){var x;if(l instanceof q)l=l[0];for(;l&&l.nodeType===
1&&!(x=q.data(l,"tmplItem"))&&(l=l.parentNode););return x||g},template:function(l,x){if(x){if(typeof x==="string")x=T(x);else if(x instanceof q)x=x[0]||{};if(x.nodeType)x=q.data(x,"tmpl")||q.data(x,"tmpl",T(x.innerHTML));return typeof l==="string"?q.template[l]=x:x}return l?typeof l!=="string"?q.template(null,l):q.template[l]||q.template(null,n.test(l)?l:q(l)):null},encode:function(l){return(""+l).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}});
q.extend(q.tmpl,{tag:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){__=__.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},open:"$item.calls(__,$1,$2);__=[];",close:"call=$item.calls();__=call._.concat($item.wrap(call,__));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},"if":{open:"if(($notnull_1) && $1a){",close:"}"},"else":{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){__.push($1a);}"},
"=":{_default:{$1:"$data"},open:"if($notnull_1){__.push($.encode($1a));}"},"!":{open:""}},complete:function(){v={}},afterManip:function(l,x,E){var G=x.nodeType===11?q.makeArray(x.childNodes):x.nodeType===1?[x]:[];E.call(l,x);W(G);y++}})})(jQuery);(function(){var q=this,$=q._,N={},C=Array.prototype,T=Object.prototype,B=C.slice,I=C.unshift,W=T.toString,o=T.hasOwnProperty,U=C.forEach,J=C.map,k=C.reduce,A=C.reduceRight,D=C.filter,L=C.every,n=C.some,v=C.indexOf,F=C.lastIndexOf;T=Array.isArray;var R=Object.keys,g=Function.prototype.bind,h=function(i){return new E(i)};typeof module!=="undefined"&&module.exports?(module.exports=h,h._=h):q._=h;h.VERSION="1.1.7";var y=h.each=h.forEach=function(i,r,z){if(i!=null)if(U&&i.forEach===U)i.forEach(r,z);else if(i.length===
+i.length)for(var H=0,P=i.length;H<P;H++){if(H in i&&r.call(z,i[H],H,i)===N)break}else for(H in i)if(o.call(i,H)&&r.call(z,i[H],H,i)===N)break};h.map=function(i,r,z){var H=[];if(i==null)return H;if(J&&i.map===J)return i.map(r,z);y(i,function(P,Y,ga){H[H.length]=r.call(z,P,Y,ga)});return H};h.reduce=h.foldl=h.inject=function(i,r,z,H){var P=z!==void 0;i==null&&(i=[]);if(k&&i.reduce===k)return H&&(r=h.bind(r,H)),P?i.reduce(r,z):i.reduce(r);y(i,function(Y,ga,ba){P?z=r.call(H,z,Y,ga,ba):(z=Y,P=true)});
if(!P)throw new TypeError("Reduce of empty array with no initial value");return z};h.reduceRight=h.foldr=function(i,r,z,H){i==null&&(i=[]);if(A&&i.reduceRight===A)return H&&(r=h.bind(r,H)),z!==void 0?i.reduceRight(r,z):i.reduceRight(r);i=(h.isArray(i)?i.slice():h.toArray(i)).reverse();return h.reduce(i,r,z,H)};h.find=h.detect=function(i,r,z){var H;p(i,function(P,Y,ga){if(r.call(z,P,Y,ga))return H=P,true});return H};h.filter=h.select=function(i,r,z){var H=[];if(i==null)return H;if(D&&i.filter===D)return i.filter(r,
z);y(i,function(P,Y,ga){r.call(z,P,Y,ga)&&(H[H.length]=P)});return H};h.reject=function(i,r,z){var H=[];if(i==null)return H;y(i,function(P,Y,ga){r.call(z,P,Y,ga)||(H[H.length]=P)});return H};h.every=h.all=function(i,r,z){var H=true;if(i==null)return H;if(L&&i.every===L)return i.every(r,z);y(i,function(P,Y,ga){if(!(H=H&&r.call(z,P,Y,ga)))return N});return H};var p=h.some=h.any=function(i,r,z){r=r||h.identity;var H=false;if(i==null)return H;if(n&&i.some===n)return i.some(r,z);y(i,function(P,Y,ga){if(H|=
r.call(z,P,Y,ga))return N});return!!H};h.include=h.contains=function(i,r){var z=false;if(i==null)return z;if(v&&i.indexOf===v)return i.indexOf(r)!=-1;p(i,function(H){if(z=H===r)return true});return z};h.invoke=function(i,r){var z=B.call(arguments,2);return h.map(i,function(H){return(r.call?r||H:H[r]).apply(H,z)})};h.pluck=function(i,r){return h.map(i,function(z){return z[r]})};h.max=function(i,r,z){if(!r&&h.isArray(i))return Math.max.apply(Math,i);var H={computed:-Infinity};y(i,function(P,Y,ga){Y=
r?r.call(z,P,Y,ga):P;Y>=H.computed&&(H={value:P,computed:Y})});return H.value};h.min=function(i,r,z){if(!r&&h.isArray(i))return Math.min.apply(Math,i);var H={computed:Infinity};y(i,function(P,Y,ga){Y=r?r.call(z,P,Y,ga):P;Y<H.computed&&(H={value:P,computed:Y})});return H.value};h.sortBy=function(i,r,z){return h.pluck(h.map(i,function(H,P,Y){return{value:H,criteria:r.call(z,H,P,Y)}}).sort(function(H,P){var Y=H.criteria,ga=P.criteria;return Y<ga?-1:Y>ga?1:0}),"value")};h.groupBy=function(i,r){var z=
{};y(i,function(H,P){var Y=r(H,P);(z[Y]||(z[Y]=[])).push(H)});return z};h.sortedIndex=function(i,r,z){z||(z=h.identity);for(var H=0,P=i.length;H<P;){var Y=H+P>>1;z(i[Y])<z(r)?H=Y+1:P=Y}return H};h.toArray=function(i){if(!i)return[];if(i.toArray)return i.toArray();if(h.isArray(i))return B.call(i);if(h.isArguments(i))return B.call(i);return h.values(i)};h.size=function(i){return h.toArray(i).length};h.first=h.head=function(i,r,z){return r!=null&&!z?B.call(i,0,r):i[0]};h.rest=h.tail=function(i,r,z){return B.call(i,
r==null||z?1:r)};h.last=function(i){return i[i.length-1]};h.compact=function(i){return h.filter(i,function(r){return!!r})};h.flatten=function(i){return h.reduce(i,function(r,z){if(h.isArray(z))return r.concat(h.flatten(z));r[r.length]=z;return r},[])};h.without=function(i){return h.difference(i,B.call(arguments,1))};h.uniq=h.unique=function(i,r){return h.reduce(i,function(z,H,P){if(0==P||(r===true?h.last(z)!=H:!h.include(z,H)))z[z.length]=H;return z},[])};h.union=function(){return h.uniq(h.flatten(arguments))};
h.intersection=h.intersect=function(i){var r=B.call(arguments,1);return h.filter(h.uniq(i),function(z){return h.every(r,function(H){return h.indexOf(H,z)>=0})})};h.difference=function(i,r){return h.filter(i,function(z){return!h.include(r,z)})};h.zip=function(){for(var i=B.call(arguments),r=h.max(h.pluck(i,"length")),z=Array(r),H=0;H<r;H++)z[H]=h.pluck(i,""+H);return z};h.indexOf=function(i,r,z){if(i==null)return-1;var H;if(z)return z=h.sortedIndex(i,r),i[z]===r?z:-1;if(v&&i.indexOf===v)return i.indexOf(r);
z=0;for(H=i.length;z<H;z++)if(i[z]===r)return z;return-1};h.lastIndexOf=function(i,r){if(i==null)return-1;if(F&&i.lastIndexOf===F)return i.lastIndexOf(r);for(var z=i.length;z--;)if(i[z]===r)return z;return-1};h.range=function(i,r,z){arguments.length<=1&&(r=i||0,i=0);z=arguments[2]||1;for(var H=Math.max(Math.ceil((r-i)/z),0),P=0,Y=Array(H);P<H;){Y[P++]=i;i+=z}return Y};h.bind=function(i,r){if(i.bind===g&&g)return g.apply(i,B.call(arguments,1));var z=B.call(arguments,2);return function(){return i.apply(r,
z.concat(B.call(arguments)))}};h.bindAll=function(i){var r=B.call(arguments,1);r.length==0&&(r=h.functions(i));y(r,function(z){i[z]=h.bind(i[z],i)});return i};h.memoize=function(i,r){var z={};r||(r=h.identity);return function(){var H=r.apply(this,arguments);return o.call(z,H)?z[H]:z[H]=i.apply(this,arguments)}};h.delay=function(i,r){var z=B.call(arguments,2);return setTimeout(function(){return i.apply(i,z)},r)};h.defer=function(i){return h.delay.apply(h,[i,1].concat(B.call(arguments,1)))};var l=function(i,
r,z){var H;return function(){var P=this,Y=arguments,ga=function(){H=null;i.apply(P,Y)};z&&clearTimeout(H);if(z||!H)H=setTimeout(ga,r)}};h.throttle=function(i,r){return l(i,r,false)};h.debounce=function(i,r){return l(i,r,true)};h.once=function(i){var r=false,z;return function(){if(r)return z;r=true;return z=i.apply(this,arguments)}};h.wrap=function(i,r){return function(){var z=[i].concat(B.call(arguments));return r.apply(this,z)}};h.compose=function(){var i=B.call(arguments);return function(){for(var r=
B.call(arguments),z=i.length-1;z>=0;z--)r=[i[z].apply(this,r)];return r[0]}};h.after=function(i,r){return function(){if(--i<1)return r.apply(this,arguments)}};h.keys=R||function(i){if(i!==Object(i))throw new TypeError("Invalid object");var r=[],z;for(z in i)o.call(i,z)&&(r[r.length]=z);return r};h.values=function(i){return h.map(i,h.identity)};h.functions=h.methods=function(i){var r=[],z;for(z in i)h.isFunction(i[z])&&r.push(z);return r.sort()};h.extend=function(i){y(B.call(arguments,1),function(r){for(var z in r)r[z]!==
void 0&&(i[z]=r[z])});return i};h.defaults=function(i){y(B.call(arguments,1),function(r){for(var z in r)i[z]==null&&(i[z]=r[z])});return i};h.clone=function(i){return h.isArray(i)?i.slice():h.extend({},i)};h.tap=function(i,r){r(i);return i};h.isEqual=function(i,r){if(i===r)return true;var z=typeof i;if(z!=typeof r)return false;if(i==r)return true;if(!i&&r||i&&!r)return false;if(i._chain)i=i._wrapped;if(r._chain)r=r._wrapped;if(i.isEqual)return i.isEqual(r);if(r.isEqual)return r.isEqual(i);if(h.isDate(i)&&
h.isDate(r))return i.getTime()===r.getTime();if(h.isNaN(i)&&h.isNaN(r))return false;if(h.isRegExp(i)&&h.isRegExp(r))return i.source===r.source&&i.global===r.global&&i.ignoreCase===r.ignoreCase&&i.multiline===r.multiline;if(z!=="object")return false;if(i.length&&i.length!==r.length)return false;z=h.keys(i);var H=h.keys(r);if(z.length!=H.length)return false;for(var P in i)if(!(P in r)||!h.isEqual(i[P],r[P]))return false;return true};h.isEmpty=function(i){if(h.isArray(i)||h.isString(i))return i.length===
0;for(var r in i)if(o.call(i,r))return false;return true};h.isElement=function(i){return!!(i&&i.nodeType==1)};h.isArray=T||function(i){return W.call(i)==="[object Array]"};h.isObject=function(i){return i===Object(i)};h.isArguments=function(i){return!(!i||!o.call(i,"callee"))};h.isFunction=function(i){return!(!i||!i.constructor||!i.call||!i.apply)};h.isString=function(i){return!!(i===""||i&&i.charCodeAt&&i.substr)};h.isNumber=function(i){return!!(i===0||i&&i.toExponential&&i.toFixed)};h.isNaN=function(i){return i!==
i};h.isBoolean=function(i){return i===true||i===false};h.isDate=function(i){return!(!i||!i.getTimezoneOffset||!i.setUTCFullYear)};h.isRegExp=function(i){return!(!i||!i.test||!i.exec||!(i.ignoreCase||i.ignoreCase===false))};h.isNull=function(i){return i===null};h.isUndefined=function(i){return i===void 0};h.noConflict=function(){q._=$;return this};h.identity=function(i){return i};h.times=function(i,r,z){for(var H=0;H<i;H++)r.call(z,H)};h.mixin=function(i){y(h.functions(i),function(r){Q(r,h[r]=i[r])})};
var x=0;h.uniqueId=function(i){var r=x++;return i?i+r:r};h.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g};h.template=function(i,r){var z=h.templateSettings;z="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+i.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(z.interpolate,function(H,P){return"',"+P.replace(/\\'/g,"'")+",'"}).replace(z.evaluate||null,function(H,P){return"');"+P.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+"__p.push('"}).replace(/\r/g,
"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');";z=new Function("obj",z);return r?z(r):z};var E=function(i){this._wrapped=i};h.prototype=E.prototype;var G=function(i,r){return r?h(i).chain():i},Q=function(i,r){E.prototype[i]=function(){var z=B.call(arguments);I.call(z,this._wrapped);return G(r.apply(h,z),this._chain)}};h.mixin(h);y(["pop","push","reverse","shift","sort","splice","unshift"],function(i){var r=C[i];E.prototype[i]=function(){r.apply(this._wrapped,arguments);
return G(this._wrapped,this._chain)}});y(["concat","join","slice"],function(i){var r=C[i];E.prototype[i]=function(){return G(r.apply(this._wrapped,arguments),this._chain)}});E.prototype.chain=function(){this._chain=true;return this};E.prototype.value=function(){return this._wrapped}})();(function(){var q=this,$=q.Backbone,N;N=typeof exports!=="undefined"?exports:q.Backbone={};N.VERSION="0.5.3";var C=q._;if(!C&&typeof require!=="undefined")C=require("underscore")._;var T=q.jQuery||q.Zepto;N.noConflict=function(){q.Backbone=$;return this};N.emulateHTTP=false;N.emulateJSON=false;N.Events={bind:function(g,h,y){var p=this._callbacks||(this._callbacks={});(p[g]||(p[g]=[])).push([h,y]);return this},unbind:function(g,h){var y;if(g){if(y=this._callbacks)if(h){y=y[g];if(!y)return this;for(var p=
0,l=y.length;p<l;p++)if(y[p]&&h===y[p][0]){y[p]=null;break}}else y[g]=[]}else this._callbacks={};return this},trigger:function(g){var h,y,p,l,x=2;if(!(y=this._callbacks))return this;for(;x--;)if(h=x?g:"all",h=y[h])for(var E=0,G=h.length;E<G;E++)(p=h[E])?(l=x?Array.prototype.slice.call(arguments,1):arguments,p[0].apply(p[1]||this,l)):(h.splice(E,1),E--,G--);return this}};N.Model=function(g,h){var y;g||(g={});if(y=this.defaults){C.isFunction(y)&&(y=y.call(this));g=C.extend({},y,g)}this.attributes={};
this._escapedAttributes={};this.cid=C.uniqueId("c");this.set(g,{silent:true});this._changed=false;this._previousAttributes=C.clone(this.attributes);if(h&&h.collection)this.collection=h.collection;this.initialize(g,h)};C.extend(N.Model.prototype,N.Events,{_previousAttributes:null,_changed:false,idAttribute:"id",initialize:function(){},toJSON:function(){return C.clone(this.attributes)},get:function(g){return this.attributes[g]},escape:function(g){var h;if(h=this._escapedAttributes[g])return h;h=this.attributes[g];
return this._escapedAttributes[g]=(h==null?"":""+h).replace(/&(?!\w+;|#\d+;|#x[\da-f]+;)/gi,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},has:function(g){return this.attributes[g]!=null},set:function(g,h){h||(h={});if(!g)return this;if(g.attributes)g=g.attributes;var y=this.attributes,p=this._escapedAttributes;if(!h.silent&&this.validate&&!this._performValidation(g,h))return false;if(this.idAttribute in g)this.id=g[this.idAttribute];
var l=this._changing;this._changing=true;for(var x in g){var E=g[x];if(!C.isEqual(y[x],E)){y[x]=E;delete p[x];this._changed=true;h.silent||this.trigger("change:"+x,this,E,h)}}!l&&!h.silent&&this._changed&&this.change(h);this._changing=false;return this},unset:function(g,h){if(!(g in this.attributes))return this;h||(h={});var y={};y[g]=void 0;if(!h.silent&&this.validate&&!this._performValidation(y,h))return false;delete this.attributes[g];delete this._escapedAttributes[g];g==this.idAttribute&&delete this.id;
this._changed=true;h.silent||(this.trigger("change:"+g,this,void 0,h),this.change(h));return this},clear:function(g){g||(g={});var h,y=this.attributes,p={};for(h in y)p[h]=void 0;if(!g.silent&&this.validate&&!this._performValidation(p,g))return false;this.attributes={};this._escapedAttributes={};this._changed=true;if(!g.silent){for(h in y)this.trigger("change:"+h,this,void 0,g);this.change(g)}return this},fetch:function(g){g||(g={});var h=this,y=g.success;g.success=function(p,l,x){if(!h.set(h.parse(p,
x),g))return false;y&&y(h,p)};g.error=R(g.error,h,g);return(this.sync||N.sync).call(this,"read",this,g)},save:function(g,h){h||(h={});if(g&&!this.set(g,h))return false;var y=this,p=h.success;h.success=function(x,E,G){if(!y.set(y.parse(x,G),h))return false;p&&p(y,x,G)};h.error=R(h.error,y,h);var l=this.isNew()?"create":"update";return(this.sync||N.sync).call(this,l,this,h)},destroy:function(g){g||(g={});if(this.isNew())return this.trigger("destroy",this,this.collection,g);var h=this,y=g.success;g.success=
function(p){h.trigger("destroy",h,h.collection,g);y&&y(h,p)};g.error=R(g.error,h,g);return(this.sync||N.sync).call(this,"delete",this,g)},url:function(){var g=v(this.collection)||this.urlRoot||F();if(this.isNew())return g;return g+(g.charAt(g.length-1)=="/"?"":"/")+encodeURIComponent(this.id)},parse:function(g){return g},clone:function(){return new this.constructor(this)},isNew:function(){return this.id==null},change:function(g){this.trigger("change",this,g);this._previousAttributes=C.clone(this.attributes);
this._changed=false},hasChanged:function(g){if(g)return this._previousAttributes[g]!=this.attributes[g];return this._changed},changedAttributes:function(g){g||(g=this.attributes);var h=this._previousAttributes,y=false,p;for(p in g)C.isEqual(h[p],g[p])||(y=y||{},y[p]=g[p]);return y},previous:function(g){if(!g||!this._previousAttributes)return null;return this._previousAttributes[g]},previousAttributes:function(){return C.clone(this._previousAttributes)},_performValidation:function(g,h){var y=this.validate(g);
if(y)return h.error?h.error(this,y,h):this.trigger("error",this,y,h),false;return true}});N.Collection=function(g,h){h||(h={});if(h.comparator)this.comparator=h.comparator;C.bindAll(this,"_onModelEvent","_removeReference");this._reset();g&&this.reset(g,{silent:true});this.initialize.apply(this,arguments)};C.extend(N.Collection.prototype,N.Events,{model:N.Model,initialize:function(){},toJSON:function(){return this.map(function(g){return g.toJSON()})},add:function(g,h){if(C.isArray(g))for(var y=0,p=
g.length;y<p;y++)this._add(g[y],h);else this._add(g,h);return this},remove:function(g,h){if(C.isArray(g))for(var y=0,p=g.length;y<p;y++)this._remove(g[y],h);else this._remove(g,h);return this},get:function(g){if(g==null)return null;return this._byId[g.id!=null?g.id:g]},getByCid:function(g){return g&&this._byCid[g.cid||g]},at:function(g){return this.models[g]},sort:function(g){g||(g={});if(!this.comparator)throw Error("Cannot sort a set without a comparator");this.models=this.sortBy(this.comparator);
g.silent||this.trigger("reset",this,g);return this},pluck:function(g){return C.map(this.models,function(h){return h.get(g)})},reset:function(g,h){g||(g=[]);h||(h={});this.each(this._removeReference);this._reset();this.add(g,{silent:true});h.silent||this.trigger("reset",this,h);return this},fetch:function(g){g||(g={});var h=this,y=g.success;g.success=function(p,l,x){h[g.add?"add":"reset"](h.parse(p,x),g);y&&y(h,p)};g.error=R(g.error,h,g);return(this.sync||N.sync).call(this,"read",this,g)},create:function(g,
h){var y=this;h||(h={});g=this._prepareModel(g,h);if(!g)return false;var p=h.success;h.success=function(l,x,E){y.add(l,h);p&&p(l,x,E)};g.save(null,h);return g},parse:function(g){return g},chain:function(){return C(this.models).chain()},_reset:function(){this.length=0;this.models=[];this._byId={};this._byCid={}},_prepareModel:function(g,h){if(g instanceof N.Model){if(!g.collection)g.collection=this}else{var y=g;g=new this.model(y,{collection:this});g.validate&&!g._performValidation(y,h)&&(g=false)}return g},
_add:function(g,h){h||(h={});g=this._prepareModel(g,h);if(!g)return false;var y=this.getByCid(g);if(y)throw Error(["Can't add the same model to a set twice",y.id]);this._byId[g.id]=g;this._byCid[g.cid]=g;this.models.splice(h.at!=null?h.at:this.comparator?this.sortedIndex(g,this.comparator):this.length,0,g);g.bind("all",this._onModelEvent);this.length++;h.silent||g.trigger("add",g,this,h);return g},_remove:function(g,h){h||(h={});g=this.getByCid(g)||this.get(g);if(!g)return null;delete this._byId[g.id];
delete this._byCid[g.cid];this.models.splice(this.indexOf(g),1);this.length--;h.silent||g.trigger("remove",g,this,h);this._removeReference(g);return g},_removeReference:function(g){this==g.collection&&delete g.collection;g.unbind("all",this._onModelEvent)},_onModelEvent:function(g,h,y,p){(g=="add"||g=="remove")&&y!=this||(g=="destroy"&&this._remove(h,p),h&&g==="change:"+h.idAttribute&&(delete this._byId[h.previous(h.idAttribute)],this._byId[h.id]=h),this.trigger.apply(this,arguments))}});C.each(["forEach",
"each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","sortBy","sortedIndex","toArray","size","first","rest","last","without","indexOf","lastIndexOf","isEmpty","groupBy"],function(g){N.Collection.prototype[g]=function(){return C[g].apply(C,[this.models].concat(C.toArray(arguments)))}});N.Router=function(g){g||(g={});if(g.routes)this.routes=g.routes;this._bindRoutes();this.initialize.apply(this,arguments)};
var B=/:([\w\d]+)/g,I=/\*([\w\d]+)/g,W=/[-[\]{}()+?.,\\^$|#\s]/g;C.extend(N.Router.prototype,N.Events,{initialize:function(){},route:function(g,h,y){N.history||(N.history=new N.History);C.isRegExp(g)||(g=this._routeToRegExp(g));N.history.route(g,C.bind(function(p){p=this._extractParameters(g,p);y.apply(this,p);this.trigger.apply(this,["route:"+h].concat(p))},this))},navigate:function(g,h){N.history.navigate(g,h)},_bindRoutes:function(){if(this.routes){var g=[],h;for(h in this.routes)g.unshift([h,
this.routes[h]]);h=0;for(var y=g.length;h<y;h++)this.route(g[h][0],g[h][1],this[g[h][1]])}},_routeToRegExp:function(g){g=g.replace(W,"\\$&").replace(B,"([^/]*)").replace(I,"(.*?)");return RegExp("^"+g+"$")},_extractParameters:function(g,h){return g.exec(h).slice(1)}});N.History=function(){this.handlers=[];C.bindAll(this,"checkUrl")};var o=/^#*/,U=/msie [\w.]+/,J=false;C.extend(N.History.prototype,{interval:50,getFragment:function(g,h){if(g==null)if(this._hasPushState||h){g=window.location.pathname;
var y=window.location.search;y&&(g+=y);g.indexOf(this.options.root)==0&&(g=g.substr(this.options.root.length))}else g=window.location.hash;return decodeURIComponent(g.replace(o,""))},start:function(g){if(J)throw Error("Backbone.history has already been started");this.options=C.extend({},{root:"/"},this.options,g);this._wantsPushState=!!this.options.pushState;this._hasPushState=!(!this.options.pushState||!window.history||!window.history.pushState);g=this.getFragment();var h=document.documentMode;if(h=
U.exec(navigator.userAgent.toLowerCase())&&(!h||h<=7)){this.iframe=T('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow;this.navigate(g)}this._hasPushState?T(window).bind("popstate",this.checkUrl):"onhashchange"in window&&!h?T(window).bind("hashchange",this.checkUrl):setInterval(this.checkUrl,this.interval);this.fragment=g;J=true;g=window.location;h=g.pathname==this.options.root;if(this._wantsPushState&&!this._hasPushState&&!h)return this.fragment=this.getFragment(null,
true),window.location.replace(this.options.root+"#"+this.fragment),true;else if(this._wantsPushState&&this._hasPushState&&h&&g.hash){this.fragment=g.hash.replace(o,"");window.history.replaceState({},document.title,g.protocol+"//"+g.host+this.options.root+this.fragment)}if(!this.options.silent)return this.loadUrl()},route:function(g,h){this.handlers.unshift({route:g,callback:h})},checkUrl:function(){var g=this.getFragment();g==this.fragment&&this.iframe&&(g=this.getFragment(this.iframe.location.hash));
if(g==this.fragment||g==decodeURIComponent(this.fragment))return false;this.iframe&&this.navigate(g);this.loadUrl()||this.loadUrl(window.location.hash)},loadUrl:function(g){var h=this.fragment=this.getFragment(g);return C.any(this.handlers,function(y){if(y.route.test(h))return y.callback(h),true})},navigate:function(g,h){var y=(g||"").replace(o,"");if(!(this.fragment==y||this.fragment==decodeURIComponent(y))){if(this._hasPushState){var p=window.location;y.indexOf(this.options.root)!=0&&(y=this.options.root+
y);this.fragment=y;window.history.pushState({},document.title,p.protocol+"//"+p.host+y)}else if(window.location.hash=this.fragment=y,this.iframe&&y!=this.getFragment(this.iframe.location.hash)){this.iframe.document.open().close();this.iframe.location.hash=y}h&&this.loadUrl(g)}}});N.View=function(g){this.cid=C.uniqueId("view");this._configure(g||{});this._ensureElement();this.delegateEvents();this.initialize.apply(this,arguments)};var k=/^(\S+)\s*(.*)$/,A=["model","collection","el","id","attributes",
"className","tagName"];C.extend(N.View.prototype,N.Events,{tagName:"div",$:function(g){return T(g,this.el)},initialize:function(){},render:function(){return this},remove:function(){T(this.el).remove();return this},make:function(g,h,y){g=document.createElement(g);h&&T(g).attr(h);y&&T(g).html(y);return g},delegateEvents:function(g){if(g||(g=this.events))for(var h in C.isFunction(g)&&(g=g.call(this)),T(this.el).unbind(".delegateEvents"+this.cid),g){var y=this[g[h]];if(!y)throw Error('Event "'+g[h]+'" does not exist');
var p=h.match(k),l=p[1];p=p[2];y=C.bind(y,this);l+=".delegateEvents"+this.cid;p===""?T(this.el).bind(l,y):T(this.el).delegate(p,l,y)}},_configure:function(g){this.options&&(g=C.extend({},this.options,g));for(var h=0,y=A.length;h<y;h++){var p=A[h];g[p]&&(this[p]=g[p])}this.options=g},_ensureElement:function(){if(this.el){if(C.isString(this.el))this.el=T(this.el).get(0)}else{var g=this.attributes||{};if(this.id)g.id=this.id;if(this.className)g["class"]=this.className;this.el=this.make(this.tagName,
g)}}});N.Model.extend=N.Collection.extend=N.Router.extend=N.View.extend=function(g,h){var y=n(this,g,h);y.extend=this.extend;return y};var D={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};N.sync=function(g,h,y){var p=D[g];y=C.extend({type:p,dataType:"json"},y);if(!y.url)y.url=v(h)||F();if(!y.data&&h&&(g=="create"||g=="update")){y.contentType="application/json";y.data=JSON.stringify(h.toJSON())}if(N.emulateJSON){y.contentType="application/x-www-form-urlencoded";y.data=y.data?{model:y.data}:
{}}if(N.emulateHTTP&&(p==="PUT"||p==="DELETE")){if(N.emulateJSON)y.data._method=p;y.type="POST";y.beforeSend=function(l){l.setRequestHeader("X-HTTP-Method-Override",p)}}if(y.type!=="GET"&&!N.emulateJSON)y.processData=false;return T.ajax(y)};var L=function(){},n=function(g,h,y){var p;p=h&&h.hasOwnProperty("constructor")?h.constructor:function(){return g.apply(this,arguments)};C.extend(p,g);L.prototype=g.prototype;p.prototype=new L;h&&C.extend(p.prototype,h);y&&C.extend(p,y);p.prototype.constructor=
p;p.__super__=g.prototype;return p},v=function(g){if(!g||!g.url)return null;return C.isFunction(g.url)?g.url():g.url},F=function(){throw Error('A "url" property or function must be specified');},R=function(g,h,y){return function(p){g?g(h,p,y):h.trigger("error",h,p,y)}}}).call(this);/*
 
 JavaScript Debug - v0.4 - 6/22/2010
 http://benalman.com/projects/javascript-debug-console-log/

 Copyright (c) 2010 "Cowboy" Ben Alman
 Dual licensed under the MIT and GPL licenses.
 http://benalman.com/about/license/

 With lots of help from Paul Irish!
 http://paulirish.com/
*/
window.debug=function(){function q(A){if(B&&(I||!C||!C.log))B.apply($,A)}for(var $=this,N=Array.prototype.slice,C=$.console,T={},B,I,W=9,o=["error","warn","info","debug","log"],U="assert clear count dir dirxml exception group groupCollapsed groupEnd profile profileEnd table time timeEnd trace".split(" "),J=U.length,k=[];--J>=0;)(function(A){T[A]=function(){W!==0&&C&&C[A]&&C[A].apply(C,arguments)}})(U[J]);for(J=o.length;--J>=0;)(function(A,D){T[D]=function(){var L=N.call(arguments),n=[D].concat(L);
k.push(n);q(n);if(C&&(W>0?W>A:o.length+W<=A))C.firebug?C[D].apply($,L):C[D]?C[D](L):C.log(L)}})(J,o[J]);T.setLevel=function(A){W=typeof A==="number"?A:9};T.setCallback=function(){var A=N.call(arguments),D=k.length,L=D;B=A.shift()||null;I=typeof A[0]==="boolean"?A.shift():false;for(L-=typeof A[0]==="number"?A.shift():D;L<D;)q(k[L++])};return T}();(function(q){var $=q("<b/>");q.subscribe=function(N,C){function T(){return C.apply(this,Array.prototype.slice.call(arguments,1))}T.guid=C.guid=C.guid||(q.guid?q.guid++:q.event.guid++);$.bind(N,T)};q.unsubscribe=function(){$.unbind.apply($,arguments)};q.publish=function(){$.trigger.apply($,arguments)}})(jQuery);/*

 Copyright (c) 2010 Brandon Aaron (http://brandonaaron.net)
 Licensed under the MIT License (LICENSE.txt).

 Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.
 Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.
 Thanks to: Seamus Leahy for adding deltaX and deltaY

 Version: 3.0.4

 Requires: 1.2.2+
*/
(function(q){function $(C){var T=C||window.event,B=[].slice.call(arguments,1),I=0,W=0,o=0;C=q.event.fix(T);C.type="mousewheel";if(C.wheelDelta)I=C.wheelDelta/120;if(C.detail)I=-C.detail/3;o=I;if(T.axis!==undefined&&T.axis===T.HORIZONTAL_AXIS){o=0;W=-1*I}if(T.wheelDeltaY!==undefined)o=T.wheelDeltaY/120;if(T.wheelDeltaX!==undefined)W=-1*T.wheelDeltaX/120;B.unshift(C,I,W,o);return q.event.handle.apply(this,B)}var N=["DOMMouseScroll","mousewheel"];q.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var C=
N.length;C;)this.addEventListener(N[--C],$,false);else this.onmousewheel=$},teardown:function(){if(this.removeEventListener)for(var C=N.length;C;)this.removeEventListener(N[--C],$,false);else this.onmousewheel=null}};q.fn.extend({mousewheel:function(C){return C?this.bind("mousewheel",C):this.trigger("mousewheel")},unmousewheel:function(C){return this.unbind("mousewheel",C)}})})(jQuery);/*

 jQuery.UI.iPad plugin
 Copyright (c) 2010 Stephen von Takach
 licensed under MIT.
 Date: 27/8/2010

 Project Home: 
 http://code.google.com/p/jquery-ui-for-ipad-and-iphone/
*/
(function(q){function $(){if(o){window.clearTimeout(J);o=false;U=null}}function N(A){if(!o){o=true;U=A.changedTouches[0];J=window.setTimeout(function(){o=false;var D=U,L=document.createEvent("MouseEvent");L.initMouseEvent("mouseup",true,true,window,1,D.screenX,D.screenY,D.clientX,D.clientY,false,false,false,false,0,null);D.target.dispatchEvent(L);L=document.createEvent("MouseEvent");L.initMouseEvent("mousedown",true,true,window,1,D.screenX,D.screenY,D.clientX,D.clientY,false,false,false,false,2,null);
D.target.dispatchEvent(L);L=document.createEvent("MouseEvent");L.initMouseEvent("contextmenu",true,true,window,1,D.screenX+50,D.screenY+5,D.clientX+50,D.clientY+5,false,false,false,false,2,null);D.target.dispatchEvent(L);k=true;U=null},800)}}function C(A){var D=A.changedTouches[0],L="mouseover",n=document.createEvent("MouseEvent");n.initMouseEvent(L,true,true,window,1,D.screenX,D.screenY,D.clientX,D.clientY,false,false,false,false,0,null);D.target.dispatchEvent(n);L="mousedown";n=document.createEvent("MouseEvent");
n.initMouseEvent(L,true,true,window,1,D.screenX,D.screenY,D.clientX,D.clientY,false,false,false,false,0,null);D.target.dispatchEvent(n);if(I){window.clearTimeout(W);if(D.target==B){B=null;I=false;L="click";n=document.createEvent("MouseEvent");n.initMouseEvent(L,true,true,window,1,D.screenX,D.screenY,D.clientX,D.clientY,false,false,false,false,0,null);D.target.dispatchEvent(n);L="dblclick";n=document.createEvent("MouseEvent");n.initMouseEvent(L,true,true,window,1,D.screenX,D.screenY,D.clientX,D.clientY,
false,false,false,false,0,null);D.target.dispatchEvent(n)}else{B=D.target;I=true;W=window.setTimeout(function(){I=false},600);N(A)}}else{B=D.target;I=true;W=window.setTimeout(function(){I=false},600);N(A)}}function T(A){var D="";if(!(A.touches.length>1)){switch(A.type){case "gesturestart":A.preventDefault();break;case "touchstart":if(q(A.changedTouches[0].target).is("select"))return;C(A);A.preventDefault();return false;case "touchmove":$();D="mousemove";A.preventDefault();break;case "touchend":if(k){k=
false;A.preventDefault();return false}$();D="mouseup";break;default:return}A=A.changedTouches[0];var L=document.createEvent("MouseEvent");L.initMouseEvent(D,true,true,window,1,A.screenX,A.screenY,A.clientX,A.clientY,false,false,false,false,0,null);A.target.dispatchEvent(L);if(D=="mouseup"&&I&&A.target==B){L=document.createEvent("MouseEvent");L.initMouseEvent("click",true,true,window,1,A.screenX,A.screenY,A.clientX,A.clientY,false,false,false,false,0,null);A.target.dispatchEvent(L)}}}q.extend(q.support,
{touch:typeof Touch=="object"});q.fn.addTouch=function(){q.support.touch&&this.each(function(A,D){D.addEventListener("touchstart",T,false);D.addEventListener("touchmove",T,false);D.addEventListener("touchend",T,false);D.addEventListener("touchcancel",T,false)})};var B=null,I=false,W=null,o=false,U=null,J=null,k=false})(jQuery);
/iPad|iPhone/.test(navigator.userAgent)&&function(q){var $=q.ui.mouse.prototype,N=$._mouseInit;q.extend($,{_mouseInit:function(){this.element.bind("touchstart."+this.widgetName,q.proxy(this,"_touchStart"));N.apply(this,arguments)},_touchStart:function(C){if(C.originalEvent.targetTouches.length!=1)return false;this.element.bind("touchmove."+this.widgetName,q.proxy(this,"_touchMove")).bind("touchend."+this.widgetName,q.proxy(this,"_touchEnd"));this._modifyEvent(C);this._mouseDown(C);return false},_touchMove:function(C){this._modifyEvent(C);
this._mouseMove(C)},_touchEnd:function(C){this.element.unbind("touchmove."+this.widgetName).unbind("touchend."+this.widgetName);this._mouseUp(C)},_modifyEvent:function(C){C.which=1;var T=C.originalEvent.targetTouches[0];C.pageX=T.clientX;C.pageY=T.clientY}})}(jQuery);/*

 Raphael 1.5.2 - JavaScript Vector Library

 Copyright (c) 2010 Dmitry Baranovskiy (http://raphaeljs.com)
 Licensed under the MIT (http://raphaeljs.com/license.html) license.
*/
(function(){function q(){if(q.is(arguments[0],P)){for(var a=arguments[0],c=Na[v](q,a.splice(0,3+q.is(a[0],H))),d=c.set(),f=0,j=a[l];f<j;f++){var e=a[f]||{};W[J](e.type)&&d[ba](c[e.type]().attr(e))}return d}return Na[v](q,arguments)}function $(){for(var a=[],c=0;c<32;c++)a[c]=(~~(E.random()*16))[Y](16);a[12]=4;a[16]=(a[16]&3|8)[Y](16);return"r-"+a[p]("")}function N(a,c,d){function f(){var j=Array[U].slice.call(arguments,0),e=j[p]("\u25ba"),m=f.cache=f.cache||{},s=f.count=f.count||[];if(m[J](e))return d?
d(m[e]):m[e];s[l]>=1E3&&delete m[s.shift()];s[ba](e);m[e]=a[v](c,j);return d?d(m[e]):m[e]}return f}function C(){return this.x+R+this.y}function T(a){return function(c,d,f,j){var e={back:a};q.is(f,"function")?j=f:e.rot=f;c&&c.constructor==ja&&(c=c.attrs.path);c&&(e.along=c);return this.animate(e,d,j)}}function B(a,c,d,f,j,e){function m(V,ea){var X,S,aa,ka;aa=V;for(S=0;S<8;S++){ka=((w*aa+u)*aa+s)*aa-V;if(i(ka)<ea)return aa;X=(3*w*aa+2*u)*aa+s;if(i(X)<1.0E-6)break;aa-=ka/X}X=0;S=1;aa=V;if(aa<X)return X;
if(aa>S)return S;for(;X<S;){ka=((w*aa+u)*aa+s)*aa;if(i(ka-V)<ea)break;V>ka?X=aa:S=aa;aa=(S-X)/2+X}return aa}var s=3*c,u=3*(f-c)-s,w=1-s-u,K=3*d,M=3*(j-d)-K,O=1-K-M;return function(V,ea){var X=m(V,ea);return((O*X+M)*X+K)*X}(a,1/(200*e))}q.version="1.5.2";var I=/[, ]+/,W={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},o=/\{(\d+)\}/g,U="prototype",J="hasOwnProperty",k=document,A=window,D={was:Object[U][J].call(A,"Raphael"),is:A.Raphael},L=function(){this.customAttributes={}},n,v="apply",F="createTouch"in
k,R=" ",g=String,h="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend orientationchange touchcancel gesturestart gesturechange gestureend".split(R),y={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},p="join",l="length",x=g[U].toLowerCase,E=Math,G=E.max,Q=E.min,i=E.abs,r=E.pow,z=E.PI,H="number",P="array",Y="toString",ga=Object[U][Y],ba="push",fa=/^url\(['"]?([^\)]+?)['"]?\)$/i,la=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i,
ha={NaN:1,Infinity:1,"-Infinity":1},ra=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,ca=E.round,Z=parseFloat,na=parseInt,wa=g[U].toUpperCase,Ea={blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/",opacity:1,path:"M0,0",r:0,rotation:0,rx:0,ry:0,scale:"1 1",src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt",
"stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",translation:"0 0",width:0,x:0,y:0},Oa={along:"along",blur:H,"clip-rect":"csv",cx:H,cy:H,fill:"colour","fill-opacity":H,"font-size":H,height:H,opacity:H,path:"path",r:H,rotation:"csv",rx:H,ry:H,scale:"csv",stroke:"colour","stroke-opacity":H,"stroke-width":H,translation:"csv",width:H,x:H,y:H},ub=/^(from|to|\d+%?)$/,Pa=/\s*,\s*/,vb={hs:1,rg:1},wb=/,?([achlmqrstvxz]),?/gi,
xb=/([achlmqstvz])[\s,]*((-?\d*\.?\d*(?:e[-+]?\d+)?\s*,?\s*)+)/ig,yb=/(-?\d*\.?\d*(?:e[-+]?\d+)?)\s*,?\s*/ig,Za=/^r(?:\(([^,]+?)\s*,\s*([^\)]+?)\))?/,Ab=function(a,c){return a.key-c.key};q.type=A.SVGAngle||k.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML";if(q.type=="VML"){var ta=k.createElement("div");ta.innerHTML='<v:shape adj="1"/>';ta=ta.firstChild;ta.style.behavior="url(#default#VML)";if(!(ta&&typeof ta.adj=="object"))return q.type=null;ta=null}q.svg=
!(q.vml=q.type=="VML");L[U]=q[U];n=L[U];q._id=0;q._oid=0;q.fn={};q.is=function(a,c){c=x.call(c);if(c=="finite")return!ha[J](+a);return c=="null"&&a===null||c==typeof a||c=="object"&&a===Object(a)||c=="array"&&Array.isArray&&Array.isArray(a)||ga.call(a).slice(8,-1).toLowerCase()==c};q.angle=function(a,c,d,f,j,e){if(j==null){a-=d;c-=f;if(!a&&!c)return 0;return((a<0)*180+E.atan(-c/-a)*180/z+360)%360}return q.angle(a,c,j,e)-q.angle(d,f,j,e)};q.rad=function(a){return a%360*z/180};q.deg=function(a){return a*
180/z%360};q.snapTo=function(a,c,d){d=q.is(d,"finite")?d:10;if(q.is(a,P))for(var f=a.length;f--;){if(i(a[f]-c)<=d)return a[f]}else{a=+a;f=c%a;if(f<d)return c-f;if(f>a-d)return c-f+a}return c};q.setWindow=function(a){A=a;k=A.document};var Fa=function(a){if(q.vml){var c=/^\s+|\s+$/g,d;try{var f=new ActiveXObject("htmlfile");f.write("<body>");f.close();d=f.body}catch(j){d=createPopup().document.body}var e=d.createTextRange();Fa=N(function(s){try{d.style.color=g(s).replace(c,"");var u=e.queryCommandValue("ForeColor");
return"#"+("000000"+((u&255)<<16|u&65280|(u&16711680)>>>16)[Y](16)).slice(-6)}catch(w){return"none"}})}else{var m=k.createElement("i");m.title="Rapha\u00ebl Colour Picker";m.style.display="none";k.body.appendChild(m);Fa=N(function(s){m.style.color=s;return k.defaultView.getComputedStyle(m,"").getPropertyValue("color")})}return Fa(a)},$a=function(){return"hsb("+[this.h,this.s,this.b]+")"},Bb=function(){return"hsl("+[this.h,this.s,this.l]+")"},Cb=function(){return this.hex};q.hsb2rgb=function(a,c,d,
f){if(q.is(a,"object")&&"h"in a&&"s"in a&&"b"in a){d=a.b;c=a.s;a=a.h;f=a.o}return q.hsl2rgb(a,c,d/2,f)};q.hsl2rgb=function(a,c,d,f){if(q.is(a,"object")&&"h"in a&&"s"in a&&"l"in a){d=a.l;c=a.s;a=a.h}if(a>1||c>1||d>1){a/=360;c/=100;d/=100}var j={},e=["r","g","b"],m;if(c){d<0.5?m=d*(1+c):m=d+c-d*c;c=2*d-m;for(var s=0;s<3;s++){d=a+1/3*-(s-1);d<0&&d++;d>1&&d--;d*6<1?j[e[s]]=c+(m-c)*6*d:d*2<1?j[e[s]]=m:d*3<2?j[e[s]]=c+(m-c)*(2/3-d)*6:j[e[s]]=c}}else j={r:d,g:d,b:d};j.r*=255;j.g*=255;j.b*=255;j.hex="#"+
(16777216|j.b|j.g<<8|j.r<<16).toString(16).slice(1);q.is(f,"finite")&&(j.opacity=f);j.toString=Cb;return j};q.rgb2hsb=function(a,c,d){if(c==null&&q.is(a,"object")&&"r"in a&&"g"in a&&"b"in a){d=a.b;c=a.g;a=a.r}if(c==null&&q.is(a,"string")){d=q.getRGB(a);a=d.r;c=d.g;d=d.b}if(a>1||c>1||d>1){a/=255;c/=255;d/=255}var f=G(a,c,d),j=Q(a,c,d),e;if(j==f)return{h:0,s:0,b:f,toString:$a};j=f-j;a==f?e=(c-d)/j:c==f?e=2+(d-a)/j:e=4+(a-c)/j;e/=6;e<0&&e++;e>1&&e--;return{h:e,s:j/f,b:f,toString:$a}};q.rgb2hsl=function(a,
c,d){if(c==null&&q.is(a,"object")&&"r"in a&&"g"in a&&"b"in a){d=a.b;c=a.g;a=a.r}if(c==null&&q.is(a,"string")){d=q.getRGB(a);a=d.r;c=d.g;d=d.b}if(a>1||c>1||d>1){a/=255;c/=255;d/=255}var f=G(a,c,d),j=Q(a,c,d),e,m=(f+j)/2;if(j==f)a={h:0,s:0,l:m};else{var s=f-j;a==f?e=(c-d)/s:c==f?e=2+(d-a)/s:e=4+(a-c)/s;e/=6;e<0&&e++;e>1&&e--;a={h:e,s:m<0.5?s/(f+j):s/(2-f-j),l:m}}a.toString=Bb;return a};q._path2string=function(){return this.join(",").replace(wb,"$1")};q.getRGB=N(function(a){if(!a||(a=g(a)).indexOf("-")+
1)return{r:-1,g:-1,b:-1,hex:"none",error:1};if(a=="none")return{r:-1,g:-1,b:-1,hex:"none"};!(vb[J](a.toLowerCase().substring(0,2))||a.charAt()=="#")&&(a=Fa(a));var c,d,f,j,e;if(a=a.match(la)){if(a[2]){f=na(a[2].substring(5),16);d=na(a[2].substring(3,5),16);c=na(a[2].substring(1,3),16)}if(a[3]){f=na((e=a[3].charAt(3))+e,16);d=na((e=a[3].charAt(2))+e,16);c=na((e=a[3].charAt(1))+e,16)}if(a[4]){e=a[4].split(Pa);c=Z(e[0]);e[0].slice(-1)=="%"&&(c*=2.55);d=Z(e[1]);e[1].slice(-1)=="%"&&(d*=2.55);f=Z(e[2]);
e[2].slice(-1)=="%"&&(f*=2.55);a[1].toLowerCase().slice(0,4)=="rgba"&&(j=Z(e[3]));e[3]&&e[3].slice(-1)=="%"&&(j/=100)}if(a[5]){e=a[5].split(Pa);c=Z(e[0]);e[0].slice(-1)=="%"&&(c*=2.55);d=Z(e[1]);e[1].slice(-1)=="%"&&(d*=2.55);f=Z(e[2]);e[2].slice(-1)=="%"&&(f*=2.55);(e[0].slice(-3)=="deg"||e[0].slice(-1)=="\u00b0")&&(c/=360);a[1].toLowerCase().slice(0,4)=="hsba"&&(j=Z(e[3]));e[3]&&e[3].slice(-1)=="%"&&(j/=100);return q.hsb2rgb(c,d,f,j)}if(a[6]){e=a[6].split(Pa);c=Z(e[0]);e[0].slice(-1)=="%"&&(c*=
2.55);d=Z(e[1]);e[1].slice(-1)=="%"&&(d*=2.55);f=Z(e[2]);e[2].slice(-1)=="%"&&(f*=2.55);(e[0].slice(-3)=="deg"||e[0].slice(-1)=="\u00b0")&&(c/=360);a[1].toLowerCase().slice(0,4)=="hsla"&&(j=Z(e[3]));e[3]&&e[3].slice(-1)=="%"&&(j/=100);return q.hsl2rgb(c,d,f,j)}a={r:c,g:d,b:f};a.hex="#"+(16777216|f|d<<8|c<<16).toString(16).slice(1);q.is(j,"finite")&&(a.opacity=j);return a}return{r:-1,g:-1,b:-1,hex:"none",error:1}},q);q.getColor=function(a){a=this.getColor.start=this.getColor.start||{h:0,s:1,b:a||0.75};
var c=this.hsb2rgb(a.h,a.s,a.b);a.h+=0.075;if(a.h>1){a.h=0;a.s-=0.2;a.s<=0&&(this.getColor.start={h:0,s:1,b:a.b})}return c.hex};q.getColor.reset=function(){delete this.start};q.parsePathString=N(function(a){if(!a)return null;var c={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},d=[];q.is(a,P)&&q.is(a[0],P)&&(d=Ga(a));d[l]||g(a).replace(xb,function(f,j,e){var m=[];f=x.call(j);e.replace(yb,function(s,u){u&&m[ba](+u)});if(f=="m"&&m[l]>2){d[ba]([j].concat(m.splice(0,2)));f="l";j=j=="m"?"l":"L"}for(;m[l]>=c[f];){d[ba]([j].concat(m.splice(0,
c[f])));if(!c[f])break}});d[Y]=q._path2string;return d});q.findDotsAtSegment=function(a,c,d,f,j,e,m,s,u){var w=1-u,K=r(w,3)*a+r(w,2)*3*u*d+w*3*u*u*j+r(u,3)*m;w=r(w,3)*c+r(w,2)*3*u*f+w*3*u*u*e+r(u,3)*s;var M=a+2*u*(d-a)+u*u*(j-2*d+a),O=c+2*u*(f-c)+u*u*(e-2*f+c),V=d+2*u*(j-d)+u*u*(m-2*j+d),ea=f+2*u*(e-f)+u*u*(s-2*e+f);a=(1-u)*a+u*d;c=(1-u)*c+u*f;j=(1-u)*j+u*m;e=(1-u)*e+u*s;s=90-E.atan((M-V)/(O-ea))*180/z;(M>V||O<ea)&&(s+=180);return{x:K,y:w,m:{x:M,y:O},n:{x:V,y:ea},start:{x:a,y:c},end:{x:j,y:e},alpha:s}};
var Ia=N(function(a){if(!a)return{x:0,y:0,width:0,height:0};a=Ha(a);for(var c=0,d=0,f=[],j=[],e,m=0,s=a[l];m<s;m++){e=a[m];if(e[0]=="M"){c=e[1];d=e[2];f[ba](c);j[ba](d)}else{c=Db(c,d,e[1],e[2],e[3],e[4],e[5],e[6]);f=f.concat(c.min.x,c.max.x);j=j.concat(c.min.y,c.max.y);c=e[5];d=e[6]}}a=Q[v](0,f);e=Q[v](0,j);return{x:a,y:e,width:G[v](0,f)-a,height:G[v](0,j)-e}}),Ga=function(a){var c=[];if(!q.is(a,P)||!q.is(a&&a[0],P))a=q.parsePathString(a);for(var d=0,f=a[l];d<f;d++){c[d]=[];for(var j=0,e=a[d][l];j<
e;j++)c[d][j]=a[d][j]}c[Y]=q._path2string;return c},Qa=N(function(a){if(!q.is(a,P)||!q.is(a&&a[0],P))a=q.parsePathString(a);var c=[],d=0,f=0,j=0,e=0,m=0;if(a[0][0]=="M"){d=a[0][1];f=a[0][2];j=d;e=f;m++;c[ba](["M",d,f])}for(var s=a[l];m<s;m++){var u=c[m]=[],w=a[m];if(w[0]!=x.call(w[0])){u[0]=x.call(w[0]);switch(u[0]){case "a":u[1]=w[1];u[2]=w[2];u[3]=w[3];u[4]=w[4];u[5]=w[5];u[6]=+(w[6]-d).toFixed(3);u[7]=+(w[7]-f).toFixed(3);break;case "v":u[1]=+(w[1]-f).toFixed(3);break;case "m":j=w[1];e=w[2];default:for(var K=
1,M=w[l];K<M;K++)u[K]=+(w[K]-(K%2?d:f)).toFixed(3)}}else{c[m]=[];if(w[0]=="m"){j=w[1]+d;e=w[2]+f}u=0;for(K=w[l];u<K;u++)c[m][u]=w[u]}w=c[m][l];switch(c[m][0]){case "z":d=j;f=e;break;case "h":d+=+c[m][w-1];break;case "v":f+=+c[m][w-1];break;default:d+=+c[m][w-2];f+=+c[m][w-1]}}c[Y]=q._path2string;return c},0,Ga),Aa=N(function(a){if(!q.is(a,P)||!q.is(a&&a[0],P))a=q.parsePathString(a);var c=[],d=0,f=0,j=0,e=0,m=0;if(a[0][0]=="M"){d=+a[0][1];f=+a[0][2];j=d;e=f;m++;c[0]=["M",d,f]}for(var s=a[l];m<s;m++){var u=
c[m]=[],w=a[m];if(w[0]!=wa.call(w[0])){u[0]=wa.call(w[0]);switch(u[0]){case "A":u[1]=w[1];u[2]=w[2];u[3]=w[3];u[4]=w[4];u[5]=w[5];u[6]=+(w[6]+d);u[7]=+(w[7]+f);break;case "V":u[1]=+w[1]+f;break;case "H":u[1]=+w[1]+d;break;case "M":j=+w[1]+d;e=+w[2]+f;default:for(var K=1,M=w[l];K<M;K++)u[K]=+w[K]+(K%2?d:f)}}else{K=0;for(M=w[l];K<M;K++)c[m][K]=w[K]}switch(u[0]){case "Z":d=j;f=e;break;case "H":d=u[1];break;case "V":f=u[1];break;case "M":j=c[m][c[m][l]-2];e=c[m][c[m][l]-1];default:d=c[m][c[m][l]-2];f=
c[m][c[m][l]-1]}}c[Y]=q._path2string;return c},null,Ga),ab=function(a,c,d,f,j,e){var m=1/3,s=2/3;return[m*a+s*d,m*c+s*f,m*j+s*d,m*e+s*f,j,e]},bb=function(a,c,d,f,j,e,m,s,u,w){var K=z*120/180,M=z/180*(+j||0),O=[],V,ea=N(function(oa,pa,ma){var ya=oa*E.cos(ma)-pa*E.sin(ma);oa=oa*E.sin(ma)+pa*E.cos(ma);return{x:ya,y:oa}});if(w){aa=w[0];V=w[1];e=w[2];S=w[3]}else{V=ea(a,c,-M);a=V.x;c=V.y;V=ea(s,u,-M);s=V.x;u=V.y;E.cos(z/180*j);E.sin(z/180*j);V=(a-s)/2;aa=(c-u)/2;S=V*V/(d*d)+aa*aa/(f*f);if(S>1){S=E.sqrt(S);
d*=S;f*=S}S=d*d;var X=f*f;S=(e==m?-1:1)*E.sqrt(i((S*X-S*aa*aa-X*V*V)/(S*aa*aa+X*V*V)));e=S*d*aa/f+(a+s)/2;var S=S*-f*V/d+(c+u)/2,aa=E.asin(((c-S)/f).toFixed(9));V=E.asin(((u-S)/f).toFixed(9));aa=a<e?z-aa:aa;V=s<e?z-V:V;aa<0&&(aa=z*2+aa);V<0&&(V=z*2+V);m&&aa>V&&(aa-=z*2);!m&&V>aa&&(V-=z*2)}if(i(V-aa)>K){O=V;X=s;var ka=u;V=aa+K*(m&&V>aa?1:-1);s=e+d*E.cos(V);u=S+f*E.sin(V);O=bb(s,u,d,f,j,0,m,X,ka,[V,O,e,S])}e=V-aa;j=E.cos(aa);K=E.sin(aa);m=E.cos(V);V=E.sin(V);e=E.tan(e/4);d=4/3*d*e;e*=4/3*f;f=[a,c];
a=[a+d*K,c-e*j];c=[s+d*V,u-e*m];s=[s,u];a[0]=2*f[0]-a[0];a[1]=2*f[1]-a[1];if(w)return[a,c,s].concat(O);O=[a,c,s].concat(O)[p]().split(",");w=[];s=0;for(u=O[l];s<u;s++)w[s]=s%2?ea(O[s-1],O[s],M).y:ea(O[s],O[s+1],M).x;return w},Ja=function(a,c,d,f,j,e,m,s,u){var w=1-u;return{x:r(w,3)*a+r(w,2)*3*u*d+w*3*u*u*j+r(u,3)*m,y:r(w,3)*c+r(w,2)*3*u*f+w*3*u*u*e+r(u,3)*s}},Db=N(function(a,c,d,f,j,e,m,s){var u=j-2*d+a-(m-2*j+d),w=2*(d-a)-2*(j-d),K=a-d,M=(-w+E.sqrt(w*w-4*u*K))/2/u;u=(-w-E.sqrt(w*w-4*u*K))/2/u;var O=
[c,s],V=[a,m];i(M)>"1e12"&&(M=0.5);i(u)>"1e12"&&(u=0.5);if(M>0&&M<1){M=Ja(a,c,d,f,j,e,m,s,M);V[ba](M.x);O[ba](M.y)}if(u>0&&u<1){M=Ja(a,c,d,f,j,e,m,s,u);V[ba](M.x);O[ba](M.y)}u=e-2*f+c-(s-2*e+f);w=2*(f-c)-2*(e-f);K=c-f;M=(-w+E.sqrt(w*w-4*u*K))/2/u;u=(-w-E.sqrt(w*w-4*u*K))/2/u;i(M)>"1e12"&&(M=0.5);i(u)>"1e12"&&(u=0.5);if(M>0&&M<1){M=Ja(a,c,d,f,j,e,m,s,M);V[ba](M.x);O[ba](M.y)}if(u>0&&u<1){M=Ja(a,c,d,f,j,e,m,s,u);V[ba](M.x);O[ba](M.y)}return{min:{x:Q[v](0,V),y:Q[v](0,O)},max:{x:G[v](0,V),y:G[v](0,O)}}}),
Ha=N(function(a,c){var d=Aa(a),f=c&&Aa(c),j={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},e={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},m=function(X,S){var aa,ka;if(!X)return["C",S.x,S.y,S.x,S.y,S.x,S.y];!(X[0]in{T:1,Q:1})&&(S.qx=S.qy=null);switch(X[0]){case "M":S.X=X[1];S.Y=X[2];break;case "A":X=["C"].concat(bb[v](0,[S.x,S.y].concat(X.slice(1))));break;case "S":aa=S.x+(S.x-(S.bx||S.x));ka=S.y+(S.y-(S.by||S.y));X=["C",aa,ka].concat(X.slice(1));break;case "T":S.qx=S.x+(S.x-(S.qx||S.x));S.qy=S.y+(S.y-
(S.qy||S.y));X=["C"].concat(ab(S.x,S.y,S.qx,S.qy,X[1],X[2]));break;case "Q":S.qx=X[1];S.qy=X[2];X=["C"].concat(ab(S.x,S.y,X[1],X[2],X[3],X[4]));break;case "L":X=["C"].concat([S.x,S.y,X[1],X[2],X[1],X[2]]);break;case "H":X=["C"].concat([S.x,S.y,X[1],S.y,X[1],S.y]);break;case "V":X=["C"].concat([S.x,S.y,S.x,X[1],S.x,X[1]]);break;case "Z":X=["C"].concat([S.x,S.y,S.X,S.Y,S.X,S.Y])}return X},s=function(X,S){if(X[S][l]>7){X[S].shift();for(var aa=X[S];aa[l];)X.splice(S++,0,["C"].concat(aa.splice(0,6)));
X.splice(S,1);K=G(d[l],f&&f[l]||0)}},u=function(X,S,aa,ka,oa){if(X&&S&&X[oa][0]=="M"&&S[oa][0]!="M"){S.splice(oa,0,["M",ka.x,ka.y]);aa.bx=0;aa.by=0;aa.x=X[oa][1];aa.y=X[oa][2];K=G(d[l],f&&f[l]||0)}},w=0,K=G(d[l],f&&f[l]||0);for(;w<K;w++){d[w]=m(d[w],j);s(d,w);f&&(f[w]=m(f[w],e));f&&s(f,w);u(d,f,j,e,w);u(f,d,e,j,w);var M=d[w],O=f&&f[w],V=M[l],ea=f&&O[l];j.x=M[V-2];j.y=M[V-1];j.bx=Z(M[V-4])||j.x;j.by=Z(M[V-3])||j.y;e.bx=f&&(Z(O[ea-4])||e.x);e.by=f&&(Z(O[ea-3])||e.y);e.x=f&&O[ea-2];e.y=f&&O[ea-1]}return f?
[d,f]:d},null,Ga),cb=N(function(a){for(var c=[],d=0,f=a[l];d<f;d++){var j={},e=a[d].match(/^([^:]*):?([\d\.]*)/);j.color=q.getRGB(e[1]);if(j.color.error)return null;j.color=j.color.hex;e[2]&&(j.offset=e[2]+"%");c[ba](j)}d=1;for(f=c[l]-1;d<f;d++)if(!c[d].offset){a=Z(c[d-1].offset||0);e=0;for(j=d+1;j<f;j++)if(c[j].offset){e=c[j].offset;break}if(!e){e=100;j=f}e=Z(e);for(e=(e-a)/(j-d+1);d<j;d++){a+=e;c[d].offset=a+"%"}}return c}),db=function(a,c,d,f){if(q.is(a,"string")||q.is(a,"object")){a=q.is(a,"string")?
k.getElementById(a):a;if(a.tagName)return c==null?{container:a,width:a.style.pixelWidth||a.offsetWidth,height:a.style.pixelHeight||a.offsetHeight}:{container:a,width:c,height:d}}else return{container:1,x:a,y:c,width:d,height:f}},Ra=function(a,c){var d=this,f;for(f in c)if(c[J](f)&&!(f in a))switch(typeof c[f]){case "function":(function(j){a[f]=a===d?j:function(){return j[v](d,arguments)}})(c[f]);break;case "object":a[f]=a[f]||{};Ra.call(this,a[f],c[f]);break;default:a[f]=c[f]}},za=function(a,c){a==
c.top&&(c.top=a.prev);a==c.bottom&&(c.bottom=a.next);a.next&&(a.next.prev=a.prev);a.prev&&(a.prev.next=a.next)},eb=function(a,c){if(c.top!==a){za(a,c);a.next=null;a.prev=c.top;c.top.next=a;c.top=a}},fb=function(a,c){if(c.bottom!==a){za(a,c);a.next=c.bottom;a.prev=null;c.bottom.prev=a;c.bottom=a}},gb=function(a,c,d){za(a,d);c==d.top&&(d.top=a);c.next&&(c.next.prev=a);a.next=c.next;a.prev=c;c.next=a},hb=function(a,c,d){za(a,d);c==d.bottom&&(d.bottom=a);c.prev&&(c.prev.next=a);a.prev=c.prev;c.prev=a;
a.next=c},ib=function(a){return function(){throw Error("Rapha\u00ebl: you are calling to method \u201c"+a+"\u201d of removed object");}};q.pathToRelative=Qa;if(q.svg){n.svgns="http://www.w3.org/2000/svg";n.xlink="http://www.w3.org/1999/xlink";ca=function(a){return+a+(~~a===a)*0.5};var da=function(a,c){if(c)for(var d in c)c[J](d)&&a.setAttribute(d,g(c[d]));else{a=k.createElementNS(n.svgns,a);a.style.webkitTapHighlightColor="rgba(0,0,0,0)";return a}};q[Y]=function(){return"Your browser supports SVG.\nYou are running Rapha\u00ebl "+
this.version};var jb=function(a,c){var d=da("path");c.canvas&&c.canvas.appendChild(d);d=new ja(d,c);d.type="path";xa(d,{fill:"none",stroke:"#000",path:a});return d},Ba=function(a,c,d){var f="linear",j=0.5,e=0.5,m=a.style;c=g(c).replace(Za,function(K,M,O){f="radial";if(M&&O){j=Z(M);e=Z(O);K=(e>0.5)*2-1;r(j-0.5,2)+r(e-0.5,2)>0.25&&(e=E.sqrt(0.25-r(j-0.5,2))*K+0.5)&&e!=0.5&&(e=e.toFixed(5)-1.0E-5*K)}return""});c=c.split(/\s*\-\s*/);if(f=="linear"){var s=c.shift();s=-Z(s);if(isNaN(s))return null;s=[0,
0,E.cos(s*z/180),E.sin(s*z/180)];var u=1/(G(i(s[2]),i(s[3]))||1);s[2]*=u;s[3]*=u;if(s[2]<0){s[0]=-s[2];s[2]=0}if(s[3]<0){s[1]=-s[3];s[3]=0}}c=cb(c);if(!c)return null;u=a.getAttribute("fill");(u=u.match(/^url\(#(.*)\)$/))&&d.defs.removeChild(k.getElementById(u[1]));u=da(f+"Gradient");u.id=$();da(u,f=="radial"?{fx:j,fy:e}:{x1:s[0],y1:s[1],x2:s[2],y2:s[3]});d.defs.appendChild(u);d=0;for(s=c[l];d<s;d++){var w=da("stop");da(w,{offset:c[d].offset?c[d].offset:d?"100%":"0%","stop-color":c[d].color||"#fff"});
u.appendChild(w)}da(a,{fill:"url(#"+u.id+")",opacity:1,"fill-opacity":1});m.fill="";m.opacity=1;return m.fillOpacity=1},Sa=function(a){var c=a.getBBox();da(a.pattern,{patternTransform:q.format("translate({0},{1})",c.x,c.y)})},xa=function(a,c){var d={"":[0],none:[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},f=a.node,j=a.attrs,e=a.rotate(),m=function(ea,X){if(X=d[x.call(X)]){for(var S=ea.attrs["stroke-width"]||
"1",aa={round:S,square:S,butt:0}[ea.attrs["stroke-linecap"]||c["stroke-linecap"]]||0,ka=[],oa=X[l];oa--;)ka[oa]=X[oa]*S+(oa%2?1:-1)*aa;da(f,{"stroke-dasharray":ka[p](",")})}};c[J]("rotation")&&(e=c.rotation);var s=g(e).split(I);if(s.length-1){s[1]=+s[1];s[2]=+s[2]}else s=null;Z(e)&&a.rotate(0,true);for(var u in c)if(c[J](u))if(Ea[J](u)){var w=c[u];j[u]=w;switch(u){case "blur":a.blur(w);break;case "rotation":a.rotate(w,true);break;case "href":case "title":case "target":var K=f.parentNode;if(x.call(K.tagName)!=
"a"){var M=da("a");K.insertBefore(M,f);M.appendChild(f);K=M}u=="target"&&w=="blank"?K.setAttributeNS(a.paper.xlink,"show","new"):K.setAttributeNS(a.paper.xlink,u,w);break;case "cursor":f.style.cursor=w;break;case "clip-rect":K=g(w).split(I);if(K[l]==4){a.clip&&a.clip.parentNode.parentNode.removeChild(a.clip.parentNode);var O=da("clipPath");M=da("rect");O.id=$();da(M,{x:K[0],y:K[1],width:K[2],height:K[3]});O.appendChild(M);a.paper.defs.appendChild(O);da(f,{"clip-path":"url(#"+O.id+")"});a.clip=M}if(!w){(w=
k.getElementById(f.getAttribute("clip-path").replace(/(^url\(#|\)$)/g,"")))&&w.parentNode.removeChild(w);da(f,{"clip-path":""});delete a.clip}break;case "path":a.type=="path"&&da(f,{d:w?j.path=Aa(w):"M0,0"});break;case "width":f.setAttribute(u,w);if(j.fx){u="x";w=j.x}else break;case "x":j.fx&&(w=-j.x-(j.width||0));case "rx":if(u=="rx"&&a.type=="rect")break;case "cx":s&&(u=="x"||u=="cx")&&(s[1]+=w-j[u]);f.setAttribute(u,w);a.pattern&&Sa(a);break;case "height":f.setAttribute(u,w);if(j.fy){u="y";w=j.y}else break;
case "y":j.fy&&(w=-j.y-(j.height||0));case "ry":if(u=="ry"&&a.type=="rect")break;case "cy":s&&(u=="y"||u=="cy")&&(s[2]+=w-j[u]);f.setAttribute(u,w);a.pattern&&Sa(a);break;case "r":a.type=="rect"?da(f,{rx:w,ry:w}):f.setAttribute(u,w);break;case "src":a.type=="image"&&f.setAttributeNS(a.paper.xlink,"href",w);break;case "stroke-width":f.style.strokeWidth=w;f.setAttribute(u,w);j["stroke-dasharray"]&&m(a,j["stroke-dasharray"]);break;case "stroke-dasharray":m(a,w);break;case "translation":w=g(w).split(I);
w[0]=+w[0]||0;w[1]=+w[1]||0;if(s){s[1]+=w[0];s[2]+=w[1]}Ka.call(a,w[0],w[1]);break;case "scale":w=g(w).split(I);a.scale(+w[0]||1,+w[1]||+w[0]||1,isNaN(Z(w[2]))?null:+w[2],isNaN(Z(w[3]))?null:+w[3]);break;case "fill":if(K=g(w).match(fa)){O=da("pattern");var V=da("image");O.id=$();da(O,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1});da(V,{x:0,y:0});V.setAttributeNS(a.paper.xlink,"href",K[1]);O.appendChild(V);w=k.createElement("img");w.style.cssText="position:absolute;left:-9999em;top-9999em";
w.onload=function(){da(O,{width:this.offsetWidth,height:this.offsetHeight});da(V,{width:this.offsetWidth,height:this.offsetHeight});k.body.removeChild(this);a.paper.safari()};k.body.appendChild(w);w.src=K[1];a.paper.defs.appendChild(O);f.style.fill="url(#"+O.id+")";da(f,{fill:"url(#"+O.id+")"});a.pattern=O;a.pattern&&Sa(a);break}K=q.getRGB(w);if(K.error)if(({circle:1,ellipse:1}[J](a.type)||g(w).charAt()!="r")&&Ba(f,w,a.paper)){j.gradient=w;j.fill="none";break}else{delete c.gradient;delete j.gradient;
!q.is(j.opacity,"undefined")&&q.is(c.opacity,"undefined")&&da(f,{opacity:j.opacity});!q.is(j["fill-opacity"],"undefined")&&q.is(c["fill-opacity"],"undefined")&&da(f,{"fill-opacity":j["fill-opacity"]})}K[J]("opacity")&&da(f,{"fill-opacity":K.opacity>1?K.opacity/100:K.opacity});case "stroke":K=q.getRGB(w);f.setAttribute(u,K.hex);u=="stroke"&&K[J]("opacity")&&da(f,{"stroke-opacity":K.opacity>1?K.opacity/100:K.opacity});break;case "gradient":(({circle:1,ellipse:1})[J](a.type)||g(w).charAt()!="r")&&Ba(f,
w,a.paper);break;case "opacity":j.gradient&&!j[J]("stroke-opacity")&&da(f,{"stroke-opacity":w>1?w/100:w});case "fill-opacity":if(j.gradient){if(K=k.getElementById(f.getAttribute("fill").replace(/^url\(#|\)$/g,""))){K=K.getElementsByTagName("stop");K[K[l]-1].setAttribute("stop-opacity",w)}break}default:u=="font-size"&&(w=na(w,10)+"px");K=u.replace(/(\-.)/g,function(ea){return wa.call(ea.substring(1))});f.style[K]=w;f.setAttribute(u,w)}}Eb(a,c);s?a.rotate(s.join(R)):Z(e)&&a.rotate(e,true)},Eb=function(a,
c){if(!(a.type!="text"||!(c[J]("text")||c[J]("font")||c[J]("font-size")||c[J]("x")||c[J]("y")))){var d=a.attrs,f=a.node,j=f.firstChild?na(k.defaultView.getComputedStyle(f.firstChild,"").getPropertyValue("font-size"),10):10;if(c[J]("text")){for(d.text=c.text;f.firstChild;)f.removeChild(f.firstChild);for(var e=g(c.text).split("\n"),m=0,s=e[l];m<s;m++)if(e[m]){var u=da("tspan");m&&da(u,{dy:j*1.2,x:d.x});u.appendChild(k.createTextNode(e[m]));f.appendChild(u)}}else{e=f.getElementsByTagName("tspan");m=
0;for(s=e[l];m<s;m++)m&&da(e[m],{dy:j*1.2,x:d.x})}da(f,{y:d.y});j=a.getBBox();(j=d.y-(j.y+j.height/2))&&q.is(j,"finite")&&da(f,{y:d.y+j})}},ja=function(a,c){this[0]=a;this.id=q._oid++;this.node=a;a.raphael=this;this.paper=c;this.attrs=this.attrs||{};this.transformations=[];this._={tx:0,ty:0,rt:{deg:0,cx:0,cy:0},sx:1,sy:1};!c.bottom&&(c.bottom=this);(this.prev=c.top)&&(c.top.next=this);c.top=this;this.next=null},ia=ja[U];ja[U].rotate=function(a,c,d){if(this.removed)return this;if(a==null){if(this._.rt.cx)return[this._.rt.deg,
this._.rt.cx,this._.rt.cy][p](R);return this._.rt.deg}var f=this.getBBox();a=g(a).split(I);if(a[l]-1){c=Z(a[1]);d=Z(a[2])}a=Z(a[0]);c!=null&&c!==false?this._.rt.deg=a:this._.rt.deg+=a;d==null&&(c=null);this._.rt.cx=c;this._.rt.cy=d;c=c==null?f.x+f.width/2:c;d=d==null?f.y+f.height/2:d;if(this._.rt.deg){this.transformations[0]=q.format("rotate({0} {1} {2})",this._.rt.deg,c,d);this.clip&&da(this.clip,{transform:q.format("rotate({0} {1} {2})",-this._.rt.deg,c,d)})}else{this.transformations[0]="";this.clip&&
da(this.clip,{transform:""})}da(this.node,{transform:this.transformations[p](R)});return this};ja[U].hide=function(){!this.removed&&(this.node.style.display="none");return this};ja[U].show=function(){!this.removed&&(this.node.style.display="");return this};ja[U].remove=function(){if(!this.removed){za(this,this.paper);this.node.parentNode.removeChild(this.node);for(var a in this)delete this[a];this.removed=true}};ja[U].getBBox=function(){if(this.removed)return this;if(this.type=="path")return Ia(this.attrs.path);
if(this.node.style.display=="none"){this.show();var a=true}var c={};try{c=this.node.getBBox()}catch(d){}finally{c=c||{}}if(this.type=="text"){c={x:c.x,y:Infinity,width:0,height:0};for(var f=0,j=this.node.getNumberOfChars();f<j;f++){var e=this.node.getExtentOfChar(f);e.y<c.y&&(c.y=e.y);e.y+e.height-c.y>c.height&&(c.height=e.y+e.height-c.y);e.x+e.width-c.x>c.width&&(c.width=e.x+e.width-c.x)}}a&&this.hide();return c};ja[U].attr=function(a,c){if(this.removed)return this;if(a==null){var d={},f;for(f in this.attrs)this.attrs[J](f)&&
(d[f]=this.attrs[f]);this._.rt.deg&&(d.rotation=this.rotate());(this._.sx!=1||this._.sy!=1)&&(d.scale=this.scale());d.gradient&&d.fill=="none"&&(d.fill=d.gradient)&&delete d.gradient;return d}if(c==null&&q.is(a,"string")){if(a=="translation")return Ka.call(this);if(a=="rotation")return this.rotate();if(a=="scale")return this.scale();if(a=="fill"&&this.attrs.fill=="none"&&this.attrs.gradient)return this.attrs.gradient;return this.attrs[a]}if(c==null&&q.is(a,P)){f={};d=0;for(var j=a.length;d<j;d++)f[a[d]]=
this.attr(a[d]);return f}if(c!=null){d={};d[a]=c}else a!=null&&q.is(a,"object")&&(d=a);for(j in this.paper.customAttributes)if(this.paper.customAttributes[J](j)&&d[J](j)&&q.is(this.paper.customAttributes[j],"function")){f=this.paper.customAttributes[j].apply(this,[].concat(d[j]));this.attrs[j]=d[j];for(var e in f)f[J](e)&&(d[e]=f[e])}xa(this,d);return this};ja[U].toFront=function(){if(this.removed)return this;this.node.parentNode.appendChild(this.node);var a=this.paper;a.top!=this&&eb(this,a);return this};
ja[U].toBack=function(){if(this.removed)return this;if(this.node.parentNode.firstChild!=this.node){this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild);fb(this,this.paper)}return this};ja[U].insertAfter=function(a){if(this.removed)return this;var c=a.node||a[a.length-1].node;c.nextSibling?c.parentNode.insertBefore(this.node,c.nextSibling):c.parentNode.appendChild(this.node);gb(this,a,this.paper);return this};ja[U].insertBefore=function(a){if(this.removed)return this;var c=
a.node||a[0].node;c.parentNode.insertBefore(this.node,c);hb(this,a,this.paper);return this};ja[U].blur=function(a){if(+a!==0){var c=da("filter"),d=da("feGaussianBlur");this.attrs.blur=a;c.id=$();da(d,{stdDeviation:+a||1.5});c.appendChild(d);this.paper.defs.appendChild(c);this._blur=c;da(this.node,{filter:"url(#"+c.id+")"})}else{if(this._blur){this._blur.parentNode.removeChild(this._blur);delete this._blur;delete this.attrs.blur}this.node.removeAttribute("filter")}};var kb=function(a,c,d,f){var j=
da("circle");a.canvas&&a.canvas.appendChild(j);a=new ja(j,a);a.attrs={cx:c,cy:d,r:f,fill:"none",stroke:"#000"};a.type="circle";da(j,a.attrs);return a},lb=function(a,c,d,f,j,e){var m=da("rect");a.canvas&&a.canvas.appendChild(m);a=new ja(m,a);a.attrs={x:c,y:d,width:f,height:j,r:e||0,rx:e||0,ry:e||0,fill:"none",stroke:"#000"};a.type="rect";da(m,a.attrs);return a},mb=function(a,c,d,f,j){var e=da("ellipse");a.canvas&&a.canvas.appendChild(e);a=new ja(e,a);a.attrs={cx:c,cy:d,rx:f,ry:j,fill:"none",stroke:"#000"};
a.type="ellipse";da(e,a.attrs);return a},nb=function(a,c,d,f,j,e){var m=da("image");da(m,{x:d,y:f,width:j,height:e,preserveAspectRatio:"none"});m.setAttributeNS(a.xlink,"href",c);a.canvas&&a.canvas.appendChild(m);a=new ja(m,a);a.attrs={x:d,y:f,width:j,height:e,src:c};a.type="image";return a},ob=function(a,c,d,f){var j=da("text");da(j,{x:c,y:d,"text-anchor":"middle"});a.canvas&&a.canvas.appendChild(j);a=new ja(j,a);a.attrs={x:c,y:d,"text-anchor":"middle",text:f,font:Ea.font,stroke:"none",fill:"#000"};
a.type="text";xa(a,a.attrs);return a},pb=function(a,c){this.width=a||this.width;this.height=c||this.height;this.canvas.setAttribute("width",this.width);this.canvas.setAttribute("height",this.height);return this},Na=function(){var a=db[v](0,arguments),c=a&&a.container,d=a.x,f=a.y,j=a.width;a=a.height;if(!c)throw Error("SVG container not found.");var e=da("svg");d=d||0;f=f||0;j=j||512;a=a||342;da(e,{xmlns:"http://www.w3.org/2000/svg",version:1.1,width:j,height:a});if(c==1){e.style.cssText="position:absolute;left:"+
d+"px;top:"+f+"px";k.body.appendChild(e)}else c.firstChild?c.insertBefore(e,c.firstChild):c.appendChild(e);c=new L;c.width=j;c.height=a;c.canvas=e;Ra.call(c,c,q.fn);c.clear();return c};n.clear=function(){for(var a=this.canvas;a.firstChild;)a.removeChild(a.firstChild);this.bottom=this.top=null;(this.desc=da("desc")).appendChild(k.createTextNode("Created with Rapha\u00ebl"));a.appendChild(this.desc);a.appendChild(this.defs=da("defs"))};n.remove=function(){this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);
for(var a in this)this[a]=ib(a)}}if(q.vml){var qb={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},Fb=/([clmz]),?([^clmz]*)/gi,Gb=/ progid:\S+Blur\([^\)]+\)/g,Hb=/-?[^,\s-]+/g,Ca=1E3+R+1E3,Da={path:1,rect:1},Ib=function(a){var c=/[ahqstv]/ig,d=Aa;g(a).match(c)&&(d=Ha);c=/[clmz]/g;if(d==Aa&&!g(a).match(c))return a=g(a).replace(Fb,function(u,w,K){var M=[],O=x.call(w)=="m",V=qb[w];K.replace(Hb,function(ea){if(O&&M[l]==2){V+=M+qb[w=="m"?"l":"L"];M=[]}M[ba](ca(ea*10))});return V+M});c=d(a);var f;a=[];
for(var j=0,e=c[l];j<e;j++){d=c[j];f=x.call(c[j][0]);f=="z"&&(f="x");for(var m=1,s=d[l];m<s;m++)f+=ca(d[m]*10)+(m!=s-1?",":"");a[ba](f)}return a[p](R)};q[Y]=function(){return"Your browser doesn\u2019t support SVG. Falling down to VML.\nYou are running Rapha\u00ebl "+this.version};jb=function(a,c){var d=qa("group");d.style.cssText="position:absolute;left:0;top:0;width:"+c.width+"px;height:"+c.height+"px";d.coordsize=c.coordsize;d.coordorigin=c.coordorigin;var f=qa("shape"),j=f.style;j.width=c.width+
"px";j.height=c.height+"px";f.coordsize=Ca;f.coordorigin=c.coordorigin;d.appendChild(f);f=new ja(f,d,c);j={fill:"none",stroke:"#000"};a&&(j.path=a);f.type="path";f.path=[];f.Path="";xa(f,j);c.canvas.appendChild(d);return f};xa=function(a,c){a.attrs=a.attrs||{};var d=a.node,f=a.attrs,j=d.style,e;e=(c.x!=f.x||c.y!=f.y||c.width!=f.width||c.height!=f.height||c.r!=f.r)&&a.type=="rect";for(var m in c)c[J](m)&&(f[m]=c[m]);if(e){f.path=rb(f.x,f.y,f.width,f.height,f.r);a.X=f.x;a.Y=f.y;a.W=f.width;a.H=f.height}c.href&&
(d.href=c.href);c.title&&(d.title=c.title);c.target&&(d.target=c.target);c.cursor&&(j.cursor=c.cursor);"blur"in c&&a.blur(c.blur);if(c.path&&a.type=="path"||e)d.path=Ib(f.path);c.rotation!=null&&a.rotate(c.rotation,true);if(c.translation){e=g(c.translation).split(I);Ka.call(a,e[0],e[1]);if(a._.rt.cx!=null){a._.rt.cx+=+e[0];a._.rt.cy+=+e[1];a.setBox(a.attrs,e[0],e[1])}}if(c.scale){e=g(c.scale).split(I);a.scale(+e[0]||1,+e[1]||+e[0]||1,+e[2]||null,+e[3]||null)}if("clip-rect"in c){e=g(c["clip-rect"]).split(I);
if(e[l]==4){e[2]=+e[2]+ +e[0];e[3]=+e[3]+ +e[1];m=d.clipRect||k.createElement("div");var s=m.style,u=d.parentNode;s.clip=q.format("rect({1}px {2}px {3}px {0}px)",e);if(!d.clipRect){s.position="absolute";s.top=0;s.left=0;s.width=a.paper.width+"px";s.height=a.paper.height+"px";u.parentNode.insertBefore(m,u);m.appendChild(u);d.clipRect=m}}c["clip-rect"]||d.clipRect&&(d.clipRect.style.clip="")}a.type=="image"&&c.src&&(d.src=c.src);if(a.type=="image"&&c.opacity){d.filterOpacity=" progid:DXImageTransform.Microsoft.Alpha(opacity="+
c.opacity*100+")";j.filter=(d.filterMatrix||"")+(d.filterOpacity||"")}c.font&&(j.font=c.font);c["font-family"]&&(j.fontFamily='"'+c["font-family"].split(",")[0].replace(/^['"]+|['"]+$/g,"")+'"');c["font-size"]&&(j.fontSize=c["font-size"]);c["font-weight"]&&(j.fontWeight=c["font-weight"]);c["font-style"]&&(j.fontStyle=c["font-style"]);if(c.opacity!=null||c["stroke-width"]!=null||c.fill!=null||c.stroke!=null||c["stroke-width"]!=null||c["stroke-opacity"]!=null||c["fill-opacity"]!=null||c["stroke-dasharray"]!=
null||c["stroke-miterlimit"]!=null||c["stroke-linejoin"]!=null||c["stroke-linecap"]!=null){d=a.shape||d;e=d.getElementsByTagName("fill")&&d.getElementsByTagName("fill")[0];m=false;!e&&(m=e=qa("fill"));if("fill-opacity"in c||"opacity"in c){j=((+f["fill-opacity"]+1||2)-1)*((+f.opacity+1||2)-1)*((+q.getRGB(c.fill).o+1||2)-1);j=Q(G(j,0),1);e.opacity=j}c.fill&&(e.on=true);if(e.on==null||c.fill=="none")e.on=false;if(e.on&&c.fill)if(j=c.fill.match(fa)){e.src=j[1];e.type="tile"}else{e.color=q.getRGB(c.fill).hex;
e.src="";e.type="solid";if(q.getRGB(c.fill).error&&(a.type in{circle:1,ellipse:1}||g(c.fill).charAt()!="r")&&Ba(a,c.fill)){f.fill="none";f.gradient=c.fill}}m&&d.appendChild(e);e=d.getElementsByTagName("stroke")&&d.getElementsByTagName("stroke")[0];m=false;!e&&(m=e=qa("stroke"));if(c.stroke&&c.stroke!="none"||c["stroke-width"]||c["stroke-opacity"]!=null||c["stroke-dasharray"]||c["stroke-miterlimit"]||c["stroke-linejoin"]||c["stroke-linecap"])e.on=true;(c.stroke=="none"||e.on==null||c.stroke==0||c["stroke-width"]==
0)&&(e.on=false);j=q.getRGB(c.stroke);e.on&&c.stroke&&(e.color=j.hex);j=((+f["stroke-opacity"]+1||2)-1)*((+f.opacity+1||2)-1)*((+j.o+1||2)-1);s=(Z(c["stroke-width"])||1)*0.75;j=Q(G(j,0),1);c["stroke-width"]==null&&(s=f["stroke-width"]);c["stroke-width"]&&(e.weight=s);s&&s<1&&(j*=s)&&(e.weight=1);e.opacity=j;c["stroke-linejoin"]&&(e.joinstyle=c["stroke-linejoin"]||"miter");e.miterlimit=c["stroke-miterlimit"]||8;c["stroke-linecap"]&&(e.endcap=c["stroke-linecap"]=="butt"?"flat":c["stroke-linecap"]==
"square"?"square":"round");if(c["stroke-dasharray"]){j={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};e.dashstyle=j[J](c["stroke-dasharray"])?j[c["stroke-dasharray"]]:""}m&&d.appendChild(e)}if(a.type=="text"){j=a.paper.span.style;f.font&&(j.font=f.font);f["font-family"]&&(j.fontFamily=f["font-family"]);f["font-size"]&&(j.fontSize=f["font-size"]);f["font-weight"]&&(j.fontWeight=
f["font-weight"]);f["font-style"]&&(j.fontStyle=f["font-style"]);a.node.string&&(a.paper.span.innerHTML=g(a.node.string).replace(/</g,"&#60;").replace(/&/g,"&#38;").replace(/\n/g,"<br>"));a.W=f.w=a.paper.span.offsetWidth;a.H=f.h=a.paper.span.offsetHeight;a.X=f.x;a.Y=f.y+ca(a.H/2);switch(f["text-anchor"]){case "start":a.node.style["v-text-align"]="left";a.bbx=ca(a.W/2);break;case "end":a.node.style["v-text-align"]="right";a.bbx=-ca(a.W/2);break;default:a.node.style["v-text-align"]="center"}}};Ba=function(a,
c){a.attrs=a.attrs||{};var d,f="linear",j=".5 .5";a.attrs.gradient=c;c=g(c).replace(Za,function(K,M,O){f="radial";if(M&&O){M=Z(M);O=Z(O);r(M-0.5,2)+r(O-0.5,2)>0.25&&(O=E.sqrt(0.25-r(M-0.5,2))*((O>0.5)*2-1)+0.5);j=M+R+O}return""});c=c.split(/\s*\-\s*/);if(f=="linear"){var e=c.shift();e=-Z(e);if(isNaN(e))return null}var m=cb(c);if(!m)return null;a=a.shape||a.node;d=a.getElementsByTagName("fill")[0]||qa("fill");!d.parentNode&&a.appendChild(d);if(m[l]){d.on=true;d.method="none";d.color=m[0].color;d.color2=
m[m[l]-1].color;for(var s=[],u=0,w=m[l];u<w;u++)m[u].offset&&s[ba](m[u].offset+R+m[u].color);d.colors&&(d.colors.value=s[l]?s[p]():"0% "+d.color);if(f=="radial"){d.type="gradientradial";d.focus="100%";d.focussize=j;d.focusposition=j}else{d.type="gradient";d.angle=(270-e)%360}}return 1};ja=function(a,c,d){this[0]=a;this.id=q._oid++;this.node=a;a.raphael=this;this.Y=this.X=0;this.attrs={};this.Group=c;this.paper=d;this._={tx:0,ty:0,rt:{deg:0},sx:1,sy:1};!d.bottom&&(d.bottom=this);(this.prev=d.top)&&
(d.top.next=this);d.top=this;this.next=null};ia=ja[U];ia.rotate=function(a,c,d){if(this.removed)return this;if(a==null){if(this._.rt.cx)return[this._.rt.deg,this._.rt.cx,this._.rt.cy][p](R);return this._.rt.deg}a=g(a).split(I);if(a[l]-1){c=Z(a[1]);d=Z(a[2])}a=Z(a[0]);c!=null?this._.rt.deg=a:this._.rt.deg+=a;d==null&&(c=null);this._.rt.cx=c;this._.rt.cy=d;this.setBox(this.attrs,c,d);this.Group.style.rotation=this._.rt.deg;return this};ia.setBox=function(a,c,d){if(this.removed)return this;var f=this.Group.style,
j=this.shape&&this.shape.style||this.node.style;a=a||{};for(var e in a)a[J](e)&&(this.attrs[e]=a[e]);c=c||this._.rt.cx;d=d||this._.rt.cy;var m=this.attrs,s;switch(this.type){case "circle":a=m.cx-m.r;e=m.cy-m.r;s=m=m.r*2;break;case "ellipse":a=m.cx-m.rx;e=m.cy-m.ry;s=m.rx*2;m=m.ry*2;break;case "image":a=+m.x;e=+m.y;s=m.width||0;m=m.height||0;break;case "text":this.textpath.v=["m",ca(m.x),", ",ca(m.y-2),"l",ca(m.x)+1,", ",ca(m.y-2)][p]("");a=m.x-ca(this.W/2);e=m.y-this.H/2;s=this.W;m=this.H;break;case "rect":case "path":if(this.attrs.path){m=
Ia(this.attrs.path);a=m.x;e=m.y;s=m.width;m=m.height}else{e=a=0;s=this.paper.width;m=this.paper.height}break;default:e=a=0;s=this.paper.width;m=this.paper.height}c=(c==null?a+s/2:c)-this.paper.width/2;d=(d==null?e+m/2:d)-this.paper.height/2;var u;f.left!=(u=c+"px")&&(f.left=u);f.top!=(u=d+"px")&&(f.top=u);this.X=Da[J](this.type)?-c:a;this.Y=Da[J](this.type)?-d:e;this.W=s;this.H=m;if(Da[J](this.type)){j.left!=(u=-c*10+"px")&&(j.left=u);j.top!=(u=-d*10+"px")&&(j.top=u)}else if(this.type=="text"){j.left!=
(u=-c+"px")&&(j.left=u);j.top!=(u=-d+"px")&&(j.top=u)}else{f.width!=(u=this.paper.width+"px")&&(f.width=u);f.height!=(u=this.paper.height+"px")&&(f.height=u);j.left!=(u=a-c+"px")&&(j.left=u);j.top!=(u=e-d+"px")&&(j.top=u);j.width!=(u=s+"px")&&(j.width=u);j.height!=(u=m+"px")&&(j.height=u)}};ia.hide=function(){!this.removed&&(this.Group.style.display="none");return this};ia.show=function(){!this.removed&&(this.Group.style.display="block");return this};ia.getBBox=function(){if(this.removed)return this;
if(Da[J](this.type))return Ia(this.attrs.path);return{x:this.X+(this.bbx||0),y:this.Y,width:this.W,height:this.H}};ia.remove=function(){if(!this.removed){za(this,this.paper);this.node.parentNode.removeChild(this.node);this.Group.parentNode.removeChild(this.Group);this.shape&&this.shape.parentNode.removeChild(this.shape);for(var a in this)delete this[a];this.removed=true}};ia.attr=function(a,c){if(this.removed)return this;if(a==null){var d={},f;for(f in this.attrs)this.attrs[J](f)&&(d[f]=this.attrs[f]);
this._.rt.deg&&(d.rotation=this.rotate());(this._.sx!=1||this._.sy!=1)&&(d.scale=this.scale());d.gradient&&d.fill=="none"&&(d.fill=d.gradient)&&delete d.gradient;return d}if(c==null&&q.is(a,"string")){if(a=="translation")return Ka.call(this);if(a=="rotation")return this.rotate();if(a=="scale")return this.scale();if(a=="fill"&&this.attrs.fill=="none"&&this.attrs.gradient)return this.attrs.gradient;return this.attrs[a]}if(this.attrs&&c==null&&q.is(a,P)){var j={};f=0;for(d=a[l];f<d;f++)j[a[f]]=this.attr(a[f]);
return j}if(c!=null){d={};d[a]=c}c==null&&q.is(a,"object")&&(d=a);if(d){for(j in this.paper.customAttributes)if(this.paper.customAttributes[J](j)&&d[J](j)&&q.is(this.paper.customAttributes[j],"function")){f=this.paper.customAttributes[j].apply(this,[].concat(d[j]));this.attrs[j]=d[j];for(var e in f)f[J](e)&&(d[e]=f[e])}d.text&&this.type=="text"&&(this.node.string=d.text);xa(this,d);d.gradient&&({circle:1,ellipse:1}[J](this.type)||g(d.gradient).charAt()!="r")&&Ba(this,d.gradient);(!Da[J](this.type)||
this._.rt.deg)&&this.setBox(this.attrs)}return this};ia.toFront=function(){!this.removed&&this.Group.parentNode.appendChild(this.Group);this.paper.top!=this&&eb(this,this.paper);return this};ia.toBack=function(){if(this.removed)return this;if(this.Group.parentNode.firstChild!=this.Group){this.Group.parentNode.insertBefore(this.Group,this.Group.parentNode.firstChild);fb(this,this.paper)}return this};ia.insertAfter=function(a){if(this.removed)return this;a.constructor==sa&&(a=a[a.length-1]);a.Group.nextSibling?
a.Group.parentNode.insertBefore(this.Group,a.Group.nextSibling):a.Group.parentNode.appendChild(this.Group);gb(this,a,this.paper);return this};ia.insertBefore=function(a){if(this.removed)return this;a.constructor==sa&&(a=a[0]);a.Group.parentNode.insertBefore(this.Group,a.Group);hb(this,a,this.paper);return this};ia.blur=function(a){var c=this.node.runtimeStyle,d=c.filter;d=d.replace(Gb,"");if(+a!==0){this.attrs.blur=a;c.filter=d+R+" progid:DXImageTransform.Microsoft.Blur(pixelradius="+(+a||1.5)+")";
c.margin=q.format("-{0}px 0 0 -{0}px",ca(+a||1.5))}else{c.filter=d;c.margin=0;delete this.attrs.blur}};kb=function(a,c,d,f){var j=qa("group"),e=qa("oval");j.style.cssText="position:absolute;left:0;top:0;width:"+a.width+"px;height:"+a.height+"px";j.coordsize=Ca;j.coordorigin=a.coordorigin;j.appendChild(e);e=new ja(e,j,a);e.type="circle";xa(e,{stroke:"#000",fill:"none"});e.attrs.cx=c;e.attrs.cy=d;e.attrs.r=f;e.setBox({x:c-f,y:d-f,width:f*2,height:f*2});a.canvas.appendChild(j);return e};var rb=function(a,
c,d,f,j){return j?q.format("M{0},{1}l{2},0a{3},{3},0,0,1,{3},{3}l0,{5}a{3},{3},0,0,1,{4},{3}l{6},0a{3},{3},0,0,1,{4},{4}l0,{7}a{3},{3},0,0,1,{3},{4}z",a+j,c,d-j*2,j,-j,f-j*2,j*2-d,j*2-f):q.format("M{0},{1}l{2},0,0,{3},{4},0z",a,c,d,f,-d)};lb=function(a,c,d,f,j,e){var m=rb(c,d,f,j,e);a=a.path(m);var s=a.attrs;a.X=s.x=c;a.Y=s.y=d;a.W=s.width=f;a.H=s.height=j;s.r=e;s.path=m;a.type="rect";return a};mb=function(a,c,d,f,j){var e=qa("group"),m=qa("oval");e.style.cssText="position:absolute;left:0;top:0;width:"+
a.width+"px;height:"+a.height+"px";e.coordsize=Ca;e.coordorigin=a.coordorigin;e.appendChild(m);m=new ja(m,e,a);m.type="ellipse";xa(m,{stroke:"#000"});m.attrs.cx=c;m.attrs.cy=d;m.attrs.rx=f;m.attrs.ry=j;m.setBox({x:c-f,y:d-j,width:f*2,height:j*2});a.canvas.appendChild(e);return m};nb=function(a,c,d,f,j,e){var m=qa("group"),s=qa("image");m.style.cssText="position:absolute;left:0;top:0;width:"+a.width+"px;height:"+a.height+"px";m.coordsize=Ca;m.coordorigin=a.coordorigin;s.src=c;m.appendChild(s);s=new ja(s,
m,a);s.type="image";s.attrs.src=c;s.attrs.x=d;s.attrs.y=f;s.attrs.w=j;s.attrs.h=e;s.setBox({x:d,y:f,width:j,height:e});a.canvas.appendChild(m);return s};ob=function(a,c,d,f){var j=qa("group"),e=qa("shape"),m=e.style,s=qa("path"),u=qa("textpath");j.style.cssText="position:absolute;left:0;top:0;width:"+a.width+"px;height:"+a.height+"px";j.coordsize=Ca;j.coordorigin=a.coordorigin;s.v=q.format("m{0},{1}l{2},{1}",ca(c*10),ca(d*10),ca(c*10)+1);s.textpathok=true;m.width=a.width;m.height=a.height;u.string=
g(f);u.on=true;e.appendChild(u);e.appendChild(s);j.appendChild(e);m=new ja(u,j,a);m.shape=e;m.textpath=s;m.type="text";m.attrs.text=f;m.attrs.x=c;m.attrs.y=d;m.attrs.w=1;m.attrs.h=1;xa(m,{font:Ea.font,stroke:"none",fill:"#000"});m.setBox();a.canvas.appendChild(j);return m};pb=function(a,c){var d=this.canvas.style;a==+a&&(a+="px");c==+c&&(c+="px");d.width=a;d.height=c;d.clip="rect(0 "+a+" "+c+" 0)";return this};var qa;k.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!k.namespaces.rvml&&
k.namespaces.add("rvml","urn:schemas-microsoft-com:vml");qa=function(a){return k.createElement("<rvml:"+a+' class="rvml">')}}catch(Pb){qa=function(a){return k.createElement("<"+a+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}Na=function(){var a=db[v](0,arguments),c=a.container,d=a.height,f=a.width,j=a.x;a=a.y;if(!c)throw Error("VML container not found.");var e=new L,m=e.canvas=k.createElement("div"),s=m.style;j=j||0;a=a||0;f=f||512;d=d||342;f==+f&&(f+="px");d==+d&&(d+="px");e.width=1E3;
e.height=1E3;e.coordsize=1E4+R+1E4;e.coordorigin="0 0";e.span=k.createElement("span");e.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;";m.appendChild(e.span);s.cssText=q.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",f,d);if(c==1){k.body.appendChild(m);s.left=j+"px";s.top=a+"px";s.position="absolute"}else c.firstChild?c.insertBefore(m,c.firstChild):c.appendChild(m);
Ra.call(e,e,q.fn);return e};n.clear=function(){this.canvas.innerHTML="";this.span=k.createElement("span");this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;";this.canvas.appendChild(this.span);this.bottom=this.top=null};n.remove=function(){this.canvas.parentNode.removeChild(this.canvas);for(var a in this)this[a]=ib(a);return true}}ta=navigator.userAgent.match(/Version\\x2f(.*?)\s/);navigator.vendor=="Apple Computer, Inc."&&(ta&&ta[1]<
4||navigator.platform.slice(0,2)=="iP")?n.safari=function(){var a=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});A.setTimeout(function(){a.remove()})}:n.safari=function(){};var Jb=function(){this.returnValue=false},Kb=function(){return this.originalEvent.preventDefault()},Lb=function(){this.cancelBubble=true},Mb=function(){return this.originalEvent.stopPropagation()},Nb=function(){if(k.addEventListener)return function(a,c,d,f){var j=F&&y[c]?y[c]:c,e=function(m){if(F&&y[J](c))for(var s=
0,u=m.targetTouches&&m.targetTouches.length;s<u;s++)if(m.targetTouches[s].target==a){u=m;m=m.targetTouches[s];m.originalEvent=u;m.preventDefault=Kb;m.stopPropagation=Mb;break}return d.call(f,m)};a.addEventListener(j,e,false);return function(){a.removeEventListener(j,e,false);return true}};if(k.attachEvent)return function(a,c,d,f){var j=function(e){e=e||A.event;e.preventDefault=e.preventDefault||Jb;e.stopPropagation=e.stopPropagation||Lb;return d.call(f,e)};a.attachEvent("on"+c,j);return function(){a.detachEvent("on"+
c,j);return true}}}(),ua=[],Ta=function(a){for(var c=a.clientX,d=a.clientY,f=k.documentElement.scrollTop||k.body.scrollTop,j=k.documentElement.scrollLeft||k.body.scrollLeft,e,m=ua.length;m--;){e=ua[m];if(F)for(var s=a.touches.length,u;s--;){u=a.touches[s];if(u.identifier==e.el._drag.id){c=u.clientX;d=u.clientY;(a.originalEvent?a.originalEvent:a).preventDefault();break}}else a.preventDefault();c+=j;d+=f;e.move&&e.move.call(e.move_scope||e.el,c-e.el._drag.x,d-e.el._drag.y,c,d,a)}},Ua=function(a){q.unmousemove(Ta).unmouseup(Ua);
for(var c=ua.length,d;c--;){d=ua[c];d.el._drag={};d.end&&d.end.call(d.end_scope||d.start_scope||d.move_scope||d.el,a)}ua=[]};for(ta=h[l];ta--;)(function(a){q[a]=ja[U][a]=function(c,d){if(q.is(c,"function")){this.events=this.events||[];this.events.push({name:a,f:c,unbind:Nb(this.shape||this.node||k,a,c,d||this)})}return this};q["un"+a]=ja[U]["un"+a]=function(c){for(var d=this.events,f=d[l];f--;)if(d[f].name==a&&d[f].f==c){d[f].unbind();d.splice(f,1);!d.length&&delete this.events;break}return this}})(h[ta]);
ia.hover=function(a,c,d,f){return this.mouseover(a,d).mouseout(c,f||d)};ia.unhover=function(a,c){return this.unmouseover(a).unmouseout(c)};ia.drag=function(a,c,d,f,j,e){this._drag={};this.mousedown(function(m){(m.originalEvent||m).preventDefault();var s=k.documentElement.scrollTop||k.body.scrollTop,u=k.documentElement.scrollLeft||k.body.scrollLeft;this._drag.x=m.clientX+u;this._drag.y=m.clientY+s;this._drag.id=m.identifier;c&&c.call(j||f||this,m.clientX+u,m.clientY+s,m);!ua.length&&q.mousemove(Ta).mouseup(Ua);
ua.push({el:this,move:a,end:d,move_scope:f,start_scope:j,end_scope:e})});return this};ia.undrag=function(a,c,d){for(c=ua.length;c--;)ua[c].el==this&&ua[c].move==a&&ua[c].end==d&&ua.splice(c++,1);!ua.length&&q.unmousemove(Ta).unmouseup(Ua)};n.circle=function(a,c,d){return kb(this,a||0,c||0,d||0)};n.rect=function(a,c,d,f,j){return lb(this,a||0,c||0,d||0,f||0,j||0)};n.ellipse=function(a,c,d,f){return mb(this,a||0,c||0,d||0,f||0)};n.path=function(a){a&&!q.is(a,"string")&&!q.is(a[0],P)&&(a+="");return jb(q.format[v](q,
arguments),this)};n.image=function(a,c,d,f,j){return nb(this,a||"about:blank",c||0,d||0,f||0,j||0)};n.text=function(a,c,d){return ob(this,a||0,c||0,g(d))};n.set=function(a){arguments[l]>1&&(a=Array[U].splice.call(arguments,0,arguments[l]));return new sa(a)};n.setSize=pb;n.top=n.bottom=null;n.raphael=q;ia.resetScale=function(){if(this.removed)return this;this._.sx=1;this._.sy=1;this.attrs.scale="1 1"};ia.scale=function(a,c,d,f){if(this.removed)return this;if(a==null&&c==null)return{x:this._.sx,y:this._.sy,
toString:C};c=c||a;!+c&&(c=a);var j,e,m=this.attrs;if(a!=0){var s=this.getBBox(),u=s.x+s.width/2,w=s.y+s.height/2;j=i(a/this._.sx);e=i(c/this._.sy);d=+d||d==0?d:u;f=+f||f==0?f:w;var K=this._.sx>0,M=this._.sy>0;s=~~(a/i(a));var O=~~(c/i(c)),V=j*s,ea=e*O,X=this.node.style;u=d+i(u-d)*V*(u>d==K?1:-1);w=f+i(w-f)*ea*(w>f==M?1:-1);var S=a*s>c*O?e:j;switch(this.type){case "rect":case "image":var aa=m.width*j,ka=m.height*e;this.attr({height:ka,r:m.r*S,width:aa,x:u-aa/2,y:w-ka/2});break;case "circle":case "ellipse":this.attr({rx:m.rx*
j,ry:m.ry*e,r:m.r*S,cx:u,cy:w});break;case "text":this.attr({x:u,y:w});break;case "path":S=Qa(m.path);var oa=true;K=K?V:j;M=M?ea:e;ea=0;for(V=S[l];ea<V;ea++){var pa=S[ea],ma=wa.call(pa[0]);if(!(ma=="M"&&oa)){oa=false;if(ma=="A"){pa[S[ea][l]-2]*=K;pa[S[ea][l]-1]*=M;pa[1]*=j;pa[2]*=e;pa[5]=+(s+O?!!+pa[5]:!+pa[5])}else if(ma=="H"){ma=1;for(var ya=pa[l];ma<ya;ma++)pa[ma]*=K}else if(ma=="V"){ma=1;for(ya=pa[l];ma<ya;ma++)pa[ma]*=M}else{ma=1;for(ya=pa[l];ma<ya;ma++)pa[ma]*=ma%2?K:M}}}e=Ia(S);j=u-e.x-e.width/
2;e=w-e.y-e.height/2;S[0][1]+=j;S[0][2]+=e;this.attr({path:S})}if(this.type in{text:1,image:1}&&(s!=1||O!=1))if(this.transformations){this.transformations[2]="scale(".concat(s,",",O,")");this.node.setAttribute("transform",this.transformations[p](R));j=s==-1?-m.x-(aa||0):m.x;e=O==-1?-m.y-(ka||0):m.y;this.attr({x:j,y:e});m.fx=s-1;m.fy=O-1}else{this.node.filterMatrix=" progid:DXImageTransform.Microsoft"+".Matrix(M11=".concat(s,", M12=0, M21=0, M22=",O,", Dx=0, Dy=0, sizingmethod='auto expand', filtertype='bilinear')");
X.filter=(this.node.filterMatrix||"")+(this.node.filterOpacity||"")}else if(this.transformations){this.transformations[2]="";this.node.setAttribute("transform",this.transformations[p](R));m.fx=0;m.fy=0}else{this.node.filterMatrix="";X.filter=(this.node.filterMatrix||"")+(this.node.filterOpacity||"")}m.scale=[a,c,d,f][p](R);this._.sx=a;this._.sy=c}return this};ia.clone=function(){if(this.removed)return null;var a=this.attr();delete a.scale;delete a.translation;return this.paper[this.type]().attr(a)};
var Va={},La=function(a,c,d,f,j,e,m,s,u){var w=0,K=100,M=[a,c,d,f,j,e,m,s].join(),O=Va[M],V,ea;!O&&(Va[M]=O={data:[]});O.timer&&clearTimeout(O.timer);O.timer=setTimeout(function(){delete Va[M]},2E3);if(u!=null)K=~~La(a,c,d,f,j,e,m,s)*10;for(var X=0;X<K+1;X++){if(O.data[u]>X)ea=O.data[X*K];else{ea=q.findDotsAtSegment(a,c,d,f,j,e,m,s,X/K);O.data[X]=ea}X&&(w+=r(r(V.x-ea.x,2)+r(V.y-ea.y,2),0.5));if(u!=null&&w>=u)return ea;V=ea}if(u==null)return w};h=function(a,c){return function(d,f,j){d=Ha(d);for(var e,
m,s,u,w="",K={},M=0,O=0,V=d.length;O<V;O++){s=d[O];if(s[0]=="M"){e=+s[1];m=+s[2]}else{u=La(e,m,s[1],s[2],s[3],s[4],s[5],s[6]);if(M+u>f){if(c&&!K.start){e=La(e,m,s[1],s[2],s[3],s[4],s[5],s[6],f-M);w+=["C",e.start.x,e.start.y,e.m.x,e.m.y,e.x,e.y];if(j)return w;K.start=w;w=["M",e.x,e.y+"C",e.n.x,e.n.y,e.end.x,e.end.y,s[5],s[6]][p]();M+=u;e=+s[5];m=+s[6];continue}if(!a&&!c){e=La(e,m,s[1],s[2],s[3],s[4],s[5],s[6],f-M);return{x:e.x,y:e.y,alpha:e.alpha}}}M+=u;e=+s[5];m=+s[6]}w+=s}K.end=w;e=a?M:c?K:q.findDotsAtSegment(e,
m,s[1],s[2],s[3],s[4],s[5],s[6],1);e.alpha&&(e={x:e.x,y:e.y,alpha:e.alpha});return e}};var sb=h(1),Ma=h(),Wa=h(0,1);ia.getTotalLength=function(){if(this.type=="path"){if(this.node.getTotalLength)return this.node.getTotalLength();return sb(this.attrs.path)}};ia.getPointAtLength=function(a){if(this.type=="path")return Ma(this.attrs.path,a)};ia.getSubpath=function(a,c){if(this.type=="path"){if(i(this.getTotalLength()-c)<"1e-6")return Wa(this.attrs.path,a).end;var d=Wa(this.attrs.path,c,1);return a?Wa(d,
a).end:d}};q.easing_formulas={linear:function(a){return a},"<":function(a){return r(a,3)},">":function(a){return r(a-1,3)+1},"<>":function(a){a*=2;if(a<1)return r(a,3)/2;a-=2;return(r(a,3)+2)/2},backIn:function(a){return a*a*(2.70158*a-1.70158)},backOut:function(a){a-=1;return a*a*(2.70158*a+1.70158)+1},elastic:function(a){if(a==0||a==1)return a;return r(2,-10*a)*E.sin((a-0.075)*2*z/0.3)+1},bounce:function(a){if(a<1/2.75)a*=7.5625*a;else if(a<2/2.75){a-=1.5/2.75;a=7.5625*a*a+0.75}else if(a<2.5/2.75){a-=
2.25/2.75;a=7.5625*a*a+0.9375}else{a-=2.625/2.75;a=7.5625*a*a+0.984375}return a}};var va=[],tb=function(){for(var a=+new Date,c=0;c<va[l];c++){var d=va[c];if(!(d.stop||d.el.removed)){var f=a-d.start,j=d.ms,e=d.easing,m=d.from,s=d.diff,u=d.to,w=d.t,K=d.el;d={};var M;if(f<j){f=e(f/j);for(var O in m)if(m[J](O)){switch(Oa[O]){case "along":M=f*j*s[O];u.back&&(M=u.len-M);e=Ma(u[O],M);K.translate(s.sx-s.x||0,s.sy-s.y||0);s.x=e.x;s.y=e.y;K.translate(e.x-s.sx,e.y-s.sy);u.rot&&K.rotate(s.r+e.alpha,e.x,e.y);
break;case H:M=+m[O]+f*j*s[O];break;case "colour":M="rgb("+[Xa(ca(m[O].r+f*j*s[O].r)),Xa(ca(m[O].g+f*j*s[O].g)),Xa(ca(m[O].b+f*j*s[O].b))][p](",")+")";break;case "path":M=[];e=0;for(var V=m[O][l];e<V;e++){M[e]=[m[O][e][0]];for(var ea=1,X=m[O][e][l];ea<X;ea++)M[e][ea]=+m[O][e][ea]+f*j*s[O][e][ea];M[e]=M[e][p](R)}M=M[p](R);break;case "csv":switch(O){case "translation":M=f*j*s[O][0]-w.x;e=f*j*s[O][1]-w.y;w.x+=M;w.y+=e;M=M+R+e;break;case "rotation":M=+m[O][0]+f*j*s[O][0];m[O][1]&&(M+=","+m[O][1]+","+
m[O][2]);break;case "scale":M=[+m[O][0]+f*j*s[O][0],+m[O][1]+f*j*s[O][1],2 in u[O]?u[O][2]:"",3 in u[O]?u[O][3]:""][p](R);break;case "clip-rect":M=[];for(e=4;e--;)M[e]=+m[O][e]+f*j*s[O][e]}break;default:V=[].concat(m[O]);M=[];for(e=K.paper.customAttributes[O].length;e--;)M[e]=+V[e]+f*j*s[O][e]}d[O]=M}K.attr(d);K._run&&K._run.call(K)}else{if(u.along){e=Ma(u.along,u.len*!u.back);K.translate(s.sx-(s.x||0)+e.x-s.sx,s.sy-(s.y||0)+e.y-s.sy);u.rot&&K.rotate(s.r+e.alpha,e.x,e.y)}(w.x||w.y)&&K.translate(-w.x,
-w.y);u.scale&&(u.scale+="");K.attr(u);va.splice(c--,1)}}}q.svg&&K&&K.paper&&K.paper.safari();va[l]&&setTimeout(tb)},Ob=function(a,c,d,f,j){var e=d-f;c.timeouts.push(setTimeout(function(){q.is(j,"function")&&j.call(c);c.animate(a,e,a.easing)},f))},Xa=function(a){return G(Q(a,255),0)},Ka=function(a,c){if(a==null)return{x:this._.tx,y:this._.ty,toString:C};this._.tx+=+a;this._.ty+=+c;switch(this.type){case "circle":case "ellipse":this.attr({cx:+a+this.attrs.cx,cy:+c+this.attrs.cy});break;case "rect":case "image":case "text":this.attr({x:+a+
this.attrs.x,y:+c+this.attrs.y});break;case "path":var d=Qa(this.attrs.path);d[0][1]+=+a;d[0][2]+=+c;this.attr({path:d})}return this};ia.animateWith=function(a,c,d,f,j){for(var e=0,m=va.length;e<m;e++)va[e].el.id==a.id&&(c.start=va[e].start);return this.animate(c,d,f,j)};ia.animateAlong=T();ia.animateAlongBack=T(1);ia.onAnimation=function(a){this._run=a||0;return this};ia.animate=function(a,c,d,f){var j=this;j.timeouts=j.timeouts||[];if(q.is(d,"function")||!d)f=d||null;if(j.removed){f&&f.call(j);
return j}var e={},m={},s=false,u={},w;for(w in a)if(a[J](w))if(Oa[J](w)||j.paper.customAttributes[J](w)){s=true;e[w]=j.attr(w);e[w]==null&&(e[w]=Ea[w]);m[w]=a[w];switch(Oa[w]){case "along":var K=sb(a[w]),M=Ma(a[w],K*!!a.back),O=j.getBBox();u[w]=K/c;u.tx=O.x;u.ty=O.y;u.sx=M.x;u.sy=M.y;m.rot=a.rot;m.back=a.back;m.len=K;a.rot&&(u.r=Z(j.rotate())||0);break;case H:u[w]=(m[w]-e[w])/c;break;case "colour":e[w]=q.getRGB(e[w]);K=q.getRGB(m[w]);u[w]={r:(K.r-e[w].r)/c,g:(K.g-e[w].g)/c,b:(K.b-e[w].b)/c};break;
case "path":K=Ha(e[w],m[w]);e[w]=K[0];O=K[1];u[w]=[];K=0;for(M=e[w][l];K<M;K++){u[w][K]=[0];for(var V=1,ea=e[w][K][l];V<ea;V++)u[w][K][V]=(O[K][V]-e[w][K][V])/c}break;case "csv":M=g(a[w]).split(I);O=g(e[w]).split(I);switch(w){case "translation":e[w]=[0,0];u[w]=[M[0]/c,M[1]/c];break;case "rotation":e[w]=O[1]==M[1]&&O[2]==M[2]?O:[0,M[1],M[2]];u[w]=[(M[0]-e[w][0])/c,0,0];break;case "scale":a[w]=M;e[w]=g(e[w]).split(I);u[w]=[(M[0]-e[w][0])/c,(M[1]-e[w][1])/c,0,0];break;case "clip-rect":e[w]=g(e[w]).split(I);
u[w]=[];for(K=4;K--;)u[w][K]=(M[K]-e[w][K])/c}m[w]=M;break;default:M=[].concat(a[w]);O=[].concat(e[w]);u[w]=[];for(K=j.paper.customAttributes[w][l];K--;)u[w][K]=((M[K]||0)-(O[K]||0))/c}}if(s){w=q.easing_formulas[d];if(!w)if((w=g(d).match(ra))&&w[l]==5){var X=w;w=function(ka){return B(ka,+X[1],+X[2],+X[3],+X[4],c)}}else w=function(ka){return ka};va.push({start:a.start||+new Date,ms:c,easing:w,from:e,diff:u,to:m,el:j,t:{x:0,y:0}});q.is(f,"function")&&(j._ac=setTimeout(function(){f.call(j)},c));va[l]==
1&&setTimeout(tb)}else{d=[];var S,aa;for(aa in a)if(a[J](aa)&&ub.test(aa)){w={value:a[aa]};aa=="from"&&(aa=0);aa=="to"&&(aa=100);w.key=na(aa,10);d.push(w)}d.sort(Ab);d[0].key&&d.unshift({key:0,value:j.attrs});K=0;for(M=d[l];K<M;K++)Ob(d[K].value,j,c/100*d[K].key,c/100*(d[K-1]&&d[K-1].key||0),d[K-1]&&d[K-1].value.callback);(S=d[d[l]-1].value.callback)&&j.timeouts.push(setTimeout(function(){S.call(j)},c))}return this};ia.stop=function(){for(var a=0;a<va.length;a++)va[a].el.id==this.id&&va.splice(a--,
1);a=0;for(ii=this.timeouts&&this.timeouts.length;a<ii;a++)clearTimeout(this.timeouts[a]);this.timeouts=[];clearTimeout(this._ac);delete this._ac;return this};ia.translate=function(a,c){return this.attr({translation:a+" "+c})};ia[Y]=function(){return"Rapha\u00ebl\u2019s object"};q.ae=va;var sa=function(a){this.items=[];this[l]=0;this.type="set";if(a)for(var c=0,d=a[l];c<d;c++)if(a[c]&&(a[c].constructor==ja||a[c].constructor==sa)){this[this.items[l]]=this.items[this.items[l]]=a[c];this[l]++}};sa[U][ba]=
function(){for(var a,c,d=0,f=arguments[l];d<f;d++)if((a=arguments[d])&&(a.constructor==ja||a.constructor==sa)){c=this.items[l];this[c]=this.items[c]=a;this[l]++}return this};sa[U].pop=function(){delete this[this[l]--];return this.items.pop()};for(var Ya in ia)ia[J](Ya)&&(sa[U][Ya]=function(a){return function(){for(var c=0,d=this.items[l];c<d;c++)this.items[c][a][v](this.items[c],arguments);return this}}(Ya));sa[U].attr=function(a,c){if(a&&q.is(a,P)&&q.is(a[0],"object"))for(var d=0,f=a[l];d<f;d++)this.items[d].attr(a[d]);
else{d=0;for(f=this.items[l];d<f;d++)this.items[d].attr(a,c)}return this};sa[U].animate=function(a,c,d,f){(q.is(d,"function")||!d)&&(f=d||null);var j=this.items[l],e=j,m,s=this,u;f&&(u=function(){!--j&&f.call(s)});d=q.is(d,"string")?d:u;for(m=this.items[--e].animate(a,c,d,u);e--;)this.items[e]&&!this.items[e].removed&&this.items[e].animateWith(m,a,c,d,u);return this};sa[U].insertAfter=function(a){for(var c=this.items[l];c--;)this.items[c].insertAfter(a);return this};sa[U].getBBox=function(){for(var a=
[],c=[],d=[],f=[],j=this.items[l];j--;){var e=this.items[j].getBBox();a[ba](e.x);c[ba](e.y);d[ba](e.x+e.width);f[ba](e.y+e.height)}a=Q[v](0,a);c=Q[v](0,c);return{x:a,y:c,width:G[v](0,d)-a,height:G[v](0,f)-c}};sa[U].clone=function(a){a=new sa;for(var c=0,d=this.items[l];c<d;c++)a[ba](this.items[c].clone());return a};q.registerFont=function(a){if(!a.face)return a;this.fonts=this.fonts||{};var c={w:a.w,face:{},glyphs:{}},d=a.face["font-family"],f;for(f in a.face)a.face[J](f)&&(c.face[f]=a.face[f]);this.fonts[d]?
this.fonts[d][ba](c):this.fonts[d]=[c];if(!a.svg){c.face["units-per-em"]=na(a.face["units-per-em"],10);for(var j in a.glyphs)if(a.glyphs[J](j)){d=a.glyphs[j];c.glyphs[j]={w:d.w,k:{},d:d.d&&"M"+d.d.replace(/[mlcxtrv]/g,function(m){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[m]||"M"})+"z"};if(d.k)for(var e in d.k)d[J](e)&&(c.glyphs[j].k[e]=d.k[e])}}return a};n.getFont=function(a,c,d,f){f=f||"normal";d=d||"normal";c=+c||{normal:400,bold:700,lighter:300,bolder:800}[c]||400;if(q.fonts){var j=q.fonts[a];
if(!j){a=RegExp("(^|\\s)"+a.replace(/[^\w\d\s+!~.:_-]/g,"")+"(\\s|$)","i");for(var e in q.fonts)if(q.fonts[J](e))if(a.test(e)){j=q.fonts[e];break}}var m;if(j){e=0;for(a=j[l];e<a;e++){m=j[e];if(m.face["font-weight"]==c&&(m.face["font-style"]==d||!m.face["font-style"])&&m.face["font-stretch"]==f)break}}return m}};n.print=function(a,c,d,f,j,e,m){e=e||"middle";m=G(Q(m||0,1),-1);var s=this.set(),u=g(d).split(""),w=0;q.is(f,d)&&(f=this.getFont(f));if(f){d=(j||16)/f.face["units-per-em"];var K=f.face.bbox.split(I);
j=+K[0];e=+K[1]+(e=="baseline"?K[3]-K[1]+ +f.face.descent:(K[3]-K[1])/2);K=0;for(var M=u[l];K<M;K++){var O=K&&f.glyphs[u[K-1]]||{},V=f.glyphs[u[K]];w+=K?(O.w||f.w)+(O.k&&O.k[u[K]]||0)+f.w*m:0;V&&V.d&&s[ba](this.path(V.d).attr({fill:"#000",stroke:"none",translation:[w,0]}))}s.scale(d,d,j,e).translate(a-j,c-e)}return s};q.format=function(a,c){var d=q.is(c,P)?[0].concat(c):arguments;a&&q.is(a,"string")&&d[l]-1&&(a=a.replace(o,function(f,j){return d[++j]==null?"":d[j]}));return a||""};q.ninja=function(){D.was?
A.Raphael=D.is:delete Raphael;return q};q.el=ia;q.st=sa[U];D.was?A.Raphael=q:Raphael=q})();(function(){function q(p){return(p+"").replace(F,"")}function $(p,l,x){for(var E=p.length;E<l;E++)p=x?"0"+p:p+"0";return p}function N(p){return y.call(p)==="[object Array]"}function C(p,l){if(p.indexOf)return p.indexOf(l);for(var x=0,E=p.length;x<E;x++)if(p[x]===l)return x;return-1}function T(p,l,x){var E=l["-"];l=l["+"];var G;switch(x){case "n -":E=" "+E;l=" "+l;case "n-":if(p.substr(p.length-E.length)===E)G=["-",p.substr(0,p.length-E.length)];else if(p.substr(p.length-l.length)===l)G=["+",p.substr(0,
p.length-l.length)];break;case "- n":E+=" ";l+=" ";case "-n":if(p.indexOf(E)===0)G=["-",p.substr(E.length)];else if(p.indexOf(l)===0)G=["+",p.substr(l.length)];break;case "(n)":if(p.indexOf("(")===0&&p.substr(p.length-1)===")")G=["-",p.substr(1,p.length-2)]}return G||["",p]}function B(p,l){if(!l)return 0;for(var x,E=p.getTime(),G=0,Q=l.length;G<Q;G++){x=l[G].start;if(x===null||E>=x)return G}return 0}function I(p){return p.split("\u00a0").join(" ").toUpperCase()}function W(p){for(var l=[],x=0,E=p.length;x<
E;x++)l[x]=I(p[x]);return l}function o(p,l,x,E){p=p.getFullYear();if(!E&&l.eras)p-=l.eras[x].offset;return p}function U(p,l){for(var x=0,E=false,G=0,Q=p.length;G<Q;G++){var i=p.charAt(G);switch(i){case "'":if(E)l.push("'");else x++;E=false;break;case "\\":E&&l.push("\\");E=!E;break;default:l.push(i);E=false}}return x}function J(p,l){l=l||"F";var x;x=p.patterns;var E=l.length;if(E===1){x=x[l];if(!x)throw"Invalid date format string '"+l+"'.";l=x}else if(E===2&&l.charAt(0)==="%")l=l.charAt(1);return l}
function k(){return/\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|zzz|zz|z|gg|g/g}function A(p,l,x){p=q(p);x=x.calendar;a:{var E=x._parseRegExp;if(E){var G=E[l];if(G){l=G;break a}}else x._parseRegExp=E={};G=J(x,l).replace(/([\^\$\.\*\+\?\|\[\]\(\)\{\}])/g,"\\\\$1");for(var Q=["^"],i=[],r=0,z=0,H=k(),P;(P=H.exec(G))!==null;){var Y=G.slice(r,P.index);r=H.lastIndex;z+=U(Y,Q);if(z%2)Q.push(P[0]);else{Y=P[0];var ga=Y.length;switch(Y){case "dddd":case "ddd":case "MMMM":case "MMM":case "gg":case "g":Y=
"(\\D+)";break;case "tt":case "t":Y="(\\D*)";break;case "yyyy":case "fff":case "ff":case "f":Y="(\\d{"+ga+"})";break;case "dd":case "d":case "MM":case "M":case "yy":case "y":case "HH":case "H":case "hh":case "h":case "mm":case "m":case "ss":case "s":Y="(\\d\\d?)";break;case "zzz":Y="([+-]?\\d\\d?:\\d{2})";break;case "zz":case "z":Y="([+-]?\\d\\d?)";break;case "/":Y="(\\"+x["/"]+")";break;default:throw"Invalid date format pattern '"+Y+"'.";}Y&&Q.push(Y);i.push(P[0])}}U(G.slice(r),Q);Q.push("$");G=
{regExp:Q.join("").replace(/\s+/g,"\\s+"),groups:i};l=E[l]=G}z=RegExp(l.regExp).exec(p);if(z===null)return null;H=l.groups;var ba=p=null,fa=null,la=l=null;i=Q=G=E=0;P=null;r=false;Y=0;for(ga=H.length;Y<ga;Y++){var ha=z[Y+1];if(ha){var ra=H[Y],ca=ra.length,Z=parseInt(ha,10);switch(ra){case "dd":case "d":l=Z;if(l<1||l>31)return null;break;case "MMM":case "MMMM":fa=x;ca=ca===3;ra=fa.months;var na=fa.monthsGenitive||fa.months,wa=fa._upperMonths;Z=fa._upperMonthsGen;if(!wa){fa._upperMonths=wa=[W(ra.names),
W(ra.namesAbbr)];fa._upperMonthsGen=Z=[W(na.names),W(na.namesAbbr)]}ha=I(ha);fa=C(ca?wa[1]:wa[0],ha);if(fa<0)fa=C(ca?Z[1]:Z[0],ha);if(fa<0||fa>11)return null;break;case "M":case "MM":fa=Z-1;if(fa<0||fa>11)return null;break;case "y":case "yy":case "yyyy":if(ca<4){ba=x;ha=Z;Z=new Date;ra=B(Z);if(ha<100){ca=ba.twoDigitYearMax;ca=typeof ca==="string"?(new Date).getFullYear()%100+parseInt(ca,10):ca;ba=o(Z,ba,ra);ha+=ba-ba%100;if(ha>ca)ha-=100}ba=ha}else ba=Z;if(ba<0||ba>9999)return null;break;case "h":case "hh":E=
Z;if(E===12)E=0;if(E<0||E>11)return null;break;case "H":case "HH":E=Z;if(E<0||E>23)return null;break;case "m":case "mm":G=Z;if(G<0||G>59)return null;break;case "s":case "ss":Q=Z;if(Q<0||Q>59)return null;break;case "tt":case "t":r=x.PM&&(ha===x.PM[0]||ha===x.PM[1]||ha===x.PM[2]);if(!r&&(!x.AM||ha!==x.AM[0]&&ha!==x.AM[1]&&ha!==x.AM[2]))return null;break;case "f":case "ff":case "fff":i=Z*Math.pow(10,3-ca);if(i<0||i>999)return null;break;case "ddd":case "dddd":la=ha;ha=ca===3;Z=void 0;Z=x.days;ca=x._upperDays;
if(!ca)x._upperDays=ca=[W(Z.names),W(Z.namesAbbr),W(Z.namesShort)];la=I(la);if(ha){Z=C(ca[1],la);if(Z===-1)Z=C(ca[2],la)}else Z=C(ca[0],la);la=Z;if(la<0||la>6)return null;break;case "zzz":ca=ha.split(/:/);if(ca.length!==2)return null;P=parseInt(ca[0],10);if(P<-12||P>13)return null;ca=parseInt(ca[1],10);if(ca<0||ca>59)return null;P=P*60+(ha.indexOf("-")===0?-ca:ca);break;case "z":case "zz":P=Z;if(P<-12||P>13)return null;P*=60;break;case "g":case "gg":if(!ha||!x.eras)return null;ha=q(ha.toLowerCase());
ca=0;for(Z=x.eras.length;ca<Z;ca++)if(ha===x.eras[ca].name.toLowerCase()){p=ca;break}if(p===null)return null}}}z=new Date;H=(Y=x.convert)?Y.fromGregorian(z)[0]:z.getFullYear();if(ba===null)ba=H;else if(x.eras)ba+=x.eras[p||0].offset;if(fa===null)fa=0;if(l===null)l=1;if(Y){z=Y.toGregorian(ba,fa,l);if(z===null)return null}else{z.setFullYear(ba,fa,l);if(z.getDate()!==l)return null;if(la!==null&&z.getDay()!==la)return null}if(r&&E<12)E+=12;z.setHours(E,G,Q,i);if(P!==null){x=z.getMinutes()-(P+z.getTimezoneOffset());
z.setHours(z.getHours()+parseInt(x/60,10),x%60)}return z}function D(p,l,x){function E(ca,Z){var na;na=ca+"";if(Z>1&&na.length<Z){na=Y[Z-2]+na;return na.substr(na.length-Z,Z)}return na}function G(){if(ga||ba)return ga;ga=fa.test(l);ba=true;return ga}function Q(ca,Z){if(ra)return ra[Z];switch(Z){case 0:return ca.getFullYear();case 1:return ca.getMonth();case 2:return ca.getDate()}}var i=x.calendar,r=i.convert;if(!l||!l.length||l==="i"){if(x&&x.name.length)if(r)x=D(p,i.patterns.F,x);else{x=new Date(p.getTime());
var z=B(p,i.eras);x.setFullYear(o(p,i,z));x=x.toLocaleString()}else x=p.toString();return x}z=i.eras;var H=l==="s";l=J(i,l);x=[];var P,Y=["0","00","000"],ga,ba,fa=/([^d]|^)(d|dd)([^d]|$)/g,la=0,ha=k(),ra;if(!H&&r)ra=r.fromGregorian(p);for(;;){P=ha.lastIndex;r=ha.exec(l);P=l.slice(P,r?r.index:l.length);la+=U(P,x);if(!r)break;if(la%2)x.push(r[0]);else{P=r[0];r=P.length;switch(P){case "ddd":case "dddd":x.push((r===3?i.days.namesAbbr:i.days.names)[p.getDay()]);break;case "d":case "dd":ga=true;x.push(E(Q(p,
2),r));break;case "MMM":case "MMMM":P=Q(p,1);x.push(i.monthsGenitive&&G()?i.monthsGenitive[r===3?"namesAbbr":"names"][P]:i.months[r===3?"namesAbbr":"names"][P]);break;case "M":case "MM":x.push(E(Q(p,1)+1,r));break;case "y":case "yy":case "yyyy":P=ra?ra[0]:o(p,i,B(p,z),H);if(r<4)P%=100;x.push(E(P,r));break;case "h":case "hh":P=p.getHours()%12;if(P===0)P=12;x.push(E(P,r));break;case "H":case "HH":x.push(E(p.getHours(),r));break;case "m":case "mm":x.push(E(p.getMinutes(),r));break;case "s":case "ss":x.push(E(p.getSeconds(),
r));break;case "t":case "tt":P=p.getHours()<12?i.AM?i.AM[0]:" ":i.PM?i.PM[0]:" ";x.push(r===1?P.charAt(0):P);break;case "f":case "ff":case "fff":x.push(E(p.getMilliseconds(),3).substr(0,r));break;case "z":case "zz":P=p.getTimezoneOffset()/60;x.push((P<=0?"+":"-")+E(Math.floor(Math.abs(P)),r));break;case "zzz":P=p.getTimezoneOffset()/60;x.push((P<=0?"+":"-")+E(Math.floor(Math.abs(P)),2)+":"+E(Math.abs(p.getTimezoneOffset()%60),2));break;case "g":case "gg":i.eras&&x.push(i.eras[B(p,z)].name);break;
case "/":x.push(i["/"]);break;default:throw"Invalid date format pattern '"+P+"'.";}}}return x.join("")}var L={},n={en:{}};n["default"]=n.en;L.extend=function(p){for(var l=arguments[1]||{},x=2,E=arguments.length;x<E;x++){var G=arguments[x];if(G)for(var Q in G){var i=G[Q];if(typeof i!=="undefined")if(p&&(y.call(i)==="[object Object]"||N(i))){var r=l[Q];r=r&&(y.call(r)==="[object Object]"||N(r))?r:N(i)?[]:{};l[Q]=this.extend(true,r,i)}else l[Q]=i}}return l};L.findClosestCulture=function(p){var l;if(!p)return this.culture||
this.cultures["default"];if(y.call(p)==="[object String]")p=p.split(",");if(N(p)){var x,E=this.cultures,G=p,Q,i=G.length,r=[];for(Q=0;Q<i;Q++){p=q(G[Q]);p=p.split(";");x=q(p[0]);if(p.length===1)p=1;else{p=q(p[1]);if(p.indexOf("q=")===0){p=p.substr(2);p=parseFloat(p,10);p=isNaN(p)?0:p}else p=1}r.push({lang:x,pri:p})}r.sort(function(H,P){return H.pri<P.pri?1:-1});for(Q=0;Q<i;Q++){x=r[Q].lang;if(l=E[x])return l}for(Q=0;Q<i;Q++){x=r[Q].lang;do{G=x.lastIndexOf("-");if(G===-1)break;x=x.substr(0,G);if(l=
E[x])return l}while(1)}for(Q=0;Q<i;Q++){x=r[Q].lang;for(var z in E){G=E[z];if(G.language==x)return G}}}else if(typeof p==="object")return p;return l||null};L.preferCulture=function(p){this.culture=this.findClosestCulture(p)||this.cultures["default"]};L.localize=function(p,l,x){if(typeof l!=="string")l=this.culture.name||this.culture||"default";l=this.cultures[l]||{name:l};var E=n[l.name];if(arguments.length===3){E||(E=n[l.name]={});E[p]=x}else{if(E)x=E[p];if(typeof x==="undefined"){if(E=n[l.language])x=
E[p];if(typeof x==="undefined")x=n["default"][p]}}return typeof x==="undefined"?null:x};L.format=function(p,l,x){x=this.findClosestCulture(x);if(typeof p==="number"){var E=p;if(!l||l==="i")p=x.name.length?E.toLocaleString():E.toString();else{l=l||"D";x=x.numberFormat;p=Math.abs(E);var G=-1;if(l.length>1)G=parseInt(l.slice(1),10);var Q=l.charAt(0).toUpperCase(),i;switch(Q){case "D":l="n";if(G!==-1)p=$(""+p,G,true);if(E<0)p=-p;break;case "N":i=x;case "C":i=i||x.currency;case "P":i=i||x.percent;l=E<
0?i.pattern[0]:i.pattern[1]||"n";if(G===-1)G=i.decimals;b:{var r=p*(Q==="P"?100:1);Q=i;i=Q.groupSizes;p=i[0];E=1;var z=Math.pow(10,G),H=Math.round(r*z)/z;isFinite(H)||(H=r);z="";z=(H+"").split(/e/i);H=z.length>1?parseInt(z[1],10):0;r=z[0];z=r.split(".");r=z[0];z=z.length>1?z[1]:"";if(H>0){z=$(z,H,false);r+=z.slice(0,H);z=z.substr(H)}else if(H<0){H=-H;r=$(r,H+1);z=r.slice(-H,r.length)+z;r=r.slice(0,-H)}z=G>0?Q["."]+(z.length>G?z.slice(0,G):$(z,G)):"";G=r.length-1;Q=Q[","];for(H="";G>=0;){if(p===0||
p>G){p=r.slice(0,G+1)+(H.length?Q+H+z:z);break b}H=r.slice(G-p+1,G+1)+(H.length?Q+H:"");G-=p;if(E<i.length){p=i[E];E++}}p=r.slice(0,G+1)+Q+H+z}break;default:throw"Bad number format specifier: "+Q;}i=/n|\$|-|%/g;for(E="";;){G=i.lastIndex;Q=i.exec(l);E+=l.slice(G,Q?Q.index:l.length);if(!Q)break;switch(Q[0]){case "n":E+=p;break;case "$":E+=x.currency.symbol;break;case "-":if(/[1-9]/.test(p))E+=x["-"];break;case "%":E+=x.percent.symbol}}p=E}}else if(p instanceof Date)p=D(p,l,x);return p};L.parseInt=function(p,
l,x){return Math.floor(this.parseFloat(p,l,x))};L.parseFloat=function(p,l,x){if(typeof l==="string"){x=l;l=10}x=this.findClosestCulture(x);var E=NaN,G=x.numberFormat;if(p.indexOf(x.numberFormat.currency.symbol)>-1){p=p.replace(x.numberFormat.currency.symbol,"");p=p.replace(x.numberFormat.currency["."],x.numberFormat["."])}p=q(p);if(R.test(p))E=parseFloat(p,l);else if(!l&&g.test(p))E=parseInt(p,16);else{x=T(p,G,G.pattern[0]);l=x[0];x=x[1];if(l===""&&G.pattern[0]!=="-n"){x=T(p,G,"-n");l=x[0];x=x[1]}l=
l||"+";var Q;p=x.indexOf("e");if(p<0)p=x.indexOf("E");if(p<0){Q=x;p=null}else{Q=x.substr(0,p);p=x.substr(p+1)}var i=G["."],r=Q.indexOf(i);if(r<0){x=Q;Q=null}else{x=Q.substr(0,r);Q=Q.substr(r+i.length)}i=G[","];x=x.split(i).join("");r=i.replace(/\u00A0/g," ");if(i!==r)x=x.split(r).join("");l+=x;if(Q!==null)l+="."+Q;if(p!==null){G=T(p,G,"-n");l+="e"+(G[0]||"+")+G[1]}if(h.test(l))E=parseFloat(l)}return E};L.parseDate=function(p,l,x){x=this.findClosestCulture(x);var E,G;if(l){if(typeof l==="string")l=
[l];if(l.length){G=0;for(var Q=l.length;G<Q;G++){var i=l[G];if(i)if(E=A(p,i,x))break}}}else{l=x.calendar.patterns;for(G in l)if(E=A(p,l[G],x))break}return E||null};var v=L.cultures=L.cultures||{};v=v["default"]=v.en=L.extend(true,{name:"en",englishName:"English",nativeName:"English",isRTL:false,language:"en",numberFormat:{pattern:["-n"],decimals:2,",":",",".":".",groupSizes:[3],"+":"+","-":"-",percent:{pattern:["-n %","n %"],decimals:2,groupSizes:[3],",":",",".":".",symbol:"%"},currency:{pattern:["($n)",
"$n"],decimals:2,groupSizes:[3],",":",",".":".",symbol:"$"}},calendars:{standard:{name:"Gregorian_USEnglish","/":"/",":":":",firstDay:0,days:{names:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],namesAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],namesShort:["Su","Mo","Tu","We","Th","Fr","Sa"]},months:{names:["January","February","March","April","May","June","July","August","September","October","November","December",""],namesAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul",
"Aug","Sep","Oct","Nov","Dec",""]},AM:["AM","am","AM"],PM:["PM","pm","PM"],eras:[{name:"A.D.",start:null,offset:0}],twoDigitYearMax:2029,patterns:{d:"M/d/yyyy",D:"dddd, MMMM dd, yyyy",t:"h:mm tt",T:"h:mm:ss tt",f:"dddd, MMMM dd, yyyy h:mm tt",F:"dddd, MMMM dd, yyyy h:mm:ss tt",M:"MMMM dd",Y:"yyyy MMMM",S:"yyyy'-'MM'-'dd'T'HH':'mm':'ss"}}}},v.en);v.calendar=v.calendar||v.calendars.standard;var F=/^\s+|\s+$/g,R=/^[+-]?infinity$/i,g=/^0x[a-f0-9]+$/i,h=/^[+-]?\d*\.?\d*(e[+-]?\d+)?$/,y=Object.prototype.toString;
jQuery.global=L})();timeglider=window.timeglider||{version:"0.1.0"};timeglider.TG_Date={};
(function(q){function $(k){return parseInt(k,10)}function N(k){var A=parseInt(k,10);return A>9||A<0?String(k):"0"+A}q=timeglider;var C=jQuery,T={},B={},I={},W={},o={},U=/^(\-?\d+)?(\-\d{1,2})?(\-\d{1,2})?(?:T| )?(\d{1,2})?(?::)?(\d{1,2})?(?::)?(\d{1,2})?(\+|\-)?(\d{1,2})?(?::)?(\d{1,2})?/;q.TG_Date=function(k,A,D){var L,n,v;D=D||0;if(typeof k=="number"){L=n=J.getDateFromSec(k);v=k+D}else if(typeof k!=="object"){if(k=="today")k=J.getToday();L=n=k}if(U.test(L)){k=J.parse8601(L);if(k.tz_ho)k=J.toFromUTC(k,
{hours:k.tz_ho,minutes:k.tz_mi},"to");C.extend(this,k);this.rd=J.getRataDie(this);this.mo_num=this.ye>0?(this.ye-1)*12+this.mo:-1*((Math.abs(this.ye)-1)*12+(12-(this.mo-1)));if(!v){v=Math.abs(this.rd)*86400;k=this.ho*3600;L=(this.mi-1)*60;D=1;if(this.rd<0)D=-1;v=D*(v+k+L)}this.sec=v;this.date_display=A?A.toLowerCase().substr(0,2):"da";this.dateStr=n}else return{error:"invalid date"};return this};var J=q.TG_Date;J.getTimeUnitSerial=function(k,A){var D=0;switch(A){case "da":D=k.rd;break;case "mo":D=
k.mo_num;break;case "ye":D=k.ye;break;case "de":D=Math.floor(k.ye/10);break;case "ce":D=Math.floor(k.ye/100);break;case "thou":D=Math.floor(k.ye/1E3);break;case "tenthou":D=Math.floor(k.ye/1E4);break;case "hundredthou":D=Math.floor(k.ye/1E5);break;case "mill":D=Math.floor(k.ye/1E6);break;case "tenmill":D=Math.floor(k.ye/1E7);break;case "hundredmill":D=Math.floor(k.ye/1E8);break;case "bill":D=Math.floor(k.ye/1E9)}return D};J.getMonthDays=function(k,A){return J.isLeapYear(A)==true&&k==2?29:J.monthsDayNums[k]};
J.twentyFourToTwelve=function(k){var A={};A.ye=k.ye;A.mo=k.mo;A.da=k.da;A.ho=k.ho;A.mi=k.mi;A.ampm="am";if(k.ho)if(k.ho>=12){A.ampm="pm";A.ho=k.ho>12?k.ho-12:12}else if(k.ho==0){A.ho=12;A.ampm="am"}else A.ho=k.ho;else{A.ho=12;A.mi=0;A.ampm="am"}return A};J.getMonthAdj=function(k,A){var D=J.getDateFromMonthNum(k);switch(D.mo){case 1:case 3:case 5:case 7:case 8:case 10:case 12:D=Math.floor(A+A/28*3);return{width:D,days:31};case 2:if(J.isLeapYear(D.ye)==true){D=Math.floor(A+A/28);return{width:D,days:29}}else return{width:A,
days:28};default:D=Math.floor(A+A/28*2);return{width:D,days:30}}};J.getDateFromMonthNum=function(k){var A=0;if(k>0){A=k%12;if(A==0)A=12;k=Math.ceil(k/12)}else{A=Math.abs(k)%12;A=12-A+1;if(A==13)A=1;k=-1*Math.ceil(Math.abs(k)/12)}return{ye:k,mo:A}};J.getMonthWidth=function(k,A,D){A=t/28;var L;switch(k){case 1:case 3:case 5:case 7:case 8:case 10:case 12:L=3;break;case 4:case 6:case 9:case 11:L=2;break;case 2:L=J.isLeapYear(yr)==true?1:0}return{width:Math.floor(D+A*L),numDays:28+L}};J.getToday=function(){var k=
new Date;return k.getFullYear()+"-"+(k.getMonth()+1)+"-"+k.getDate()+" "+k.getHours()+":"+k.getMinutes()+":00"};J.getMonthFromRemDays=function(k,A){var D=0;var L=D=0;D=J.isLeapYear(A)?1:0;if(k<=31){L=1;D=k}else if(k>31&&k<=59+D){L=2;D=k-(31+D)}else if(k>59+D&&k<=90+D){L=3;D=k-(59+D)}else if(k>90+D&&k<=120+D){L=4;D=k-(90+D)}else if(k>120+D&&k<=151+D){L=5;D=k-(120+D)}else if(k>151+D&&k<=181+D){L=6;D=k-(151+D)}else if(k>181+D&&k<=212+D){L=7;D=k-(181+D)}else if(k>212+D&&k<=243+D){L=8;D=k-(212+D)}else if(k>
243+D&&k<=273+D){L=9;D=k-(243+D)}else if(k>273+D&&k<=304+D){L=10;D=k-(273+D)}else if(k>304+D&&k<=334+D){L=11;D=k-(304+D)}else{L=12;D=k-(334+D)}return{mo:L,da:D}};J.getDateFromRD=function(k){if(W[k])return W[k];for(var A=Math.floor(k),D=Math.floor(A/146097)*400,L=A-Math.floor(A/146097)*146097,n=1,v=D+1,F=v+400;v<=F;v++)if(L>365){L-=365;if(J.isLeapYear(v))L-=1;n++}else v=F;D+=n;if(L==0)L=1;L=J.getMonthFromRemDays(L,D);n=(k-A)*1440;A=Math.floor(n%60);n=Math.floor(n/60);if(J.isLeapYear(D)&&L.mo==2)L.da+=
1;A=D+"-"+L.mo+"-"+L.da+" "+n+":"+A+":00";return W[k]=A};J.getDateFromSec=function(k){if(o[k])return o[k];var A=J.getDateFromRD(k/86400);return o[k]=A};J.isLeapYear=function(k){return k%400==0?true:k%100==0?false:k%4==0?true:false};J.getRataDie=function(k){function A(g,h){if(B[g+"-"+h])return B[g+"-"+h];for(var y=0,p=g;p<h;p++)y+=J.isLeapYear(p)?366:365;return B[g+"-"+h]=y}function D(g,h){var y;switch(g){case 1:y=0;break;case 2:y=31;break;case 3:y=59;break;case 4:y=90;break;case 5:y=120;break;case 6:y=
151;break;case 7:y=181;break;case 8:y=212;break;case 9:y=243;break;case 10:y=273;break;case 11:y=304;break;case 12:y=334}if(g>2)if(J.isLeapYear(h))y+=1;return y}var L=k.ye,n=k.mo;k=k.da;var v=0;if(T[L+"-"+n+"-"+k])return T[L+"-"+n+"-"+k];if(L>=0){if(L==0)L=1;v=Math.floor(L/400)*146097;var F=parseInt(A(L-L%400,L)),R=parseInt(D(n,L));v=v+F+R+k-366}else if(L<0)v=J.getBCRataDie({ye:L,mo:n,da:k});return T[L+"-"+n+"-"+k]=v};J.monthNamesLet=["","J","F","M","A","M","J","J","A","S","O","N","D"];J.monthsDayNums=
[0,31,28,31,30,31,30,31,31,30,31,30,31,29];J.units=["da","mo","ye","de","ce","thou","tenthou","hundredthou","mill","tenmill","hundredmill","bill"];J.getBCRataDie=function(k){var A=k.ye,D=k.mo;k=k.da;if(I[A+"-"+D+"-"+k])return I[A+"-"+D+"-"+k];if(D==0)D=1;if(k==0)k=1;var L=-1*((Math.abs(A)-1)*366+[0,335,306,275,245,214,184,153,122,92,61,31,0][D]+(J.monthsDayNums[D]-k+1));return I[A+"-"+D+"-"+k]=L};J.setCulture=function(k){jQuery.global.culture=jQuery.global.cultures[k];J.monthNames=C.merge([""],jQuery.global.culture.calendar.months.names);
J.monthNamesAbbr=C.merge([""],jQuery.global.culture.calendar.months.namesAbbr);J.dayNames=jQuery.global.culture.calendar.days.names;J.dayNamesAbbr=jQuery.global.culture.calendar.days.namesAbbr;J.dayNamesShort=jQuery.global.culture.calendar.days.namesShort;J.patterns=jQuery.global.culture.calendar.patterns};J.prototype={format:function(k,A,D){D=D||{hours:0,minutes:0};if(A==true)switch(this.date_display.substr(0,2)){case "no":return"";case "ye":k="yyyy";break;case "mo":k="MMM yyyy";break;case "da":k=
"MMM d, yyyy";break;case "ho":k="MMM d, yyyy h:mm tt";break;default:k="f"}if(this.ye>-27E4){A=J.toFromUTC(_.clone(this),D,"from");A=new Date(A.ye,A.mo-1,A.da,A.ho,A.mi,A.se,0);return C.global.format(A,k)}else return this.ye}};J.getTimeOffset=function(k){k=k.replace(/[^-\d:]/gi,"");var A=k.split(":"),D=parseInt(A[0],10);A=parseInt(A[1],10);var L=D+(D<0?-1:1)*(A/60);return{decimal:L,hours:D,minutes:A,seconds:L*3600,string:k}};J.tzOffsetStr=function(k,A){if(k){if(k.length==19)k+=A;else if(k.length==
16)k+=":00"+A;return k}};J.parse8601=function(k){var A,D,L,n,v;v=function(R){return R?parseInt(R.replace("-",""),10):0};var F=k.match(U);k=parseInt(F[1]);if(!k)return{error:"invalid date; no year provided"};A=v(F[2])||1;D=v(F[3])||1;L=v(F[4])||1;n=v(F[5])||0;v=v(F[6])||0;tz_pm=F[7]||"+";tz_ho=parseInt(F[8],10)||0;if(tz_pm=="-")tz_ho*=-1;tz_mi=parseInt(F[9],10)||0;if(tz_pm=="-")tz_mi*=-1;return{ye:k,mo:A,da:D,ho:L,mi:n,se:v,tz_ho:tz_ho,tz_mi:tz_mi}};J.getLastDayOfMonth=function(k,A){var D=[0,31,28,
31,30,31,30,31,31,30,31,30,31],L=0;return L=A==2&&J.isLeapYear(k)==true?29:D[A]};J.getDateTimeStrings=function(k){var A=J.parse8601(k);k=A.ye+"-"+N(A.mo)+"-"+N(A.da);var D="pm";if(A.ho>12){A.ho-=12;D="pm"}else{if(A.ho==0)A.ho="12";D="am"}A=$(A.ho)+":"+N(A.mi)+" "+D;return{date:k,time:A}};J.transValidateDateString=function(k){if(!k)return false;var A=k.match(/^(\-?\d+|today|now) ?(bce?)?-?(\d{1,2})?-?(\d{1,2})?/);zb=J.zeroButt;if(A){k=A[1];var D=A[2]||"",L=A[3]||"07";A=A[4]||"1";debug.log("bc:",D);
if(parseInt(k,10)<0||D.substr(0,1)=="b")k=-1*Math.abs(k);return J.validateDate(k,L,A)?k+"-"+zb(L)+"-"+zb(A):false}else return false};J.transValidateTimeString=function(k){if(!k)return"12:00:00";k=k.toLowerCase().match(/^(\d{1,2}|noon):?(\d{1,2})?:?(\d{1,2})? ?(am|pm)?/i);var A="";A=J.zeroButt;if(k[1])if(k[0]=="noon")A="12:00:00";else{var D=parseInt(k[1],10)||12,L=parseInt(k[2],10)||0,n=parseInt(k[3],10)||0;k=k[4]||"am";if(J.validateTime(D,L,n)==false)return false;if(k=="pm"&&D<12)D+=12;A=A(D)+":"+
A(L)+":"+A(n)}else A=false;return A};J.validateTime=function(k,A,D){if(k<0||k>23||A<0||A>59||D<0||D>59)return false;return true};J.validateDate=function(k,A,D){var L=J.getMonthDays(A,k);if(D>L||D<=0)return false;if(A>12||A<0)return false;if(k==0)return false;return true};J.zeroButt=function(k){k=parseInt(k,10);return k>9?String(k):"0"+k};J.toFromUTC=function(k,A,D){var L=0,n=[0,31,28,31,30,31,30,31,31,30,31,30,31,29];L={};if(D=="from"){L.ho=-1*A.hours;L.mi=-1*A.minutes}else if(D=="to"){L.ho=A.hours;
L.mi=A.minutes}else{L.ho=-1*k.tz_ho;L.mi=-1*k.tz_mi}if(L.ho==0&&L.mi==0)return k;D=k.ho+k.mi/60+(-1*L.ho+L.mi*-1/60);if(D<0){L=24+D;if(k.da>1)k.da-=1;else if(k.mo==1){k.ye-=1;k.mo=12;k.da=31}else{k.mo-=1;k.da=J.getLastDayOfMonth(k.ye,k.mo)}}else if(D>=24){L=D-24;if(J.isLeapYear(k.ye)&&k.mo==2&&k.da==28)k.da=29;else if(k.da==n[k.mo]){if(k.mo==12){k.ye+=1;k.mo=1}else k.mo+=1;k.da=1}else k.da+=1}else L=D;n=function(v){v=Math.abs(v);var F=Math.floor(v);return{ho:F,mi:Math.round((v-F)*60),se:0}}(L);k.ho=
n.ho;k.mi=n.mi;if(A){k.tz_ho=A.tz_ho;k.tz_mi=A.tz_mi}else{k.tz_ho=0;k.tz_mi=0}return{ye:k.ye,mo:k.mo,da:k.da,ho:k.ho,mi:k.mi,se:k.se}};J.timezones=[{offset:"-12:00",name:"Int'l Date Line West"},{offset:"-11:00",name:"Bering & Nome"},{offset:"-10:00",name:"Alaska-Hawaii Standard Time"},{offset:"-10:00",name:"U.S. Hawaiian Standard Time"},{offset:"-10:00",name:"U.S. Central Alaska Time"},{offset:"-09:00",name:"U.S. Yukon Standard Time"},{offset:"-08:00",name:"U.S. Pacific Standard Time"},{offset:"-07:00",
name:"U.S. Mountain Standard Time"},{offset:"-07:00",name:"U.S. Pacific Daylight Time"},{offset:"-06:00",name:"U.S. Central Standard Time"},{offset:"-06:00",name:"U.S. Mountain Daylight Time"},{offset:"-05:00",name:"U.S. Eastern Standard Time"},{offset:"-05:00",name:"U.S. Central Daylight Time"},{offset:"-04:00",name:"U.S. Atlantic Standard Time"},{offset:"-04:00",name:"U.S. Eastern Daylight Time"},{offset:"-03:30",name:"Newfoundland Standard Time"},{offset:"-03:00",name:"Brazil Standard Time"},{offset:"-03:00",
name:"Atlantic Daylight Time"},{offset:"-03:00",name:"Greenland Standard Time"},{offset:"-02:00",name:"Azores Time"},{offset:"-01:00",name:"West Africa Time"},{offset:"00:00",name:"Greenwich Mean Time/UTC"},{offset:"00:00",name:"Western European Time"},{offset:"01:00",name:"Central European Time"},{offset:"01:00",name:"Middle European Time"},{offset:"01:00",name:"British Summer Time"},{offset:"01:00",name:"Middle European Winter Time"},{offset:"01:00",name:"Swedish Winter Time"},{offset:"01:00",name:"French Winter Time"},
{offset:"02:00",name:"Eastean EU"},{offset:"02:00",name:"USSR-zone1"},{offset:"02:00",name:"Middle European Summer Time"},{offset:"02:00",name:"French Summer Time"},{offset:"03:00",name:"Baghdad Time"},{offset:"03:00",name:"USSR-zone2"},{offset:"03:30",name:"Iran"},{offset:"04:00",name:"USSR-zone3"},{offset:"05:00",name:"USSR-zone4"},{offset:"05:30",name:"Indian Standard Time"},{offset:"06:00",name:"USSR-zone5"},{offset:"06:30",name:"North Sumatra Time"},{offset:"07:00",name:"USSR-zone6"},{offset:"07:00",
name:"West Australian Standard Time"},{offset:"07:30",name:"Java"},{offset:"08:00",name:"China & Hong Kong"},{offset:"08:00",name:"USSR-zone7"},{offset:"08:00",name:"West Australian Daylight Time"},{offset:"09:00",name:"Japan"},{offset:"09:00",name:"Korea"},{offset:"09:00",name:"USSR-zone8"},{offset:"09:30",name:"South Australian Standard Time"},{offset:"09:30",name:"Central Australian Standard Time"},{offset:"10:00",name:"Guam Standard Time"},{offset:"10:00",name:"USSR-zone9"},{offset:"10:00",name:"East Australian Standard Time"},
{offset:"10:30",name:"Central Australian Daylight Time"},{offset:"10:30",name:"South Australian Daylight Time"},{offset:"11:00",name:"USSR-zone10"},{offset:"11:00",name:"East Australian Daylight Time"},{offset:"12:00",name:"New Zealand Standard Time"},{offset:"12:00",name:"Int'l Date Line East"},{offset:"13:00",name:"New Zealand Daylight Time"}];J.boil=$;J.unboil=N})(timeglider);(function(q){var $=q.levelHeight=10;q.TG_Org=function(){var N=this,C=q.icon_folder;this.blocks=[];this.ids=[];this.vis=[];this.tree=[];this.pol=-1;this.addBlock=function(I,W){I.right=I.left+I.width;I.bottom=I.top+I.height;I.tickScope=W;N.blocks.push(I)};this.getBorg=function(){return this};this.getBlocks=function(){return this.blocks};this.getHTML=function(I,W){if(I=="sweep"){N.tree=[];for(var o=0;o<300;o++)N.tree[o]=[];this.vis=[]}this.blocks.sort(T);var U,J="",k="";html="";south_padding=0;b={};
blength=this.blocks.length;for(var A=title_adj=0;A<blength;A++){b=this.blocks[A];if(b.tickScope==I)if(_.indexOf(b.id,this.vis)==-1){this.vis.push(b.id);title_adj=0;if(b.html&&b.html.substr(0,4)=="<div")html+="<div style='left:"+b.left+"px' id='"+b.id+"'"+b.html.substr(4);else{if(b.image){if(b.image.display_class=="layout")title_adj=b.image.height+4;J="<div class='timeglider-event-image-"+b.image.display_class+"'><img src='"+b.image.src+"'></div>"}else J="";if(b.y_position>0)b.top=N.pol*b.y_position;
else B(b,0);b.fontsize<10?b.opacity=b.fontsize/10:b.opacity=1;if(b.span==true){o="timeglider-event-spanning";U="<div class='timeglider-event-spanner' style='top:"+title_adj+"px;height:"+b.fontsize+"px;width:"+b.spanwidth+"px'></div>"}else U=o="";k=b.icon?"<img class='timeglider-event-icon' src='"+C+b.icon+"' style='height:"+b.fontsize+"px;left:-"+(b.fontsize+2)+"px; top:"+title_adj+"px'>":"";if(W&&N.pol==-1&&Math.abs(b.top)>W-16)html+="<div class='timeglider-more-plus' style='left:"+b.left+"px; top:-"+
(W-Math.floor(16/3))+"px'>+</div>";else{south_padding=N.pol===1?42:0;html+="<div class='timeglider-timeline-event "+o+"' id='"+b.id+"' style='width:"+b.width+"px;height:"+b.height+"px;left:"+b.left+"px;opacity:"+b.opacity+";top:"+(b.top+south_padding)+"px;font-size:"+b.fontsize+"px;'>"+k+J+U+"<div class='timeglider-event-title' style='top:"+title_adj+"px'>"+b.title+"</div></div>"}}}}return html};var T=function(I,W){var o=W.importance,U=I.importance;return o<U?-1:o>U?1:0},B=function(I,W){var o=false,
U=N.tree,J=U[W],k=W+1,A=false,D=2;if(J!=undefined){for(D=0;D<J.length;D++){a:{o=J[D];if(!(I.left>o.right||I.right<o.left))if(I.left>=o.left&&I.left<=o.right||I.right>=o.left&&I.right<=o.right||I.right>=o.right&&I.left<=o.left||I.right<=o.right&&I.left>=o.left)if(I.bottom<=o.bottom&&I.bottom>=o.top||I.top<=o.bottom&&I.top>=o.top||I.top==o.bottom&&I.top==o.top){o=true;break a}o=false}if(o==true){if(N.pol===-1){I.top-=$;I.bottom-=$}else{I.top+=$;I.bottom+=$}B(I,k);A=true;break}}if(A==false){if(N.pol===
-1)I.top-=I.fontsize;else I.top+=I.fontsize;J.push(I);D=Math.ceil(I.height/$);for(J=1;J<=D;J++)U[W+J].push(I)}}}}})(timeglider);(function(q){var $=q.TG_Date,N=jQuery,C=$.units,T;q.TG_EventCollection=Backbone.Collection.extend({eventHash:{},setTimelineHash:function(B,I){this.eventHash[B]=I},getTimelineHash:function(B){return this.eventHash[B]},model:q.TG_Event});q.TG_Event=Backbone.Model.extend({urlRoot:"/event",defaults:{title:"Untitled"},initialize:function(B){if(B.image){if(typeof B.image=="string")B.image={id:B.id,src:B.image,display_class:B.image_class||"above",width:0,height:0};else{B.image.display_class=B.display_class||
"above";B.image.width=0;B.image.height=0}this.getEventImageSize(B.image)}else B.image="";B.titleWidth=q.getStringWidth(B.title);this.set(B)},validate:function(){},getEventImageSize:function(B){function I(U,J){return function(){return J.apply(U,arguments)}}var W=this,o=new Image;o.src=B.src;o.onerror=I(o,function(){});o.onload=I(o,function(){W.get("image").height=this.height;W.get("image").width=this.width})}});q.TG_TimelineCollection=Backbone.Collection.extend({model:q.TG_Timeline});q.TG_Timeline=
Backbone.Model.extend({urlRoot:"/timeline",defaults:{initial_zoom:25,focus_date:"today",timezone:"00:00",title:"Untitled",events:[],legend:[]},_chewTimeline:function(B){T=B.mediator;B.timeline_id=B.id;var I={all:[],da:[],mo:[],ye:[],de:[],ce:[],thou:[],tenthou:[],hundredthou:[],mill:[],tenmill:[],hundredmill:[],bill:[]};B.spans=[];B.hasImagesAbove=false;B.startSeconds=[];B.endSeconds=[];B.size_importance=B.size_importance=="false"?false:true;B.timeOffset=$.getTimeOffset(B.timezone||"00:00");if(!B.color)B.color=
"#333333";if(B.events.length>0){for(var W,o,U,J,k=B.events.length,A=0;A<k;A++){o=B.events[A];if(o.id)U=o.id;else o.id=U="anon"+this.anonEventId++;if(o.map)if(T.main_map){if(timeglider.mapping.ready)o.map.marker_instance=timeglider.mapping.addAddMarkerToMap(o,T.main_map)}else q.googleMapsLoad();W=o.date_display||o.date_limit||"da";o.date_display=W.toLowerCase().substr(0,2);if(B.timeOffset.seconds){o.startdate=$.tzOffsetStr(o.startdate,B.timeOffset.string);if(o.enddate)o.enddate=$.tzOffsetStr(o.enddate,
B.timeOffset.string)}o.startdateObj=new $(o.startdate,o.date_display);if(o.enddate&&o.enddate!==o.startdate){o.enddateObj=new $(o.enddate,o.date_display);o.span=true;B.spans["s_"+o.id]={id:o.id,start:o.startdateObj.sec,end:o.enddateObj.sec}}else{o.enddateObj=o.startdateObj;o.span=false}B.startSeconds.push(o.startdateObj.sec);B.endSeconds.push(o.enddateObj.sec);o.cache={span:o.span,startdateObj:_.clone(o.startdateObj),enddateObj:_.clone(o.enddateObj)};if(o.image_class=="above")B.hasImagesAbove=true;
o.icon=!o.icon||o.icon==="none"?"":o.icon;I.all.push(U);for(var D=C.length,L=0;L<D;L++){W=C[L];J=$.getTimeUnitSerial(o.startdateObj,W);if(I[W][J]!==undefined)I[W][J].push(U);else I[W][J]=[U]}if(T.eventCollection.get(U))T.eventCollection.get(U).get("timelines").push(B.timeline_id);else{o.timelines=[B.timeline_id];o=new q.TG_Event(o);T.eventCollection.add(o)}}k=N.merge(B.startSeconds,B.endSeconds);k=_.sortBy(k,function(n){return parseInt(n)});B.bounds={first:_.first(k),last:_.last(k)};B.has_events=
true}else B.has_events=false;B.hasLegend=B.legend.length>0?true:false;B.display="expanded";T.eventCollection.setTimelineHash(B.timeline_id,I);delete B.events;return B},initialize:function(B){this.set(this._chewTimeline(B));this.bind("change",function(){})}})})(timeglider);(function(q){var $=q.TG_Date,N="",C="",T={},B=0,I=0,W=0,o=jQuery,U={},J="",k,A,D,L=o.support.touch?"touchstart":"click";q.TG_PlayerView=function(n,v){var F=this;C=v;T=C.options;N="#"+n._id;J=n._id;this._views={PLACE:N,CONTAINER:N+" .timeglider-container",DATE:N+" .timeglider-date-display",TIMELINE_MENU:N+" .timeglider-timeline-menu",TIMELINE_MENU_UL:N+" .timeglider-timeline-menu ul",TIMELINE_LIST_BT:N+" .timeglider-list-bt",SLIDER_CONTAINER:N+" .timeglider-slider-container",SLIDER:N+" .timeglider-slider",
ZOOM_DISPLAY:N+" .timeglider-zoomlevel-display",TRUCK:N+" .timeglider-truck",CENTERLINE:N+" .timeglider-centerline",TICKS:N+" .timeglider-ticks",HANDLE:N+" .timeglider-handle",FOOTER:N+" .timeglider-footer",FILTER_BT:N+" .timeglider-filter-bt",FILTER_BOX:N+" .timeglider-filter-box",SETTINGS_BT:N+" .timeglider-settings-bt"};k=this._views.CONTAINER;A=this._views.TICKS;D=this._views.DATE;this.initTimelineVOffset=100;this.tick_height=34;this.imageLaneHeight=60;this._templates={};this._templates={test:"testola",
event_modal_small:"<div class='tg-modal timeglider-ev-modal ui-widget-content' id='${id}_modal'><div class='close-button-remove'></div><div class='dateline'>{{html dateline}}</div><h4 id='title'>${title}</h4><p>{{html image}}{{html description}}</p><ul class='timeglider-ev-modal-links'>{{html links}}</ul></div>",event_modal_full:o.template(null,"<div class='tg-modal full_modal' id='ev_${id}_modal'><div class='full_modal_scrim'></div><div class='full_modal_panel'><div class='close-button full_modal_close'>x</div><div class='dateline'>{{html dateline}}</div><table><tr><td><h4>${title}</h4><div class='description'><p>{{html description}}</p></div></td><td><div>{{html image}}</div><div id='insert'></div></td></tr></table><div class='footer'><ul>{{html links}}</ul></div></div>"),
filter_modal:o.template(null,"<div class='tg-modal timeglider-menu-modal timeglider-filter-box'><div class='close-button'></div><h3>filter</h3><div class='timeglider-menu-modal-content'><div class='timeglider-formline'>show: <input type='text' class='timeglider-filter-include'></div><div class='timeglider-formline'>hide: <input type='text' class='timeglider-filter-exclude'></div><ul><li class='timeglider-filter-clear'>clear</li><li class='timeglider-filter-apply'>apply</li></ul></div><div class='timeglider-menu-modal-point-right'></div>"),
timeline_list_modal:o.template(null,"<div class='timeglider-menu-modal timeglider-timeline-menu'><div class='close-button'></div><h3>timelines</h3><div class='timeglider-menu-modal-content'><ul></ul></div><div class='timeglider-menu-modal-point-right'></div>"),settings_modal:o.template(null,"<div class='timeglider-menu-modal timeglider-settings-modal'><div class='close-button'></div><h3>settings</h3><div class='timeglider-menu-modal-content'><div class='timeglider-settings-timezone'></div></div><div class='timeglider-menu-modal-point-right'></div>"),
legend_modal:o.template(null,"<div class='timeglider-menu-modal timeglider-legend timeglider-display-none'  id='${id}_legend'><div class='timeglider-menu-modal-content'><ul id='${id}'>{{html legend_list}}</ul><div class='timeglider-close-button-small timeglider-legend-close'></div><div class='timeglider-legend-all'>all</div></div></div>")};this.timelineModal=q.TG_TimelineView.extend({tagName:"div",model:q.TG_Timeline,className:"tg-modal timeglider-timeline-modal ui-widget-content",events:{"click .close-button-remove":"remove"},
template:"<div class='close-button-remove'></div><h4 id='title'>${title}</h4><p>{{html description}}</p>",initialize:function(){this.model.bind("change",this.render,this)},render:function(){o(this.el).html(o.tmpl(this.template,this.model.attributes)).attr("id",this.model.get("id")+"_timelineModal");return this},remove:function(){o(this.el).fadeOut()}});o(k).delegate(".tg-timeline-envelope .timeline-info","click",function(){var g=o(this).data("timeline_id");F.openTimelineModal(g)}).delegate(".tg-timeline-envelope .expand-collapse",
"click",function(){var g=o(this).data("timeline_id");F.expandCollapseTimeline(g)}).delegate(".tg-timeline-envelope .tg-timeline-legend-bt","click",function(){var g=o(this).data("timeline_id");F.legendModal(g)}).delegate(".close-button-remove","click",function(){var g=o(this).parent().attr("id");o("#"+g).remove()}).delegate(".full_modal_scrim, .full_modal_close","click",function(){o(".full_modal").remove()}).delegate(".timeglider-more-plus","click",function(){C.zoom(-1)}).delegate(".timeglider-legend-close",
"click",function(){var g=o(k+" .timeglider-legend");g.fadeOut(300,function(){g.remove()})}).delegate(".timeglider-legend-all","click",function(){o(k+" .timeglider-legend li").each(function(){o(this).removeClass("tg-legend-icon-selected")});C.setFilters({origin:"legend",icon:"all"})}).css("height",o(N).height());this.basicFontSize=T.basic_fontsize;T.show_footer==false&&o(this._views.FOOTER).css("display","none");this.dragSpeed=0;this.dimensions=this.getWidgetDimensions();this.ticksHandleOffset=this.rightside=
this.leftside=this.tickNum=0;this.timeoout_id=1;this.sliderActive=false;this.ztop=1E3;this.filterBoxActivated=false;this.buildSlider();this.setupFilter();this.setPanButton(o(".timeglider-pan-right"),-30);this.setPanButton(o(".timeglider-pan-left"),30);o(this._views.TRUCK).bind("dblclick",function(g){C.registerUIEvent({name:"dblclick",event:g,dimensions:F.dimensions})}).bind("mousewheel",function(g,h){var y=Math.ceil(-1*h*3),p=C.getZoomLevel();C.setZoomLevel(p+y);return false});o(A).draggable({axis:"x",
start:function(){},drag:function(){I=Math.floor(o(this).position().left);C.setTicksOffset(I);B=I-W;debug.trace("::>>"+B,"note");W=I},stop:function(){debug.trace("::||"+B,"note");F.resetTicksHandle();F.registerDragging()}}).delegate(k+" .timeglider-timeline-event",L,function(){var g=o(this).attr("id"),h=C.eventCollection.get(g).attributes;debug.log("event id on touchstart/click:"+g);if(timeglider.mode=="authoring")debug.log("hello authoring in TG_TimelineView.js");else if(h.click_callback){g=h.click_callback.split(".");
var y=g.length;if(y==1)window[g[0]](h);else if(y==2)window[g[0]][g[1]](h);else if(y==3)window[g[0]][g[1]][g[2]](h)}else F.eventModal(g)}).delegate(".timeglider-timeline-event","mouseover",function(){var g=C.eventCollection.get(o(this).attr("id")).attributes;F.eventHover(o(this),g)}).delegate(".timeglider-timeline-event","mouseout",function(){var g=C.eventCollection.get(o(this).attr("id")).attributes;F.eventUnHover(o(this),g)}).delegate(".timeglider-event-collapsed","hover",function(){var g=C.eventCollection.get(o(this).attr("id")).attributes.title;
debug.trace("collapsed, title:"+g,"note")});C.options.show_centerline===true?o(this._views.CENTERLINE).css({height:F.dimensions.container.height,left:F.dimensions.container.centerx}):o(this._views.CENTERLINE).css({display:"none"});o.subscribe("mediator.ticksOffsetChange",function(){F.tickHangies();F.registerDragging();F.registerTitles()});o.subscribe("mediator.focusToEvent",function(){});o.subscribe("mediator.zoomLevelChange",function(){F.tickNum=0;F.leftside=0;var g=C.getZoomLevel();o(F._views.SLIDER).slider("value",
F.invSliderVal(g));F.displayZoomLevel(g);F.castTicks("zoomLevelChange")});o.subscribe("mediator.ticksReadySignal",function(){C.ticksReady===true&&F.freshTimelines()});o.subscribe("mediator.refreshSignal",function(){F.tickNum=0;F.leftside=0;F.castTicks("refreshSignal")});o.subscribe("mediator.ticksArrayChange",function(){});o.subscribe("mediator.focusDateChange",function(){this.displayFocusDate()});o.subscribe("mediator.timelineDataLoaded",function(){o(".timeglider-loading").fadeOut(500);F.buildSettingsMenu();
F.buildTimelineMenu()});o.subscribe("mediator.activeTimelinesChange",function(){o(F._views.TIMELINE_MENU_UL+" li").each(function(){var g=o(this).data("timeline_id");o.inArray(g,C.activeTimelines)!=-1?o(this).addClass("activeTimeline"):o(this).removeClass("activeTimeline")})});o.subscribe("mediator.filterChange",function(){});if(o.support.touch){o("#"+J).addTouch();var R=document.getElementById(J);R.addEventListener("gesturestart",function(g){g.preventDefault();o("#output").append("<br>gesture zoom:"+
C.getZoomLevel())},false);R.addEventListener("gestureend",function(g){g.preventDefault();o("#output").append("<br>gesture end:"+C.getZoomLevel())},false);R.addEventListener("gesturechange",function(g){g.preventDefault();g.preventDefault();if(C.gesturing===false){C.gesturing=true;C.gestureStartZoom=C.getZoomLevel()}C.setZoomLevel(Math.ceil(C.gestureStartZoom/g.scale))},false)}};q.TG_PlayerView.prototype={getWidgetDimensions:function(){var n=o(k),v=n.width(),F=Math.floor(v/2)+1,R=n.height(),g=Math.floor(R/
2),h=this.tick_height,y=n.position().left;n=n.offset();var p=T.show_footer==true?o(this._views.FOOTER).height():0;return{container:{width:v,height:R,centerx:F,centery:g,left:y,offset:n},tick:{top:R-p-h},footer:{height:p}}},scaleToImportance:function(n,v){return n/v},displayZoomLevel:function(){var n=C.getZoomLevel();n>0&&T.display_zoom_level==true&&o(this._views.ZOOM_DISPLAY).text(n)},displayFocusDate:function(){var n=C.getFocusDate();o(D).text(n.format("d MMM yyyy",false))},setPanButton:function(n,
v){var F=this;o(n).live("mousedown",function(){F.intervalMachine("pan",{type:"set",fn:F.pan,args:[v],intvl:33})}).live("mouseup",function(){F.intervalMachine("pan",{type:"clear",fn:F.pan,callback:"resetTicksHandle"})}).live("mouseout",function(){F.intervalMachine("pan",{type:"clear",fn:F.pan,callback:"resetTicksHandle"})})},intervalMachine:function(n,v){var F=this;if(v.type==="clear"){clearInterval(U[n]);if(v.callback)F[v.callback]()}else U[n]=setInterval(function(){v.fn.apply(F,v.args)},v.intvl)},
invSliderVal:function(n){return Math.abs(n-101)},pan:function(n){n=n||20;$t=o(A);newPos=$t.position().left+n;$t.css({left:newPos});C.setTicksOffset(newPos)},registerTitles:function(){var n,v,F,R,g,h,y,p,l,x=o(k).offset().left;o(".timeglider-event-spanning").each(function(){n=o(this).offset().left-x;v=o(this).outerWidth();h=o(".timeglider-event-title",this);F=h.outerWidth()+5;R=h.siblings(".timeglider-event-spanner").outerWidth();R>F&&n<0&&Math.abs(n)<v-F&&h.css({marginLeft:-1*n+5})});o.browser.msie&&
parseInt(o.browser.version);o(".tg-timeline-envelope").each(function(){y=o(this);p=y.offset().left-x;$tb=y.find(".titleBar");g=$tb.data("lef");l=-1*(g+p);$ti=$tb.find(".timeline-title");l>0&&$ti.css({marginLeft:l+5})})},registerDragging:function(){var n=C.startSec,v=o(A).position().left,F=C.getZoomInfo().spp;n=new $(n-v*F);C.setFocusDate(n);this.displayFocusDate()},setupFilter:function(){var n=this;$filter=o.tmpl(n._templates.filter_modal,{}).appendTo(n._views.CONTAINER);$filter.css("z-index",n.ztop++).position({my:"right bottom",
at:"right top",of:o(n._views.FILTER_BT),offset:"-8, -12"}).hide();o(k).delegate(".timeglider-filter-box .close-button","click",function(){$filter.fadeOut()});o(n._views.FILTER_BT).bind("click",function(){$filter.fadeIn();o(this);var v=n._views.FILTER_BOX;if(n.filterBoxActivated==false){n.filterBoxActivated=true;var F=o(v+" .timeglider-filter-apply"),R=o(".timeglider-filter-box .close-button"),g=o(v+" .timeglider-filter-clear"),h="",y="";F.bind("click",function(){h=o(v+" .timeglider-filter-include").val();
y=o(v+" .timeglider-filter-exclude").val();C.setFilters({origin:"clude",include:h,exclude:y});o(v).toggleClass("timeglider-display-block")});R.bind("click",function(){o(v).toggleClass("timeglider-display-none")});g.bind("click",function(){C.setFilters({origin:"clude",include:"",exclude:""});o(v+" .timeglider-filter-include").val("");o(v+" .timeglider-filter-exclude").val("");o(v).toggleClass("timeglider-display-block")})}})},buildTimelineMenu:function(){var n=this,v;o(n._views.TIMELINE_LIST_BT);o(n._views.TIMELINE_MENU)[0]&&
o(n._views.TIMELINE_MENU).remove();v=o.tmpl(n._templates.timeline_list_modal,{}).appendTo(n._views.CONTAINER);var F=Backbone.View.extend({initialize:function(){this.model.bind("change",this.render,this)},tagName:"li",className:"timeglider-timeline-list-item",template:"${title}",events:{click:"toggleTimeline"},toggleTimeline:function(){C.toggleTimeline(this.model.get("id"))},render:function(){var R=this.model.get("id");o(this.el).html(o.tmpl(this.template,this.model.attributes)).data("timeline_id",
R);return this}});o(n._views.TIMELINE_MENU_UL).html("");_.each(C.timelineCollection.models,function(R){o(n._views.TIMELINE_MENU_UL).append((new F({model:R})).render().el)});v.position({my:"right bottom",at:"right top",of:o(n._views.TIMELINE_LIST_BT),offset:"-8, -12"}).hide();o(k).delegate(".timeglider-timeline-menu .close-button","click",function(){v.fadeOut()}).delegate(this._views.TIMELINE_LIST_BT,"click",function(){v.fadeIn()})},getTimezonePulldown:function(n,v){var F="<select name='timezone' id='"+
n+"'>",R=false,g="selected";o.map($.timezones,function(h){if(v==h.offset&&R==false){g="selected";R=true}else g="";F+="<option value='"+h.offset+"' "+g+">"+h.name+"</option>"});F+="</select>";return F},buildSettingsMenu:function(){var n=o.tmpl(this._templates.settings_modal,{}).appendTo(this._views.CONTAINER),v=this.getTimezonePulldown("timeglider-settings-timezone",C.timeOffset.string);n.find(".timeglider-settings-timezone").append('<p>Make changes below, then click on "save". More settings options to come!</p>').append('<span class="settings-label">timezone:</span> '+
v).append("<p style='clear:both'>&nbsp;</p><div class='btn success' id='timeglider-settings-save'>save</div>");n.position({my:"right bottom",at:"right top",of:o(this._views.SETTINGS_BT),offset:"-8, -12"}).hide();o(k).delegate(".timeglider-settings-modal .close-button","click",function(){n.fadeOut()}).delegate(this._views.SETTINGS_BT,"click",function(){n.fadeIn()}).delegate("#timeglider-settings-save","click",function(){var F=o(k+" #timeglider-settings-timezone").val();C.setTimeoffset(F)})},buildSlider:function(){var n=
C.getZoomLevel();if(T.min_zoom==T.max_zoom)o(this._views.SLIDER_CONTAINER).css("display","none");else{T.display_zoom_level==true&&o("<div>").appendTo(this._views.SLIDER_CONTAINER).addClass("timeglider-zoomlevel-display").html("&nbsp;");var v=this;n=v.invSliderVal(n);var F=C.max_zoom,R=C.min_zoom;o(this._views.SLIDER).css("height",(1+F-R)*3).slider({steps:100,handle:o(".knob"),animate:300,orientation:"vertical",min:v.invSliderVal(F),max:v.invSliderVal(R),value:n,start:function(){v.sliderActive=true},
stop:function(){v.sliderActive=false},change:function(){},slide:function(g,h){C.setZoomLevel(v.invSliderVal(h.value))}})}},getEventDateLine:function(n){var v="<span class='timeglider-dateline-startdate'>"+n.startdateObj.format("",true,C.timeOffset)+"</span>";endDateF="";if(n.span==true)endDateF=" &ndash; <span class='timeglider-dateline-enddate'>"+n.enddateObj.format("",true,C.timeOffset)+"</span>";return v+endDateF},eventHover:function(n,v){var F=o(".timeglider-event-hover-info");v.date_display!=
"no"&&F.position({my:"left bottom",at:"left top",of:n,offset:"1, -10",collision:"flip flip"}).html(this.getEventDateLine(v));n.addClass("tg-event-hovered")},eventUnHover:function(n){o(".timeglider-event-hover-info").css("left","-1000px");n.removeClass("tg-event-hovered")},clearTicks:function(){this.tickNum=this.leftside=0;o(A).css("left",0);o(k+" .tg-timeline-envelope").remove();o(k+" .timeglider-tick").remove()},castTicks:function(){this.clearTicks();C.getZoomLevel();var n=C.getFocusDate(),v=C.getZoomInfo().width;
v=Math.ceil(this.dimensions.container.width/v)+4;var F="l";C.setTicksReady(false);this.addTick({type:"init",focus_date:n});for(n=1;n<=v;n+=1){this.addTick({type:F});F=F=="l"?"r":"l"}C.setTicksReady(true);this.displayFocusDate()},addTick:function(n){var v=0,F=0,R=F=0,g=0,h=0,y="";g={};h={};R={};var p={};h={};p="";var l=0,x=1;y="";tickUnit=C.getZoomInfo().unit;tickWidth=C.getZoomInfo().width;focusDate=C.getFocusDate();tick_top=parseInt(this.dimensions.tick.top);g=C.addToTicksArray({type:n.type,unit:tickUnit},
focusDate);if(tickUnit=="mo"){h=$.getMonthAdj(g,tickWidth);tickWidth=h.width;v=h.days}this.tickNum++;if(n.type=="init"){h=this.tickOffsetFromDate(C.getZoomInfo(),C.getFocusDate(),tickWidth);this.leftside=F=Math.ceil(this.dimensions.container.centerx+h);this.rightside=F+tickWidth}else if(n.type=="l")this.leftside=F=Math.floor(this.leftside-tickWidth);else if(n.type=="r"){F=Math.floor(this.rightside);this.rightside+=tickWidth}C.getTickBySerial(g).width=tickWidth;C.getTickBySerial(g).left=F;y=this._views.PLACE+
"_"+tickUnit+"_"+g+"-"+this.tickNum;h=o("<div class='timeglider-tick' id='"+y+"'><div class='timeglider-tick-label' id='label'></div></div>").appendTo(A);h.css({width:tickWidth,left:F,top:tick_top});R=this.getTickMarksInfo({unit:tickUnit,width:tickWidth});R=v||R.tperu;F=tickWidth/R;if(F>5){n=Raphael(y,tickWidth,30);var E="";for(v=0;v<R;v++){y=v*F;E+="M"+y+" 20 L"+y+" 30";if(tickUnit=="da"&&F>16){y=this.getHourLabelFromHour(l,F);p+="<div class='timeglider-tick-sub-label' style='width:"+(F-4)+"px'>"+
y+"</div>";l++}if(tickUnit=="mo"&&F>16){p+="<div class='timeglider-tick-sub-label' style='width:"+(F-4)+"px'>"+x+"</div>";x++}}n.path(E).attr({stroke:"#333","stroke-width":1})}p&&h.append("<div style='width:"+(tickWidth+10)+"px;position:absolute;top:17px;left:0;overflow:hidden'>"+p+"</div>");p={unit:tickUnit,width:tickWidth,serial:g};g=this.getDateLabelForTick(p);h.children("#label").text(g);return p},getHourLabelFromHour:function(n,v){var F="";F=F="";F=n>12?n-12:n;if(F==0)F=12;return F+(v>60?":00":
"")+(n>11?" pm":" am")},getTickMarksInfo:function(n){switch(n.unit){case "da":n=24;break;case "mo":n=30;break;case "ye":n=12;break;default:n=10}return{tperu:n}},getDateLabelForTick:function(n){var v=n.serial,F=n.width;switch(n.unit){case "bill":return v==0?"1":v>0?v+" billion":v+" b.y. bce";case "hundredmill":return v==0?"1":v>0?v+"00 million":v+"00 m.y. bce";case "tenmill":return v==0?"1":v>0?v+"0 million":v+"0 m.y. bce";case "mill":return v==0?"1":v>0?v+" million":v+" m.y. bce";case "hundredthou":return v==
0?"1":v>0?v+"00,000":v+"00,000 bce";case "tenthou":return v==0?"1":v>0?v+"0,000":v+"0,000 bce";case "thou":return v==0?"1("+v+")":v>0?v+"000":v+"000 bce";case "ce":return v==0?"1("+v+")":v>0?v+"00":v+"00 bce";case "de":return v>120?v*10+"s":v*10;case "ye":return v;case "mo":n=$.getDateFromMonthNum(v);return F<120?$.monthNamesAbbr[n.mo]+" "+n.ye:$.monthNames[n.mo]+", "+n.ye;case "da":n=new $($.getDateFromRD(v));return F<120?$.monthNamesAbbr[n.mo]+" "+n.da+", "+n.ye:$.monthNames[n.mo]+" "+n.da+", "+
n.ye;default:return n.unit+":"+v+":"+F}},tickHangies:function(){var n=o(A).position().left,v=this.rightside+n-this.dimensions.container.width;if(this.leftside+n>-100){n=this.addTick({type:"l"});this.appendTimelines(n)}else if(v<100){n=this.addTick({type:"r"});this.appendTimelines(n)}},tickOffsetFromDate:function(n,v,F){switch(n.unit){case "da":v=v.ho/24+v.mi/1440;F*=v;break;case "mo":n=$.getMonthDays(v.mo,v.ye);v=(v.da-1)/n+v.ho/(24*n)+v.mi/(1440*n);F*=v;break;case "ye":v=((v.mo-1)*30+v.da)/365;F*=
v;break;case "de":v=v.ye%10/10+v.mo/120;F*=v;break;case "ce":v=v.ye%100/100+v.mo/1200;F*=v;break;case "thou":v=v.ye%1E3/1E3;F*=v;break;case "tenthou":v=v.ye%1E4/1E4;F*=v;break;case "hundredthou":v=v.ye%1E5/1E5;F*=v;break;default:F=0}return-1*F},resetTicksHandle:function(){o(this._views.HANDLE).offset({left:o(k).offset().left})},easeOutTicks:function(){Math.abs(B)>5&&o(A).animate({left:"+="+3*B},1E3,"easeOutQuad",function(){debug.trace("stopping easing","note")})},getTimelineEventsByTick:function(n){var v=
n.tick.unit,F=n.tick.serial;n=C.eventCollection.getTimelineHash(n.timeline.timeline_id);return n[v][F]&&n[v][F].length>0?n[v][F]:0},passesFilters:function(n,v){var F=true,R="",g=[],h;R="";g=[];if(v<n.low_threshold||v>n.high_threshold)return false;if(R=C.filters.include){g=R.split(",");F=false;for(h=0;h<g.length;h++){R=RegExp(o.trim(g[h]),"i");if(n.title.match(R))F=true}}if(R=C.filters.exclude){g=R.split(",");for(h=0;h<g.length;h++){R=RegExp(o.trim(g[h]),"i");if(n.title.match(R))F=false}}R=n.icon;
if(C.filters.legend.length>0)if(o.inArray(R,C.filters.legend)==-1)F=false;return F},freshTimelines:function(){var n,v,F,R=C.activeTimelines,g=C.ticksArray,h="",y;v="";var p=this.dimensions.container.centerx;n=this.dimensions.container.width;var l=C.getFocusDate().sec,x=C.getZoomInfo().spp;C.getZoomInfo();v=[];var E=[],G=l-Math.floor(x*(n/2));F=y=0;for(var Q,i=0,r=this.dimensions.container.height,z=i=0;z<R.length;z++){E=[];v=C.timelineCollection.get(R[z]);n=v.attributes;Q=n.display;i=n.top?parseInt(n.top.replace("px",
"")):r-this.initTimelineVOffset;v=new q.TG_TimelineView({model:v});y=C.timeOffset.seconds/x;$tl=o(v.render().el).appendTo(A);$tl.draggable({axis:"y",handle:".titleBar",stop:function(){var H=o(this).css("top"),P=o(this).attr("id");C.timelineCollection.get(P).set({top:H});C.refresh()}}).css({top:i,left:y});y=$tl.find(".titleBar");v=p+(n.bounds.first-l)/x;F=p+(n.bounds.last-l)/x;F-=v;y.css({top:void 0,left:v,width:F}).data({lef:v,wid:F});if(Q=="expanded")n.borg=h=new timeglider.TG_Org;for(y=0;y<g.length;y++){v=
this.getTimelineEventsByTick({tick:g[y],timeline:n});o.merge(E,v)}_.each(n.spans,function(H){H.start<G&&H.end>G&&o.inArray(H.id,E)==-1&&E.unshift(H.id)});v=this.compileTickEventsAsHtml(n,E,0,"sweep");i=T.event_overflow=="scroll"?0:n.hasImagesAbove?i-this.imageLaneHeight:i;if(Q=="expanded"){v=h.getHTML("sweep",i);n.borg=h.getBorg()}v!="undefined"&&$tl.append(v);this.registerEventImages($tl)}this.registerTitles()},appendTimelines:function(n){for(var v=C.activeTimelines,F,R="",g=0;g<v.length;g++){F=
C.timelineCollection.get(v[g]).attributes;idArr=this.getTimelineEventsByTick({tick:n,timeline:F});R=this.compileTickEventsAsHtml(F,idArr,n.serial,"append");if(F.display=="expanded")R=F.borg.getHTML(n.serial,F.top);F=o(k+" .tg-timeline-envelope#"+F.id).append(R);this.registerEventImages(F)}},compileTickEventsAsHtml:function(n,v,F,R){var g;g=0;var h=this.dimensions.container.centerx,y=n.display,p=$tl.height();stuff="";foSec=C.startSec;spp=C.getZoomInfo().spp;zl=C.getZoomInfo().level;buffer=20;borg=
n.borg;block_arg="sweep";if(R=="append")block_arg=F;for(F=0;F<v.length;F++){ev=C.eventCollection.get(v[F]).attributes;if(this.passesFilters(ev,zl)===true){g=h+(ev.startdateObj.sec-foSec)/spp;if(y=="expanded"){impq=n.size_importance!==false?this.scaleToImportance(ev.importance,zl):1;ev.width=ev.titleWidth*impq+buffer;ev.fontsize=this.basicFontSize*impq;ev.left=g;ev.spanwidth=0;if(ev.span==true){ev.spanwidth=(ev.enddateObj.sec-ev.startdateObj.sec)/spp;if(ev.spanwidth>ev.width)ev.width=ev.spanwidth}g=
0;if(ev.image&&ev.image.display_class==="layout"){g=ev.image.height+2;ev.width=ev.image.width>ev.width?ev.image.width:ev.width}ev.height=Math.ceil(ev.fontsize)+g;ev.top=p-ev.height;borg.addBlock(ev,block_arg)}else if(y=="collapsed")stuff+="<div id='"+ev.id+"' class='timeglider-event-collapsed' style='top:"+(p-2)+"px;left:"+g+"px'></div>"}}return y=="collapsed"?stuff:""},registerEventImages:function(n){o(k+" .timeglider-event-image-bar").each(function(){o(this).position({my:"top",at:"bottom",of:n,
offset:"0, 0"}).css("left",0)});o(k+" .timeglider-event-image-above").each(function(){o(this).position({my:"top",at:"top",of:o(k),offset:"0, 12"}).css("left",0)})},expandCollapseTimeline:function(n){n=C.timelineCollection.get(n).attributes;n.display=n.display=="expanded"?"collapsed":"expanded";C.refresh()},openTimelineModal:function(n){n=new this.timelineModal({model:C.timelineCollection.get(n)});o(n.render().el).appendTo("body").position({my:"left top",at:"left top",of:this._views.CONTAINER,offset:"32, 32",
collision:"fit fit"}).css("z-index",this.ztop++).draggable({stack:".timeglider-modal"})},createEventLinksMenu:function(n){if(!n)return"";var v="",F=0,R="",g="";if(typeof n=="string")v="<li><a href='"+n+"' target='_blank'>link</a></li>";else if(typeof n=="object")for(F=0;F<n.length;F++){R=n[F].url;g=n[F].label;v+="<li><a href='"+R+"' target='_blank'>"+g+"</a></li>"}return v},eventModal:function(n){o(k+" #"+n+"_modal").remove();var v=this,F=false,R=false,g="";g={};g=0;var h=T.event_modal.type;g=o("#"+
n);var y=C.eventCollection.get(n).attributes,p=y.image&&y.image.src?"<img src='"+y.image.src+"'>":"",l=this.createEventLinksMenu(y.link);n={title:y.title,description:y.description,id:n,dateline:v.getEventDateLine(y),links:l,image:p,video:y.video};if(y.video){n.video=y.video;h="full";R=true}else if(y.map)if(y.map.latlong){F=true;h="full"}switch(h){case "full":n=o.tmpl(v._templates.event_modal_full,n);n.appendTo(k).css({"z-index":v.ztop++}).position({my:"left top",at:"left top",of:k,offset:"0, 0",collision:"none none"});
if(F==true){n.find("#insert").append("<div id='map_modal_map'></div>");g=y.map.zoom||12;llarr=String(y.map.latlong).split(",");map_ll=new google.maps.LatLng(parseFloat(llarr[0]),parseFloat(llarr[1]));g={zoom:g,center:map_ll,mapTypeId:google.maps.MapTypeId.ROADMAP};g=new google.maps.Map(o("#map_modal_map")[0],g);if(y.map.markers)for(F=0;F<y.map.markers.length;F++){R=y.map.markers[F];new google.maps.MarkerImage(R.image,new google.maps.Size(24,32),new google.maps.Point(0,0),new google.maps.Point(0,32));
n=R.latlong.split(",");n=new google.maps.LatLng(n[0],n[1]);R=new google.maps.Marker({position:n,map:g,icon:R.icon,title:R.title,zIndex:R.zIndex})}}else R==true&&n.find("#insert").append("<iframe width='100%' height='300' src='"+y.video+"'></iframe></div>");y=v.dimensions.container.height;F=v.dimensions.container.width;R=o(k+" .full_modal_panel");n=R.width();g=R.height();R.css({top:(y-g)/2+"px",left:(F-n)/2+"px"});break;case "video":n=o.tmpl(v._templates.event_modal_video,n);n.appendTo(A).css("z-index",
v.ztop++).position({my:"right center",at:"left center",of:g,offset:"-12, -1",collision:"flip fit"}).hover(function(){o(this).css("z-index",v.ztop++)});break;default:n=o.tmpl(v._templates.event_modal_small,n);n.appendTo(A).css("z-index",v.ztop++).position({my:"right center",at:"left center",of:g,offset:"-12, -1",collision:"flip fit"}).draggable().hover(function(){o(this).css("z-index",v.ztop++)})}},legendModal:function(n){var v=C.timelineCollection.get(n).attributes.legend,F,R,g,h="";for(F=0;F<v.length;F++){R=
T.icon_folder+v[F].icon;g=v[F].title;h+="<li><img src='"+R+"'>"+g+"</li>"}n={id:n,legend_list:h};o(k+" .timeglider-legend").remove();o.tmpl(this._templates.legend_modal,n).appendTo(k).css("z-index",this.ztop++).toggleClass("timeglider-display-none").position({my:"left top",at:"left top",of:k,offset:"16, -4",collision:"none none"});o(k+" .timeglider-legend li").click(function(){o(this).parent().attr("id");var y=o(this).children("img").attr("src");o(this).toggleClass("tg-legend-icon-selected");C.setFilters({origin:"legend",
icon:y})})},parseHTMLTable:function(n){var v={},F=+new Date,R=[];o("#"+n).find("tr").each(function(g){var h=o(this).children(),y;if(g===0)R=h.map(function(){return o(this).attr("class").replace(/^.*?\btg-(\S+)\b.*?$/,"$1")}).get();else{y={};h.each(function(p){y[R[p]]=o(this).text()});v["prefix"+F++]=y}});return v}};q.TG_TimelineView=Backbone.View.extend({initialize:function(){var n=this;this.model.bind("change:title",function(){o(n.el).find(".timeline-title-span").text(n.model.get("title"))});this.model.bind("destroy",
this.remove,this)},tagName:"div",events:{"click .timeline-title-span":"titleClick"},className:"tg-timeline-envelope",getTemplate:function(){var n="<div class='titleBar'><div class='timeline-title'><span class='timeline-title-span'>${title}</span><div class='tg-timeline-env-buttons'>";if(this.model.get("description"))n+="<span class='timeline-info' data-timeline_id='${id}'>info</span>";if(this.model.get("hasLegend"))n+="<span class='tg-timeline-legend-bt' data-timeline_id='${id}'>legend</span>";n+=
"<span class='expand-collapse' data-timeline_id='${id}'>exp/col</span>";n+="</div></div></div>";return n},render:function(){this.model.get("id");this.model.get("title");var n=this.getTemplate();o(this.el).html(o.tmpl(n,this.model.attributes)).attr("id",this.model.get("id"));return this},setText:function(){},titleClick:function(){C.timelineTitleClick(this.model.get("id"))},remove:function(){o(this.el).remove()}});q.zoomTree=[{},{unit:"da",width:35E3,level:1,label:"5 hours"},{unit:"da",width:17600,
level:2,label:"7 hours"},{unit:"da",width:8800,level:3,label:"10 hours"},{unit:"da",width:4400,level:4,label:"12 hours"},{unit:"da",width:2200,level:5,label:"14 hours"},{unit:"da",width:1100,level:6,label:"17 hours"},{unit:"da",width:550,level:7,label:"22 hours"},{unit:"da",width:432,level:8,label:"1 DAY"},{unit:"da",width:343,level:9,label:"1.5 days"},{unit:"da",width:272,level:10,label:"2 days"},{unit:"da",width:216,level:11,label:"2.5 days"},{unit:"da",width:171,level:12,label:"3 days"},{unit:"da",
width:136,level:13,label:"3.5 days"},{unit:"da",width:108,level:14,label:"4 days"},{unit:"mo",width:2509,level:15,label:"6 days"},{unit:"mo",width:1945,level:16,label:"1 WEEK"},{unit:"mo",width:1508,level:17,label:"10 days"},{unit:"mo",width:1169,level:18,label:"2 weeks"},{unit:"mo",width:913,level:19,label:"2.5 weeks"},{unit:"mo",width:719,level:20,label:"3 weeks"},{unit:"mo",width:566,level:21,label:"3.5 weeks"},{unit:"mo",width:453,level:22,label:"1 MONTH"},{unit:"mo",width:362,level:23,label:"5.5 weeks"},
{unit:"mo",width:290,level:24,label:"7 weeks"},{unit:"mo",width:232,level:25,label:"2 months"},{unit:"mo",width:186,level:26,label:"2.5 months"},{unit:"mo",width:148,level:27,label:"3 months"},{unit:"mo",width:119,level:28,label:"4 months"},{unit:"mo",width:95,level:29,label:"5 months"},{unit:"mo",width:76,level:30,label:"6 months"},{unit:"ye",width:723,level:31,label:"9 months"},{unit:"ye",width:573,level:32,label:"1 YEAR"},{unit:"ye",width:455,level:33,label:"1.25 years"},{unit:"ye",width:361,level:34,
label:"1.5 years"},{unit:"ye",width:286,level:35,label:"2 years"},{unit:"ye",width:227,level:36,label:"2.5 years"},{unit:"ye",width:179,level:37,label:"3 years"},{unit:"ye",width:142,level:38,label:"4 years"},{unit:"ye",width:113,level:39,label:"5 years"},{unit:"ye",width:89,level:40,label:"6 years"},{unit:"de",width:705,level:41,label:"8 years"},{unit:"de",width:559,level:42,label:"10 years"},{unit:"de",width:443,level:43,label:"13 years"},{unit:"de",width:302,level:44,label:"16 years"},{unit:"de",
width:240,level:45,label:"20 years"},{unit:"de",width:190,level:46,label:"25 years"},{unit:"de",width:150,level:47,label:"30 years"},{unit:"de",width:120,level:48,label:"40 years"},{unit:"de",width:95,level:49,label:"50 years"},{unit:"de",width:76,level:50,label:"65 years"},{unit:"ce",width:600,level:51,label:"80 years"},{unit:"ce",width:480,level:52,label:"100 years"},{unit:"ce",width:381,level:53,label:"130 years"},{unit:"ce",width:302,level:54,label:"160 years"},{unit:"ce",width:240,level:55,label:"200 years"},
{unit:"ce",width:190,level:56,label:"250 years"},{unit:"ce",width:150,level:57,label:"300 years"},{unit:"ce",width:120,level:58,label:"400 years"},{unit:"ce",width:95,level:59,label:"500 years"},{unit:"ce",width:76,level:60,label:"600 years"},{unit:"thou",width:603,level:61,label:"1000 years"},{unit:"thou",width:478,level:62,label:"1200 years"},{unit:"thou",width:379,level:63,label:"1800 years"},{unit:"thou",width:301,level:64,label:"160 years"},{unit:"thou",width:239,level:65,label:"xxx years"},
{unit:"thou",width:190,level:66,label:"xxx years"},{unit:"thou",width:150,level:67,label:"xxx years"},{unit:"thou",width:120,level:68,label:"xxx years"},{unit:"thou",width:95,level:69,label:"8,000 years"},{unit:"thou",width:76,level:70,label:"10,000 years"},{unit:"tenthou",width:603,level:71,label:"15,000 years"},{unit:"tenthou",width:358,level:72,label:"20,000 years"},{unit:"tenthou",width:213,level:73,label:"30,000 years"},{unit:"tenthou",width:126,level:74,label:"60,000 years"},{unit:"tenthou",
width:76,level:75,label:"100,000 years"},{unit:"hundredthou",width:603,level:76,label:"180,000 years"},{unit:"hundredthou",width:358,level:77,label:"300,000 years"},{unit:"hundredthou",width:213,level:78,label:"500,000 years"},{unit:"hundredthou",width:126,level:79,label:"800,000 years"},{unit:"hundredthou",width:76,level:80,label:"1 million years"},{unit:"mill",width:603,level:81,label:"1.2 million years"},{unit:"mill",width:358,level:82,label:"2 million years"},{unit:"mill",width:213,level:83,label:"3 million years"},
{unit:"mill",width:126,level:84,label:"5 million years"},{unit:"mill",width:76,level:85,label:"10 million years"},{unit:"tenmill",width:603,level:86,label:"15 million years"},{unit:"tenmill",width:358,level:87,label:"30 million years"},{unit:"tenmill",width:213,level:88,label:"50 million years"},{unit:"tenmill",width:126,level:89,label:"80 million years"},{unit:"tenmill",width:76,level:90,label:"100 million years"},{unit:"hundredmill",width:603,level:91,label:"120 million years"},{unit:"hundredmill",
width:358,level:92,label:"200 million years"},{unit:"hundredmill",width:213,level:93,label:"300 million years"},{unit:"hundredmill",width:126,level:94,label:"500 million years"},{unit:"hundredmill",width:76,level:95,label:"1 billion years"},{unit:"bill",width:603,level:96,label:"15 million years"},{unit:"bill",width:358,level:97,label:"30 million years"},{unit:"bill",width:213,level:98,label:"50 million years"},{unit:"bill",width:126,level:99,label:"80 million years"},{unit:"bill",width:76,level:100,
label:"100 billion years"}];q.calculateSecPerPx=function(n){for(var v=1;v<n.length;v++){var F=n[v],R=0;switch(F.unit){case "da":R=86400;break;case "mo":R=2419200;break;case "ye":R=31536E3;break;case "de":R=31536E4;break;case "ce":R=31536E5;break;case "thou":R=31536E6;break;case "tenthou":R=31536E7;break;case "hundredthou":R=31536E8;break;case "mill":R=31536E9;break;case "tenmill":R=31536E10;break;case "hundredmill":R=31536E11;break;case "bill":R=31536E12}F.spp=R/parseInt(F.width)}}(q.zoomTree);q.getStringWidth=
function(n){if(n)return o("#timeglider-measure-span").html(n).width()};String.prototype.removeWhitespace=function(){return this.replace(RegExp("\\n","g"),"")};if(debug)debug.trace=function(n,v){o("#"+v).text(n)};q.googleMapsInit=function(){};q.googleMapsLoaded=false;q.googleMapsLoad=function(){if(q.googleMapsLoaded==false){var n=document.createElement("script");n.type="text/javascript";n.src="http://maps.googleapis.com/maps/api/js?sensor=false&callback=timeglider.googleMapsInit";document.body.appendChild(n);
q.googleMapsLoaded=true}}})(timeglider);(function(q){var $={},N=q.TG_Date,C={},T=jQuery;q.TG_Mediator=function(B){this.options=C=B;this._focusDate={};this._zoomInfo={};this._zoomLevel=1;this.ticksReady=false;this.ticksArray=[];this.startSec=0;this.activeTimelines=[];this.max_zoom=C.max_zoom;this.min_zoom=C.min_zoom;this.icon_folder=q.icon_folder=C.icon_folder||"js/timeglider/icons/";this.timeOffset=N.getTimeOffset(C.timezone);this.fixed_zoom=this.max_zoom==this.min_zoom?true:false;this.gesturing=false;this.gestureStartScale=this.gestureStartZoom=
0;this.filters={include:"",exclude:"",legend:[]};this.timelineCollection=new q.TG_TimelineCollection;this.eventCollection=new q.TG_EventCollection;this.imagesToSize=this.imagesSized=0;this.timelineDataLoaded=false;this.initial_timeline_id=C.initial_timeline_id||"";this.focusedEvent=this.sole_timeline_id="";if(C.max_zoom===C.min_zoom)this.fixed_zoom=C.min_zoom;if(C.main_map){this.main_map=C.main_map;timeglider.mapping.setMap(this.main_map,this)}$=this};q.TG_Mediator.prototype={focusToEvent:function(B){this.focusedEvent=
B;this.setFocusDate(B.startdateObj);T.publish("mediator.focusToEvent")},gotoDateZoom:function(B,I){var W=false;this.setFocusDate(new N(B));if(I)W=this.setZoomLevel(I);if(!I||W==false)this.refresh()},zoom:function(B){this.setZoomLevel(this.getZoomLevel()+parseInt(B))},loadTimelineData:function(B){var I=this;if(B)if(typeof B==="object")I.parseData(B);else if(B.substr(0,1)=="#"){B=[I.getTableTimelineData(B)];I.parseData(B)}else T.getJSON(B,function(W){I.parseData(W)});else{this.timelineDataLoaded=true;
this.setZoomLevel(Math.floor((this.max_zoom+this.min_zoom)/2));this.tryLoading()}},mapMarkerClick:function(B){this.focusToEvent(B)},getTimelineCollection:function(){return this.timelineCollection},timelineTitleClick:function(B){T.publish("mediator.timelineTitleClick",{timeline_id:B})},getTableTimelineData:function(B){var I={},W=0,o=[],U,J,k="",A=T(B);I.id=B.substr(1);I.title=A.attr("title")||"untitled";I.description=A.attr("description")||"";I.focus_date=A.attr("focus_date")||N.getToday;I.initial_zoom=
A.attr("initial_zoom")||20;I.events=[];A.find("tr").each(function(D){var L=T(this).children(),n;if(D===0)o=L.map(function(){return T(this).attr("class").replace(/^.*?\btg-(\S+)\b.*?$/,"$1")}).get();else{n={};L.each(function(v){U=o[v];J=T(this).text();n[U]=J});k="ev_"+W++;n.id=k;I.events.push(n)}});A.css("display","none");return I},parseData:function(B){var I=0,W=B.length,o={};o={};for(var U=0;U<W;U++){o=B[U];o.mediator=this;o=(new q.TG_Timeline(o)).toJSON();if(o.id.length>0){I++;this.swallowTimeline(o)}}if(I===
0)alert("ERROR loading data: Check JSON with jsonLint");else{this.timelineDataLoaded=true;this.tryLoading()}},tryLoading:function(){var B=this.timelineDataLoaded==true;if(this.imagesSized==this.imagesToSize&&B){this.setInitialTimelines();T.publish("mediator.timelineDataLoaded")}},swallowTimeline:function(B){this.sole_timeline_id=B.id;this.timelineCollection.add(B);T.publish("mediator.timelineListChangeSignal")},setInitialTimelines:function(){var B=this.initial_timeline_id||this.sole_timeline_id;if(timeglider.mode==
"authoring")this.setZoomLevel(40);else B?setTimeout(function(){$.toggleTimeline(B)},500):this.setZoomLevel(40)},refresh:function(){this.startSec=this._focusDate.sec;T.publish("mediator.refreshSignal")},setTicksReady:function(B){this.ticksReady=B;B===true&&T.publish("mediator.ticksReadySignal")},setTimeoffset:function(B){this.timeOffset=N.getTimeOffset(B);this.refresh()},getTimeoffset:function(){return this.timeOffset},setFocusDate:function(B){if(B!=this._focusDate)this._focusDate=B},getFocusDate:function(){return this._focusDate},
getZoomLevel:function(){return parseInt(this._zoomLevel)},setZoomLevel:function(B){if(B<=this.max_zoom&&B>=this.min_zoom){this.startSec=this._focusDate.sec;if(B!=this._zoomLevel){this._zoomLevel=B;this._zoomInfo=q.zoomTree[B];T.publish("mediator.zoomLevelChange");return true}else return false}else return false},getZoomInfo:function(){return this._zoomInfo},registerUIEvent:function(B){switch(B.name){case "dblclick":B=B.event.pageX-B.dimensions.container.offset.left-B.dimensions.container.width/2;var I=
this.getZoomInfo().spp,W=this.getFocusDate().sec;B=new N(Math.floor(W+B*I));T.publish("mediator.dblclick",{date:B})}},setFilters:function(B){switch(B.origin){case "clude":this.filters.include=B.include;this.filters.exclude=B.exclude;break;case "legend":var I=_.last(B.icon.split("/"));if(I=="all"){this.filters.legend=[];T.publish("mediator.legendAll")}else if(T.inArray(I,this.filters.legend)==-1){debug.log("icon to put in legend filter:",I);this.filters.legend.push(I)}else{B=[];B=T.grep(this.filters.legend,
function(W){return W!=I});this.filters.legend=B}}T.publish("mediator.filtersChange");this.refresh()},getTicksOffset:function(){return this._ticksOffset},setTicksOffset:function(B){this._ticksOffset=B;T.publish("mediator.ticksOffsetChange")},getTickBySerial:function(B){for(var I=this.ticksArray,W=I.length,o=0;o<W;o++){var U=I[o];if(U.serial==B)return U}return false},addToTicksArray:function(B,I){if(B.type=="init"){B.serial=N.getTimeUnitSerial(I,B.unit);this.ticksArray=[B]}else if(B.type=="l"){B.serial=
this.ticksArray[0].serial-1;this.ticksArray.unshift(B)}else{B.serial=this.ticksArray[this.ticksArray.length-1].serial+1;this.ticksArray.push(B)}T.publish("mediator.ticksArrayChange");return B.serial},toggleTimeline:function(B){var I=this.timelineCollection.get(B).attributes,W=T.inArray(B,this.activeTimelines);if(W==-1){this.activeTimelines.push(B);this.setFocusDate(new N(I.focus_date));this.setZoomLevel(I.initial_zoom)}else this.activeTimelines.splice(W,1);this.refresh();T.publish("mediator.activeTimelinesChange")},
reportImageSize:function(B){var I=$.eventCollection.get(B.id);if(I.has("image")){if(B.error){I.attributes.image={};debug.log("WHOOPS: MISSING IMAGE: "+B.src)}else{I.attributes.image.width=B.width;I.attributes.image.height=B.height}this.imagesSized++;this.imagesSized==this.imagesToSize&&this.tryLoading()}}};q.getLowHigh=function(B){B=_.sortBy(B,function(I){return parseInt(I)});return{low:_.first(B),high:_.last(B)}};q.validateOptions=function(B){this.optionsMaster={initial_focus:{type:"date"},timezone:{type:"timezone"},
editor:{type:"string"},backgroundColor:{type:"color"},backgroundImage:{type:"color"},min_zoom:{type:"number",min:1,max:100},max_zoom:{type:"number",min:1,max:100},initial_zoom:{type:"number",min:1,max:100},show_centerline:{type:"boolean"},display_zoom_level:{type:"boolean"},data_source:{type:"url"},basic_fontsize:{type:"number",min:9,max:100},mouse_wheel:{type:"string",possible:["zoom","pan"]},initial_timeline_id:{type:"string"},icon_folder:{type:"string"},show_footer:{type:"boolean"},display_zoom_level:{type:"boolean"},
event_modal:{type:"object"},event_overflow:{type:"string"}};var I=this,W="";T.each(B,function(o,U){if(I.optionsMaster[o])switch(I.optionsMaster[o].type){case "string":if(typeof U!="string")W+=o+" needs to be a string.\n";if(I.optionsMaster[o].possible)if(T.inArray(U,I.optionsMaster[o].possible)==-1)W+=o+" must be: "+I.optionsMaster[o].possible.join(" or ");break;case "number":if(typeof U!="number")W+=U+" needs to be a number.\n";if(I.optionsMaster[o].min)if(U<I.optionsMaster[o].min)W+=o+" must be greater than or equal to "+
I.optionsMaster[o].min+"\n";if(I.optionsMaster[o].max)if(U>I.optionsMaster[o].max)W+=o+" must be less than or equal to "+I.optionsMaster[o].max+"\n";break;case "timezone":var J=/[+|-]?[0-9]+:[0-9]+/;if(T.inArray(U,["New York","Denver","Chicago","Los Angeles"])==-1&&U.match(J)==-1)W+="The timezone is not formatted properly";break;case "boolean":if(typeof U!="boolean")W+=U+" needs to be a number.\n"}});return W}})(timeglider);(function(q){var $,N,C=timeglider,T=timeglider.TG_Date;q.widget("timeglider.timeline",{options:{timezone:"00:00",initial_focus:C.TG_Date.getToday(),editor:"none",min_zoom:1,max_zoom:100,show_centerline:true,data_source:"",culture:"en",basic_fontsize:12,mouse_wheel:"zoom",initial_timeline_id:"",icon_folder:"js/timeglider/icons/",show_footer:true,display_zoom_level:true,event_modal:{href:"",type:"default"},event_overflow:"plus"},_create:function(){this._id=q(this.element).attr("id");this.element.html("<div class='timeglider-container'><div class='timeglider-loading'>loading</div><div class='timeglider-centerline'></div><div class='timeglider-date-display'></div><div class='timeglider-truck' id='tg-truck'><div class='timeglider-ticks'><div class='timeglider-handle'></div></div></div><div class='timeglider-slider-container'><div class='timeglider-slider'></div><div class='timeglider-pan-buttons'><div class='timeglider-pan-left'></div><div class='timeglider-pan-right'></div></div></div><div class='timeglider-footer'><div class='timeglider-logo'></div><div class='timeglider-footer-button timeglider-filter-bt'></div><div class='timeglider-footer-button timeglider-settings-bt'></div><div class='timeglider-footer-button timeglider-list-bt'></div></div><div class='timeglider-event-hover-info'></div></div><span id='timeglider-measure-span'></span>")},
_init:function(){var B=timeglider.validateOptions(this.options);if(B==""){C.TG_Date.setCulture(this.options.culture);N=new C.TG_Mediator(this.options);$=new C.TG_PlayerView(this,N);N.setFocusDate(new T(this.options.initial_focus));N.loadTimelineData(this.options.data_source)}else alert("Rats. There's a problem with your widget settings:"+B)},goTo:function(B,I){N.gotoDateZoom(B,I)},getMediator:function(){return N},zoom:function(B){switch(B){case "in":B=-1;break;case "out":B=1}if(B>99||B<-99)return false;
N.zoom(B)},load:function(B){N.loadTimelineData(B)},panButton:function(B,I){var W=0;switch(I){case "left":W=30;break;case "right":W=-30;break;default:W=I}$.setPanButton(B,W)},destroy:function(){q.Widget.prototype.destroy.apply(this,arguments);q(this.element).html("")}})})(jQuery);
